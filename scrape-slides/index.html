<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Scrape Slides | Better world by better software</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="I have a lot of presentations at slides.com&#x2F;bahmutov, and it is difficult to find a specific slide sometimes, even when I know there is one. I was looking for ways to scrape my presentations and send">
<meta property="og:type" content="article">
<meta property="og:title" content="Scrape Slides">
<meta property="og:url" content="https://glebbahmutov.com/blog/scrape-slides/index.html">
<meta property="og:site_name" content="Better world by better software">
<meta property="og:description" content="I have a lot of presentations at slides.com&#x2F;bahmutov, and it is difficult to find a specific slide sometimes, even when I know there is one. I was looking for ways to scrape my presentations and send">
<meta property="og:locale">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/slides.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/edit-slide.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/h1.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/deck-info.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/browsing.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/multiple.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/scraping.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/filter.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/open-real-browser.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/algolia.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/search.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/search.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/scraped-another.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/search-widget.gif">
<meta property="article:published_time" content="2021-08-21T04:00:00.000Z">
<meta property="article:modified_time" content="2021-08-21T22:10:55.084Z">
<meta property="article:author" content="Gleb Bahmutov">
<meta property="article:tag" content="cypress">
<meta property="article:tag" content="algolia">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://glebbahmutov.com/blog/images/slides-to-algolia/slides.png">
<meta name="twitter:creator" content="@bahmutov">
  
    <link rel="alternative" href="/blog/atom.xml" title="Better world by better software" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="preload" href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" as="style">
  
<link rel="stylesheet" href="../css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-59999353-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-titles">
      <div id="header-title" class="inner">
        <h1 id="logo-wrap">
          <a href="../index.html" id="logo">Better world by better software</a>
        </h1>
        <!--
        
        -->
        <!-- <span class="no-mobile">Software advice from</span> -->
        <h2 id="subtitle-wrap">
          <span class="subtitle">
            <a id="subtitle" href="https://glebbahmutov.com">Gleb Bahmutov PhD</a>
            <a id="nav-house-link" class="nav-icon" href="/" title="Home"></a>
            
              <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
            
            <a id="nav-search-btn" class="nav-icon" title="Search"></a>
            <div id="search-form-wrap">
              <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://glebbahmutov.com/blog"></form>
            </div>
          </span>
        </h2>

      </div>
    </div>
    <div id="climate-crisis">
      <h2>Our planet üåè is in danger</h2>
      <h3>Act today: <a href="/blog/climate-emergency/">what you can do</a></h3>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-scrape-slides" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2021-08-21T04:00:00.000Z" itemprop="datePublished">Aug 21 2021</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../categories/products/">products</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Scrape Slides
    </h1>

    <h2 class="article-title" itemprop="name">
      How I scraped Reveal.js presentations using Cypress.io and sent the results to Algolia search index.
    </h2>

  


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I have a lot of presentations at <a target="_blank" rel="noopener" href="https://slides.com/bahmutov">slides.com/bahmutov</a>, and it is difficult to find a specific slide sometimes, even when I know there is one. I was looking for ways to scrape my presentations and send the search records to Algolia for indexing. In this presentation, I will show the scraper I have written for this purpose.</p>
<!-- toc -->
<ul>
<li><a href="#the-presentation">The presentation</a></li>
<li><a href="#the-slide-format">The slide format</a></li>
<li><a href="#the-scrape-selectors">The scrape selectors</a></li>
<li><a href="#browsing-and-scraping-the-slides">Browsing and scraping the slides</a><ul>
<li><a href="#be-careful-about-the-stack">Be careful about the stack</a></li>
<li><a href="#scraping-multiple-elements">Scraping multiple elements</a></li>
</ul>
</li>
<li><a href="#filtering-records">Filtering records</a></li>
<li><a href="#algolia-application">Algolia application</a><ul>
<li><a href="#object-ids">Object IDs</a></li>
</ul>
</li>
<li><a href="#replacing-objects">Replacing objects</a></li>
<li><a href="#the-search-page">The search page</a></li>
<li><a href="#scraping-any-url">Scraping any URL</a></li>
<li><a href="#see-also">See also</a></li>
</ul>
<!-- tocstop -->
<blockquote class="pullquote"><p>üéÅ You can find the source code for this blog post at <a target="_blank" rel="noopener" href="https://github.com/bahmutov/scrape-book-quotes">bahmutov/scrape-book-quotes</a>. This blog is necessarily long, since it needs to provide every relevant detail, but the ultimate truth is in the code.</p>
</blockquote>
<h2><span id="the-presentation">The presentation</span></h2><p>For this blog post I have created a small presentation <a target="_blank" rel="noopener" href="https://slides.com/bahmutov/book-quotes">slides.com/bahmutov/book-quotes</a> with a few slides with famous book quotes. The slides are implemented using <a target="_blank" rel="noopener" href="https://revealjs.com/">Reveal.js</a> framework that I <a href="/blog/reveal-vite/" title="like using">like using</a>. Here is the overview of the slides: there is a main horizontal row, and a single column in the middle.</p>
<p><img src="../images/slides-to-algolia/slides.png" alt="Presentation to be scraped"></p>
<h2><span id="the-slide-format">The slide format</span></h2><p>When editing Reveal.js slides, you can add text and various headers. Commonly, I use &quot;Heading 1&quot; for each slide&#39;s title.</p>
<p><img src="../images/slides-to-algolia/edit-slide.png" alt="The slide title is Heading 1"></p>
<p>The &quot;Heading 1&quot; text becomes the &quot;H1&quot; HTML element. The &quot;Heading 2&quot; becomes &quot;H2&quot; element, and so on. Regular text becomes &quot;P&quot; HTML element. You can see these elements marked in the HTML screenshot below.</p>
<p><img src="../images/slides-to-algolia/h1.png" alt="Heading 1 becomes the H1 element"></p>
<p>The slide deck also has an element below the presentation&#39;s title and description.</p>
<p><img src="../images/slides-to-algolia/deck-info.png" alt="The deck info markup"></p>
<p>The title and the description could be considered the top-level information in the deck.</p>
<p>The currently shown slide has the class &quot;present&quot;. We can scrape each slide one by one.</p>
<h2><span id="the-scrape-selectors">The scrape selectors</span></h2><p>The default <a target="_blank" rel="noopener" href="https://docsearch.algolia.com/docs/scraper/">Algolia scraper</a> does not work very well with the highly dynamic Single-Page Application like a Reveal.js presentation. Thus we need to browse the slides, grab the text from the elements, and send the records to Algolia index ourselves.</p>
<p>In order to scrape each slide, we need to select the <code>h1</code>, <code>h2</code>, <code>p</code> elements. Algolia documents the various text levels in its <a target="_blank" rel="noopener" href="https://docsearch.algolia.com/docs/config-file">config documentation</a>. In our case, the selectors I picked are:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">lvl0: &quot;.deck-info h1&quot;</span><br><span class="line">lvl1: &quot;.deck-info .description&quot;</span><br><span class="line">lvl2: &quot;.slides .present h1&quot;</span><br><span class="line">lvl3: &quot;.slides .present h2&quot;</span><br><span class="line">lvl4: &quot;.slides .present h3&quot;</span><br><span class="line">content: &quot;.slides .present p, .slides .present blockquote&quot;</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong> potentially we could grab all document elements&#39; using the selectors without the <code>.present</code> class and form the individual slide URLs like <code>bahmutov/book-quotes</code>, <code>bahmutov/book-quotes#/1</code>, <code>bahmutov/book-quotes#/2</code>, <code>bahmutov/book-quotes#/2/1</code>, etc. ourselves. But I would think really browsing the slides is more fun, isn&#39;t it?</p>
<h2><span id="browsing-and-scraping-the-slides">Browsing and scraping the slides</span></h2><p>To load the presentation, browse the slides, and scrape the HTML elements, I will use <a target="_blank" rel="noopener" href="https://www.cypress.io">Cypress.io</a> test runner. To go through each slide, I am using <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-recurse">cypress-recurse</a> plugin. See the <a target="_blank" rel="noopener" href="https://youtu.be/oq2P1wtIZYY">video</a> below to learn how the test goes through the slides.</p>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/oq2P1wtIZYY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>

<p>While browsing, let&#39;s extract the matching elements from the slide and save them in an array to be uploaded to the Algolia index later. Here is the initial code</p>
<figure class="highlight js"><figcaption><span>cypress/integration/spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;reference types=&quot;cypress&quot; /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; recurse &#125; <span class="keyword">from</span> <span class="string">&#x27;cypress-recurse&#x27;</span></span><br><span class="line"></span><br><span class="line">it(<span class="string">&#x27;scrapes&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> records = []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> scrape = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> cy.document().then(<span class="function">(<span class="params">doc</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> url = doc.location.href</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> lvl0El = doc.querySelector(<span class="string">&#x27;.deck-info h1&#x27;</span>)</span><br><span class="line">      <span class="keyword">const</span> lvl0 = lvl0El ? lvl0El.innerText : <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> lvl1El = doc.querySelector(<span class="string">&#x27;.deck-info .description&#x27;</span>)</span><br><span class="line">      <span class="keyword">const</span> lvl1 = lvl1El ? lvl1El.innerText : <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> lvl2El = doc.querySelector(<span class="string">&#x27;.slides .present h1&#x27;</span>)</span><br><span class="line">      <span class="keyword">const</span> lvl2 = lvl2El ? lvl2El.innerText : <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> lvl3El = doc.querySelector(<span class="string">&#x27;.slides .present h2&#x27;</span>)</span><br><span class="line">      <span class="keyword">const</span> lvl3 = lvl3El ? lvl3El.innerText : <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> lvl4El = doc.querySelector(<span class="string">&#x27;.slides .present h3&#x27;</span>)</span><br><span class="line">      <span class="keyword">const</span> lvl4 = lvl4El ? lvl4El.innerText : <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// <span class="doctag">TODO:</span> consider ALL elements, not just the first one</span></span><br><span class="line">      <span class="keyword">const</span> textEl = doc.querySelector(</span><br><span class="line">        <span class="string">&#x27;.slides .present p, .slides .present blockquote&#x27;</span>,</span><br><span class="line">      )</span><br><span class="line">      <span class="keyword">const</span> content = textEl ? textEl.innerText : <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> record = &#123; url, lvl0, lvl1, lvl2, lvl3, lvl4, content &#125;</span><br><span class="line">      <span class="built_in">console</span>.log(record)</span><br><span class="line">      records.push(record)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  cy.visit(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> goVertical = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> recurse(</span><br><span class="line">      () =&gt; scrape().then(<span class="function">() =&gt;</span> cy.get(<span class="string">&#x27;.navigate-down&#x27;</span>)),</span><br><span class="line">      ($button) =&gt; !$button.hasClass(<span class="string">&#x27;enabled&#x27;</span>),</span><br><span class="line">      &#123;</span><br><span class="line">        log: <span class="literal">false</span>,</span><br><span class="line">        delay: <span class="number">1000</span>,</span><br><span class="line">        timeout: <span class="number">200000</span>,</span><br><span class="line">        limit: <span class="number">200</span>,</span><br><span class="line">        <span class="function"><span class="title">post</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">          cy.get(<span class="string">&#x27;.navigate-down&#x27;</span>).click()</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  recurse(</span><br><span class="line">    () =&gt; goVertical().then(<span class="function">() =&gt;</span> cy.get(<span class="string">&#x27;.navigate-right&#x27;</span>)),</span><br><span class="line">    ($button) =&gt; !$button.hasClass(<span class="string">&#x27;enabled&#x27;</span>),</span><br><span class="line">    &#123;</span><br><span class="line">      log: <span class="literal">false</span>,</span><br><span class="line">      delay: <span class="number">1000</span>,</span><br><span class="line">      timeout: <span class="number">200000</span>,</span><br><span class="line">      limit: <span class="number">200</span>,</span><br><span class="line">      <span class="function"><span class="title">post</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        cy.get(<span class="string">&#x27;.navigate-right&#x27;</span>).click()</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>The records accumulate in the <code>records</code> list with each slide, as you can see in the DevTools console.</p>
<p><img src="../images/slides-to-algolia/browsing.gif" alt="Scraping each slide"></p>
<p>We can save the records as a JSON file to be sent to Algolia next.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// recurse through the slides</span></span><br><span class="line"><span class="keyword">const</span> records = []</span><br><span class="line">recurse(...)</span><br><span class="line">  .then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    cy.writeFile(<span class="string">&#x27;records.json&#x27;</span>, records)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><figcaption><span>records.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://slides.com/bahmutov/book-quotes/&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>: <span class="string">&quot;Book Quotes&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>: <span class="string">&quot;A test deck for practicing scraping slides.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>: <span class="string">&quot;Anna Karenina&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>: <span class="string">&quot;Leo Tolstoy&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;Happy families are all alike; every unhappy family is unhappy in its own way.&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://slides.com/bahmutov/book-quotes/#/1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>: <span class="string">&quot;Book Quotes&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>: <span class="string">&quot;A test deck for practicing scraping slides.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>: <span class="string">&quot;Moby Dick&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>: <span class="string">&quot;Herman Melville&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;Call me Ishmael.&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3><span id="be-careful-about-the-stack">Be careful about the stack</span></h3><p>Reveal.js decks can have columns of slides. The column is called a <code>stack</code>, and it <em>also</em> has its own &quot;present&quot; class.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;stack present&quot;</span>&gt;</span></span><br><span class="line">  ... previous slides</span><br><span class="line">  <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;present&quot;</span>&gt;</span></span><br><span class="line">    the current visible slide</span><br><span class="line">  <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">  ... future slides</span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Thus to grab the current slide we need to use the class &quot;present&quot;, but without the &quot;stack&quot; class. In CSS this can be expressed as <code>.present:not(.stack)</code> selector. Thus our content selector that pulls the <code>p</code>, <code>blockquote</code>, and <code>li</code> items is:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> contentSelectors = [</span><br><span class="line">  <span class="string">&#x27;.slides .present:not(.stack) p&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;.slides .present:not(.stack) blockquote&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;.slides .present:not(.stack) li&#x27;</span>,</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> selector = contentSelectors.join(<span class="string">&#x27;, &#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3><span id="scraping-multiple-elements">Scraping multiple elements</span></h3><p>A single slide might have multiple paragraphs, list items, and block quotes which are all separate content items. If the slide has any heading elements, the content items should all share the same &quot;lvl0&quot;, &quot;lvl1&quot;, etc. For example, the next slide produces 4 separate content records, all sharing the &quot;Heading 2&quot; at &quot;lvl3&quot;:</p>
<p><img src="../images/slides-to-algolia/multiple.png" alt="A slide with 4 records"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://slides.com/bahmutov/book-quotes/#/5&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>: <span class="string">&quot;Book Quotes&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>: <span class="string">&quot;A test deck for practicing scraping slides.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>: <span class="string">&quot;A Bullet List&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;Bullet One&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://slides.com/bahmutov/book-quotes/#/5&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>: <span class="string">&quot;Book Quotes&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>: <span class="string">&quot;A test deck for practicing scraping slides.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>: <span class="string">&quot;A Bullet List&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;Bullet Two&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://slides.com/bahmutov/book-quotes/#/5&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>: <span class="string">&quot;Book Quotes&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>: <span class="string">&quot;A test deck for practicing scraping slides.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>: <span class="string">&quot;A Bullet List&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;Bullet Three&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://slides.com/bahmutov/book-quotes/#/5&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>: <span class="string">&quot;Book Quotes&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>: <span class="string">&quot;A test deck for practicing scraping slides.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>: <span class="string">&quot;A Bullet List&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;This slide has multiple list items, all should be scraped&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>We can create these records when scraping</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> contentSelectors = [</span><br><span class="line">  <span class="string">&#x27;.slides .present:not(.stack) p&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;.slides .present:not(.stack) blockquote&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;.slides .present:not(.stack) li&#x27;</span>,</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> contentSelector = contentSelectors.join(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> textEls = <span class="built_in">Array</span>.from(doc.querySelectorAll(contentSelector))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> record = &#123; url, lvl0, lvl1, lvl2, lvl3, lvl4, <span class="attr">content</span>: <span class="literal">null</span> &#125;</span><br><span class="line"><span class="keyword">if</span> (!textEls.length) &#123;</span><br><span class="line">  <span class="keyword">return</span> [record]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> records = textEls.map(<span class="function">(<span class="params">el</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> r = &#123;</span><br><span class="line">    ...record,</span><br><span class="line">    content: el.innerText.trim(),</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> r</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>At the end we still have a flat list of individual records to upload. We can output messages for each scraped slide using <a target="_blank" rel="noopener" href="https://on.cypress.io/log">cy.log</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scrapeOneSlide()</span><br><span class="line">  .then(<span class="function">(<span class="params">r</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> url = r[<span class="number">0</span>].url</span><br><span class="line">    cy.log(url)</span><br><span class="line">    cy.log(<span class="string">`**<span class="subst">$&#123;r.length&#125;</span>** record(s)`</span>)</span><br><span class="line">    cy.task(<span class="string">&#x27;print&#x27;</span>, <span class="string">`<span class="subst">$&#123;url&#125;</span>: <span class="subst">$&#123;r.length&#125;</span> record(s)`</span>)</span><br><span class="line">    records.push(...r)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<p>The recorded video clearly shows the number of text records.</p>
<p><img src="../images/slides-to-algolia/scraping.gif" alt="Each slide gets scraped"></p>
<p>Watching Cypress browse the slides to scrape them is a lot of fun.</p>
<h2><span id="filtering-records">Filtering records</span></h2><p>Some text elements should be ignored. For example, often my slides have my Twitter handle <a target="_blank" rel="noopener" href="https://twitter.com/bahmutov">@bahmutov</a> on them, or individual URLs. We want to filter such text elements out.</p>
<p><img src="../images/slides-to-algolia/filter.png" alt="Records to be filtered include the individual URLs and my Twitter handle"></p>
<p>We can filter such individual content fields using heuristics: the search records should be longer than 10 letter, should not match a URL regular expression, or match our list of banned words.</p>
<p>Once scraped we also need to ensure the records do not have duplicates. This can happen when the slide has animation blocks - the common text elements will be the same. Thus we make sure all records are unique by taking all content properties together. For example, the following deck of slides shows the new blocks in each slide.</p>
<p><img src="../images/slides-to-algolia/open-real-browser.gif" alt="The same slide will be scraped multiple times because its URL changes"></p>
<p>The above deck will generate the &quot;content: Open real browser&quot; four times. The other fields like &quot;lvl0&quot;, &quot;lvl1&quot;, etc are also going to be exactly the same.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://slides.com/bahmutov/automated-testing/#/3/0/3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>: <span class="string">&quot;Automated Testing with Cypress.io&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>: <span class="string">&quot;This talk shows how quick and simple it can be to write end-to-end tests for web applications ‚Äì if your testing tools are not fighting you all the time. I will go over writing E2E tests using Cypress.io (https://www.cypress.io/), controlling the network during tests, using visual testing and setting up continuous integration to perform E2E tests on each commit.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>: <span class="string">&quot;Web application&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;Open real browser&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;objectID&quot;</span>: <span class="string">&quot;https-slides-com-bahmutov-automated-testing-3-0-3-4&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://slides.com/bahmutov/automated-testing/#/3/0/4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>: <span class="string">&quot;Automated Testing with Cypress.io&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>: <span class="string">&quot;This talk shows how quick and simple it can be to write end-to-end tests for web applications ‚Äì if your testing tools are not fighting you all the time. I will go over writing E2E tests using Cypress.io (https://www.cypress.io/), controlling the network during tests, using visual testing and setting up continuous integration to perform E2E tests on each commit.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>: <span class="string">&quot;Web application&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;Open real browser&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;objectID&quot;</span>: <span class="string">&quot;https-slides-com-bahmutov-automated-testing-3-0-4-4&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>Thus we remove all duplicate records using the text fields concatenated together to check for uniqueness.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> removeDuplicates = <span class="function">(<span class="params">records</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// often when slides have animations, individual blocks</span></span><br><span class="line">  <span class="comment">// come in one by one. This leads to the text elements</span></span><br><span class="line">  <span class="comment">// on the slide being duplicated.</span></span><br><span class="line">  <span class="comment">// thus we check all records for duplicate content</span></span><br><span class="line">  <span class="keyword">return</span> Cypress._.uniqBy(records, <span class="function">(<span class="params">r</span>) =&gt;</span></span><br><span class="line">    [r.content, r.lvl0, r.lvl1, r.lvl2, r.lvl3, r.lvl4].join(<span class="string">&#x27;-&#x27;</span>),</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2><span id="algolia-application">Algolia application</span></h2><p>Now let&#39;s send the records to Algolia index. I have created a new Algolia application with a new index &quot;quotes&quot;.</p>
<p><img src="../images/slides-to-algolia/algolia.png" alt="Algolia application with its new index"></p>
<p>Each record to be sent to Algolia needs a &quot;type&quot; property. Since our records all have <code>content</code> field filled, they have the type <code>content</code>. Otherwise, the type is the highest level number (if the record has <code>lvl3</code>, but no <code>lvl3</code>, then it has the <code>type: lvl3</code>). To send the records we can use the official <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/algoliasearch">algoliasearch</a> NPM module.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm i -D algoliasearch</span></span><br><span class="line">+ algoliasearch@4.10.3</span><br></pre></td></tr></table></figure>
<p>The script file <a target="_blank" rel="noopener" href="https://github.com/bahmutov/scrape-book-quotes/blob/main/send-records.js">send-records.js</a> loads the records, sets the type and replaces the entire index with the new records.</p>
<figure class="highlight js"><figcaption><span>send-records.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; scrapeToAlgoliaRecord &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./utils&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> records = <span class="built_in">require</span>(<span class="string">&#x27;./records.json&#x27;</span>).map(scrapeToAlgoliaRecord)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(records, <span class="literal">null</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://www.algolia.com/doc/api-client/getting-started</span></span><br><span class="line"><span class="keyword">const</span> algoliasearch = <span class="built_in">require</span>(<span class="string">&#x27;algoliasearch&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// tip: use https://github.com/bahmutov/as-a</span></span><br><span class="line"><span class="comment">// to inject the environment variables when running</span></span><br><span class="line"><span class="keyword">const</span> client = algoliasearch(</span><br><span class="line">  process.env.APPLICATION_ID,</span><br><span class="line">  process.env.ADMIN_API_KEY,</span><br><span class="line">)</span><br><span class="line"><span class="keyword">const</span> index = client.initIndex(<span class="string">&#x27;quotes&#x27;</span>)</span><br><span class="line"><span class="comment">// for now replace all records in the index</span></span><br><span class="line">index</span><br><span class="line">  .replaceAllObjects(records, &#123; <span class="attr">autoGenerateObjectIDIfNotExist</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">  .then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;uploaded %d records&#x27;</span>, records.length)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> <span class="built_in">console</span>.error(err))</span><br></pre></td></tr></table></figure>
<p>The utility function <code>scrapeToAlgoliaRecord</code> moves individual levels into a <code>hierarchy</code> object.</p>
<figure class="highlight js"><figcaption><span>utils.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Converts a scrape record to an Algolia record</span></span><br><span class="line"><span class="comment"> * ready to be send.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> scrapeToAlgoliaRecord = <span class="function">(<span class="params">record</span>) =&gt;</span> &#123;</span><br><span class="line">  record.hierarchy = &#123;</span><br><span class="line">    lvl0: record.lvl0,</span><br><span class="line">    lvl1: record.lvl1,</span><br><span class="line">    lvl2: record.lvl2,</span><br><span class="line">    lvl3: record.lvl3,</span><br><span class="line">    lvl4: record.lvl4,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (record.content) &#123;</span><br><span class="line">    record.type = <span class="string">&#x27;content&#x27;</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (record.lvl4) &#123;</span><br><span class="line">      record.type = <span class="string">&#x27;lvl4&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (record.lvl3) &#123;</span><br><span class="line">      record.type = <span class="string">&#x27;lvl3&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (record.lvl2) &#123;</span><br><span class="line">      record.type = <span class="string">&#x27;lvl2&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (record.lvl1) &#123;</span><br><span class="line">      record.type = <span class="string">&#x27;lvl1&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (record.lvl0) &#123;</span><br><span class="line">      record.type = <span class="string">&#x27;lvl0&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// we moved the levels into hierarchy</span></span><br><span class="line">  <span class="keyword">delete</span> record.lvl0</span><br><span class="line">  <span class="keyword">delete</span> record.lvl1</span><br><span class="line">  <span class="keyword">delete</span> record.lvl2</span><br><span class="line">  <span class="keyword">delete</span> record.lvl3</span><br><span class="line">  <span class="keyword">delete</span> record.lvl4</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> record</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123; scrapeToAlgoliaRecord &#125;</span><br></pre></td></tr></table></figure>
<p>The final record for a slide with just &quot;Heading 1&quot; could be</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;https://slides.com/bahmutov/book-quotes/#/5&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;content&quot;</span>:<span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;hierarchy&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>:<span class="string">&quot;Book Quotes&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>:<span class="string">&quot;A test deck for practicing scraping slides.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>:<span class="string">&quot;The End&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>:<span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>:<span class="literal">null</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;lvl2&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The final record with some content could be</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://slides.com/bahmutov/book-quotes/#/3&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;It was a pleasure to burn.&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;hierarchy&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;lvl0&quot;</span>: <span class="string">&quot;Book Quotes&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl1&quot;</span>: <span class="string">&quot;A test deck for practicing scraping slides.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl2&quot;</span>: <span class="string">&quot;Fahrenheit 451&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl3&quot;</span>: <span class="string">&quot;Ray Bradbury&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lvl4&quot;</span>: <span class="literal">null</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;content&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Once uploaded, the records are searchable from the Algolia UI</p>
<p><img src="../images/slides-to-algolia/search.gif" alt="Finding quotes from Algolia App Index page"></p>
<h3><span id="object-ids">Object IDs</span></h3><p>Each object in Algolia&#39;s application should have a <a target="_blank" rel="noopener" href="https://www.algolia.com/doc/api-reference/api-methods/add-objects/?client=javascript#method-param-object">unique ID</a>. Currently we let Algolia assign unique ids to each uploaded record. In the future this approach would not scale. For example, we might have need to replace a record for the given slide presentation - thus we would need to delete some of the records first, before adding new ones. Let&#39;s form a unique record ID based on the presentation slug and the slide number.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> slideId = Cypress._.kebabCase(doc.location.href)</span><br><span class="line"><span class="comment">// single record</span></span><br><span class="line"><span class="keyword">const</span> record = &#123;</span><br><span class="line">  url,</span><br><span class="line">  lvl0,</span><br><span class="line">  lvl1,</span><br><span class="line">  lvl2,</span><br><span class="line">  lvl3,</span><br><span class="line">  lvl4,</span><br><span class="line">  content: <span class="literal">null</span>,</span><br><span class="line">  objectID: slideId,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// multiple records: add the index</span></span><br><span class="line"><span class="keyword">const</span> records = textEls.map(<span class="function">(<span class="params">el, k</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> r = &#123;</span><br><span class="line">    ...record,</span><br><span class="line">    content: el.innerText.trim(),</span><br><span class="line">    <span class="comment">// give each record extracted from the slide</span></span><br><span class="line">    <span class="comment">// its own id</span></span><br><span class="line">    objectID: <span class="string">`<span class="subst">$&#123;record.objectID&#125;</span>-<span class="subst">$&#123;k&#125;</span>`</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> r</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Our object IDs will be something like:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;https-slides-com-bahmutov-book-quotes-0&quot;</span><br><span class="line">&quot;https-slides-com-bahmutov-book-quotes-1-0&quot;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h2><span id="replacing-objects">Replacing objects</span></h2><p>Currently we are using <code>index.replaceAllObjects</code> which removes all objects in the index before adding the updated records. If we have multiple presentations in the index, each slide deck will remove all previous ones. Thus we cannot blindly remove all records.</p>
<p>We cannot simply add new records, even when using the unique object IDs because it might leave &quot;orphan&quot; records in the index. Imagine the following scenario:</p>
<ul>
<li>we have a long presentation with 100 slides</li>
<li>we scrape the 100 slides into Algolia application</li>
<li>we change the presentation removing 99 slides, leaving just a single slide</li>
<li>we scrape the new presentation with one slide</li>
</ul>
<p>Hmm, there are 99 records that are still in the index, leading the user to non-existing URLs.</p>
<p>This is why I save the scraped objects and created Algolia records as JSON files before sending them to the Algolia index.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> slug</span><br><span class="line"><span class="comment">// derive the presentation slug from the pathname</span></span><br><span class="line">cy.location(<span class="string">&#x27;pathname&#x27;</span>).then(<span class="function">(<span class="params">pathname</span>) =&gt;</span> &#123;</span><br><span class="line">  slug = Cypress._.kebabCase(pathname)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// scrape the slides</span></span><br><span class="line">.then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  cy.writeFile(<span class="string">`<span class="subst">$&#123;outputFolder&#125;</span>/<span class="subst">$&#123;slug&#125;</span>-records.json`</span>, records)</span><br><span class="line">  <span class="keyword">const</span> algoliaObjects = records.map(scrapeToAlgoliaRecord)</span><br><span class="line">  cy.writeFile(<span class="string">`<span class="subst">$&#123;outputFolder&#125;</span>/<span class="subst">$&#123;slug&#125;</span>-algolia-objects.json`</span>, algoliaObjects)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>Tip:</strong> Cypress command <a target="_blank" rel="noopener" href="https://on.cypress.io/writefile">cy.writeFile</a> automatically creates the output folder if one does not exist yet.</p>
<p>We commit the output JSON files to Git, you can find my scraped files in the folder <a target="_blank" rel="noopener" href="https://github.com/bahmutov/scrape-book-quotes/tree/main/scraped">scraped</a>.</p>
<p>We can do the following &quot;trick&quot; before scraping the site: load the <em>previous</em> Algolia records and remove all objects using their unique <code>objectID</code> from the file. That will clear the records for this particular presentation, and we will add the new records after scraping. See the <a target="_blank" rel="noopener" href="https://www.algolia.com/doc/api-reference/api-methods/delete-objects/">Delete objects</a> documentation.</p>
<p><strong>Alternative method:</strong> when adding the new presentation slides we can use the presentation slug as a tag. Then, before adding the new records, we can use the <a target="_blank" rel="noopener" href="https://www.algolia.com/doc/api-reference/api-methods/delete-by/">Delete By</a> method to remove any records related to this presentation.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> algoliaObjects = records.map(scrapeToAlgoliaRecord).map(<span class="function">(<span class="params">r</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// add the same presentation slug to each record</span></span><br><span class="line">  <span class="comment">// this attribute will be very useful for deleting</span></span><br><span class="line">  <span class="comment">// all old records before scraping the presentation again</span></span><br><span class="line">  r._tags = [slug]</span><br><span class="line">  <span class="keyword">return</span> r</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Now we can delete all slides belonging to a specific presentation, see the <a target="_blank" rel="noopener" href="https://github.com/bahmutov/scrape-book-quotes/blob/main/delete-records.js">delete-records.js</a> script</p>
<figure class="highlight js"><figcaption><span>delete-records.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> presentationSlug = <span class="string">&#x27;bahmutov-book-quotes&#x27;</span></span><br><span class="line"></span><br><span class="line">index</span><br><span class="line">  .deleteBy(&#123;</span><br><span class="line">    filters: presentationSlug,</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">r</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;deleted records with presentation &quot;%s&quot;&#x27;</span>, presentationSlug)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> <span class="built_in">console</span>.error(err))</span><br></pre></td></tr></table></figure>
<h2><span id="the-search-page">The search page</span></h2><p>Let&#39;s confirm the search works by using a simple HTML page and <a target="_blank" rel="noopener" href="https://www.algolia.com/doc/guides/building-search-ui/what-is-instantsearch/js/">InstantSearch.js</a>. You can find the full page at <a target="_blank" rel="noopener" href="https://github.com/bahmutov/scrape-book-quotes/blob/main/index.html">index.html</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;searchbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;hits&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> searchClient = algoliasearch(</span><br><span class="line">  <span class="string">&#x27;MYPSC2284D&#x27;</span>, <span class="comment">// public application ID</span></span><br><span class="line">  <span class="string">&#x27;1d382a9c7cdfa0b2c13664c9a6c75b73&#x27;</span>, <span class="comment">// search-only public API key</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> search = instantsearch(&#123;</span><br><span class="line">  indexName: <span class="string">&#x27;quotes&#x27;</span>,</span><br><span class="line">  searchClient,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">search.addWidgets([</span><br><span class="line">  instantsearch.widgets.searchBox(&#123;</span><br><span class="line">    container: <span class="string">&#x27;#searchbox&#x27;</span>,</span><br><span class="line">    placeholder: <span class="string">&#x27;Search for book quotes&#x27;</span>,</span><br><span class="line">  &#125;),</span><br><span class="line"></span><br><span class="line">  instantsearch.widgets.hits(&#123;</span><br><span class="line">    container: <span class="string">&#x27;#hits&#x27;</span>,</span><br><span class="line">    templates: &#123;</span><br><span class="line">      <span class="function"><span class="title">item</span>(<span class="params">hit</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(hit)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`&lt;p&gt;<span class="subst">$&#123;hit.content&#125;</span> - &lt;a href=&quot;<span class="subst">$&#123;hit.url&#125;</span>&quot;&gt;<span class="subst">$&#123;hit.url&#125;</span>&lt;/p&gt;`</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;),</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">search.start()</span><br></pre></td></tr></table></figure>
<p><img src="../images/slides-to-algolia/search.png" alt="Searching the index for &quot;tale&quot; brings two hits"></p>
<h2><span id="scraping-any-url">Scraping any URL</span></h2><p>Finally, I have refactored the code to make it portable and be able to scrape any Reveal.js deck by just pointing at it via <code>CYPRESS_baseUrl</code> environment variable and running Cypress headlessly. The scraped records are saved as a JSON file for inspection, and also uploaded to Algolia using the <a target="_blank" rel="noopener" href="https://github.com/bahmutov/scrape-book-quotes/blob/main/cypress/plugins/index.js">cypress/plugins/index.js</a> code. We need to run Cypress with Algolia&#39;s app ID and the secret Admin API key to be able to upload the records after scraping.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> CYPRESS_baseUrl=https://slides.com/bahmutov/slides-dark-mode \</span></span><br><span class="line"><span class="bash">  APPLICATION_ID=... ADMIN_API_KEY=...  \</span></span><br><span class="line"><span class="bash">  npx cypress run --spec cypress/integration/spec.js</span></span><br><span class="line">...</span><br><span class="line">removing existing records for bahmutov-slides-dark-mode</span><br><span class="line">adding 6 records</span><br><span class="line">  ‚úì scrapes (5280ms)</span><br></pre></td></tr></table></figure>
<p>The scraped <a target="_blank" rel="noopener" href="https://slides.com/bahmutov/slides-dark-mode">slides.com/bahmutov/slides-dark-mode</a> has been added to the search index.</p>
<p><img src="../images/slides-to-algolia/scraped-another.png" alt="Scraped another deck"></p>
<p>We can scrape multiple decks calling Cypress with each URL via its <a target="_blank" rel="noopener" href="https://on.cypress.io/module-api">NPM module api</a>. You can find the full code at <a target="_blank" rel="noopener" href="https://github.com/bahmutov/scrape-book-quotes/blob/main/scrape-all.js">scrape-all.js</a>.</p>
<figure class="highlight js"><figcaption><span>scrape-all.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> presentations = [...] <span class="comment">// all presentation URLs</span></span><br><span class="line"><span class="keyword">const</span> cypress = <span class="built_in">require</span>(<span class="string">&#x27;cypress&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">scrapePresentations</span>(<span class="params">urls</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!urls.length) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> presentation = urls.shift()</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Scraping <span class="subst">$&#123;presentation&#125;</span>`</span>)</span><br><span class="line">  <span class="keyword">await</span> cypress.run(&#123;</span><br><span class="line">    config: &#123;</span><br><span class="line">      baseUrl: presentation,</span><br><span class="line">    &#125;,</span><br><span class="line">    spec: <span class="string">&#x27;cypress/integration/spec.js&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// scrape the rest of the presentations</span></span><br><span class="line">  <span class="keyword">await</span> scrapePresentations(urls)</span><br><span class="line">&#125;</span><br><span class="line">scrapePresentations(presentations).then(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;all done&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>From now on, whenever we create another presentation and make it public, we should run the scrape job to make the deck searchable. You can see the search across my Cypress presentations tagged <a target="_blank" rel="noopener" href="https://slides.com/bahmutov/decks/cypress-introduction">cypress-introduction</a> and <a target="_blank" rel="noopener" href="https://slides.com/bahmutov/decks/cypress-io">cypress.io</a> at <a target="_blank" rel="noopener" href="https://cypress.tips/search">cypress.tips/search</a> page. Here is a typical search</p>
<p><img src="../images/slides-to-algolia/search-widget.gif" alt="Searching across the slides"></p>
<p>Nice!</p>
<h2><span id="see-also">See also</span></h2><ul>
<li><a href="/blog/scrape-list-of-slides/" title="Scraping the List of Presentation Slides">Scraping the List of Presentation Slides</a></li>
<li><a href="/blog/scrape-static-site-with-algolia/" title="Scrape Static Site with Algolia">Scrape Static Site with Algolia</a></li>
<li>Search Cypress Algolia documentation index from the terminal <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cy-search">cy-search</a></li>
</ul>

      
    </div>

    
      <footer class="article-footer personal-links">
  <p>
    Follow Gleb Bahmutov <a target="_blank" rel="noopener" href="https://twitter.com/bahmutov">@bahmutov</a>,
    see his projects at <a href="https://glebbahmutov.com">glebbahmutov.com</a>,
    watch his Cypress <a target="_blank" rel="noopener" href="https://www.youtube.com/c/glebbahmutov/videos">videos</a>,
    browse his <a target="_blank" rel="noopener" href="https://slides.com/bahmutov">presentations</a>
  </p>
  <p>
    Want to know more about Cypress? Check out <a href="https://cypress.tips" target="_blank">cypress.tips</a>
  </p>
</footer>
<script src="https://rawgit.com/toddmotto/linkjuice/702066a37124081e7ad1a972844a9a91115be05a/dist/linkjuice.js"></script>
<script>
function contentFn (node, icon) {
  const s = '<a href="#' + node.id + '" class="linkjuice">' +
    node.innerHTML + ' ' + icon + '</a>\n'
  return s
}
linkjuice.init('.article-entry', {
  selectors: ['h2 span'],
  icon: '<span class="link-symbol">#</span>',
  contentFn: contentFn
});
</script>

    

    <footer class="article-footer">
      <a data-url="https://glebbahmutov.com/blog/scrape-slides/" data-id="ckvv7h6nv01vi7kvg28o0fgdi" class="article-share-link">Share</a>
      
        <a href="https://glebbahmutov.com/blog/scrape-slides/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/algolia/" rel="tag">algolia</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/cypress/" rel="tag">cypress</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../detached/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Solving The Element Is Detached From DOM Error In Cypress
        
      </div>
    </a>
  
  
    <a href="../code-coverage-for-chat-tests/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Code Coverage For Chat App</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    <style>
#carbonads {
  display: block;
  overflow: hidden;
  font-size: 11px;
  font-family: Verdana, "Helvetica Neue", Helvetica, sans-serif;
  line-height: 1.5;
}

#carbonads a {
  color: #258fb8;
  text-decoration: none;
}

#carbonads a:hover {
  text-decoration: underline;
}

#carbonads span {
  position: relative;
  display: block;
  overflow: hidden;
}

.carbon-img {
  float: left;
  margin-right: 1em;
}

.carbon-img img { display: block; }

.carbon-text {
  display: block;
  float: left;
  text-align: left;
  margin-top: 0.5em;
}
@media screen and (min-width: 1024px) {
  .carbon-text {
    max-width: calc(100% - 130px - 1em);
  }
}

.carbon-poweredby {
  /*position: absolute;
  right: 0;
  bottom: 0;*/
  float: right;
  display: block;
  font-size: 11px;
}
</style>
<div class="widget-wrap">
  <div class="widget-title">&nbsp;</div>
  <div class="widget">
    <!-- Carbon Ads -->
    <script async type="text/javascript"
      src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=glebbahmutovcom"
      id="_carbonads_js"></script>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../categories/book-review/">book review</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/climate/">climate</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/people/">people</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/process/">process</a><span class="category-list-count">138</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/products/">products</a><span class="category-list-count">429</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="../tags/11ty/" rel="tag">11ty</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/QUnit/" rel="tag">QUnit</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/a11y/" rel="tag">a11y</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/advice/" rel="tag">advice</a><span class="tag-list-count">109</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/algolia/" rel="tag">algolia</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs/" rel="tag">angularjs</a><span class="tag-list-count">58</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs2/" rel="tag">angularjs2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/assertions/" rel="tag">assertions</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ast/" rel="tag">ast</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/boilerplate/" rel="tag">boilerplate</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/browser/" rel="tag">browser</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ci/" rel="tag">ci</a><span class="tag-list-count">26</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/circle/" rel="tag">circle</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/climate/" rel="tag">climate</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/code-coverage/" rel="tag">code coverage</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/concurrency/" rel="tag">concurrency</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cyclejs/" rel="tag">cyclejs</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cypress/" rel="tag">cypress</a><span class="tag-list-count">155</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cypress-dashboard/" rel="tag">cypress dashboard</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/d3/" rel="tag">d3</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/db/" rel="tag">db</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/docker/" rel="tag">docker</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/documentation/" rel="tag">documentation</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es6/" rel="tag">es6</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es7/" rel="tag">es7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/functional/" rel="tag">functional</a><span class="tag-list-count">68</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/generators/" rel="tag">generators</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/git/" rel="tag">git</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/github/" rel="tag">github</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/graphql/" rel="tag">graphql</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/grunt/" rel="tag">grunt</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/gulp/" rel="tag">gulp</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/hiring/" rel="tag">hiring</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/hyperapp/" rel="tag">hyperapp</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/immutable/" rel="tag">immutable</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/interview/" rel="tag">interview</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jade/" rel="tag">jade</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/javascript/" rel="tag">javascript</a><span class="tag-list-count">165</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jshint/" rel="tag">jshint</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/markdown/" rel="tag">markdown</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/model-based-testing/" rel="tag">model-based testing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/modular-development/" rel="tag">modular development</a><span class="tag-list-count">28</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/netlify/" rel="tag">netlify</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">84</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/performance/" rel="tag">performance</a><span class="tag-list-count">22</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/presentation/" rel="tag">presentation</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/promises/" rel="tag">promises</a><span class="tag-list-count">31</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/proposal/" rel="tag">proposal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ramda/" rel="tag">ramda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/react/" rel="tag">react</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/react-native/" rel="tag">react native</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactive/" rel="tag">reactive</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactjs/" rel="tag">reactjs</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/renovate/" rel="tag">renovate</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/screencast/" rel="tag">screencast</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/security/" rel="tag">security</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/sentry/" rel="tag">sentry</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/service-workers/" rel="tag">service workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/state-machine/" rel="tag">state machine</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/testing/" rel="tag">testing</a><span class="tag-list-count">133</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/tutorial/" rel="tag">tutorial</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/typescript/" rel="tag">typescript</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ui/" rel="tag">ui</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/vercel/" rel="tag">vercel</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/visual-testing/" rel="tag">visual testing</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/vuejs/" rel="tag">vuejs</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/web-workers/" rel="tag">web workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/webpack/" rel="tag">webpack</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../tags/11ty/" style="font-size: 10.38px;">11ty</a> <a href="../tags/QUnit/" style="font-size: 11.54px;">QUnit</a> <a href="../tags/a11y/" style="font-size: 10.77px;">a11y</a> <a href="../tags/advice/" style="font-size: 18.85px;">advice</a> <a href="../tags/algolia/" style="font-size: 10.38px;">algolia</a> <a href="../tags/angularjs/" style="font-size: 17.69px;">angularjs</a> <a href="../tags/angularjs2/" style="font-size: 10px;">angularjs2</a> <a href="../tags/assertions/" style="font-size: 13.08px;">assertions</a> <a href="../tags/ast/" style="font-size: 12.69px;">ast</a> <a href="../tags/boilerplate/" style="font-size: 15px;">boilerplate</a> <a href="../tags/browser/" style="font-size: 15.77px;">browser</a> <a href="../tags/ci/" style="font-size: 16.54px;">ci</a> <a href="../tags/circle/" style="font-size: 13.46px;">circle</a> <a href="../tags/climate/" style="font-size: 14.62px;">climate</a> <a href="../tags/code-coverage/" style="font-size: 14.62px;">code coverage</a> <a href="../tags/concurrency/" style="font-size: 10px;">concurrency</a> <a href="../tags/cyclejs/" style="font-size: 12.31px;">cyclejs</a> <a href="../tags/cypress/" style="font-size: 19.62px;">cypress</a> <a href="../tags/cypress-dashboard/" style="font-size: 13.85px;">cypress dashboard</a> <a href="../tags/d3/" style="font-size: 10.77px;">d3</a> <a href="../tags/db/" style="font-size: 14.62px;">db</a> <a href="../tags/docker/" style="font-size: 14.23px;">docker</a> <a href="../tags/documentation/" style="font-size: 11.92px;">documentation</a> <a href="../tags/es6/" style="font-size: 14.62px;">es6</a> <a href="../tags/es7/" style="font-size: 10px;">es7</a> <a href="../tags/functional/" style="font-size: 18.08px;">functional</a> <a href="../tags/generators/" style="font-size: 11.54px;">generators</a> <a href="../tags/git/" style="font-size: 15px;">git</a> <a href="../tags/github/" style="font-size: 15.38px;">github</a> <a href="../tags/graphql/" style="font-size: 11.54px;">graphql</a> <a href="../tags/grunt/" style="font-size: 12.31px;">grunt</a> <a href="../tags/gulp/" style="font-size: 10.77px;">gulp</a> <a href="../tags/hiring/" style="font-size: 10.77px;">hiring</a> <a href="../tags/hyperapp/" style="font-size: 12.31px;">hyperapp</a> <a href="../tags/immutable/" style="font-size: 11.54px;">immutable</a> <a href="../tags/interview/" style="font-size: 10.77px;">interview</a> <a href="../tags/jade/" style="font-size: 11.15px;">jade</a> <a href="../tags/javascript/" style="font-size: 20px;">javascript</a> <a href="../tags/jshint/" style="font-size: 10.77px;">jshint</a> <a href="../tags/markdown/" style="font-size: 13.85px;">markdown</a> <a href="../tags/model-based-testing/" style="font-size: 10px;">model-based testing</a> <a href="../tags/modular-development/" style="font-size: 16.92px;">modular development</a> <a href="../tags/netlify/" style="font-size: 11.15px;">netlify</a> <a href="../tags/nodejs/" style="font-size: 18.46px;">nodejs</a> <a href="../tags/performance/" style="font-size: 16.15px;">performance</a> <a href="../tags/presentation/" style="font-size: 12.31px;">presentation</a> <a href="../tags/promises/" style="font-size: 17.31px;">promises</a> <a href="../tags/proposal/" style="font-size: 10.38px;">proposal</a> <a href="../tags/ramda/" style="font-size: 10px;">ramda</a> <a href="../tags/react/" style="font-size: 11.54px;">react</a> <a href="../tags/react-native/" style="font-size: 11.15px;">react native</a> <a href="../tags/reactive/" style="font-size: 14.23px;">reactive</a> <a href="../tags/reactjs/" style="font-size: 11.15px;">reactjs</a> <a href="../tags/renovate/" style="font-size: 11.54px;">renovate</a> <a href="../tags/screencast/" style="font-size: 10px;">screencast</a> <a href="../tags/security/" style="font-size: 13.08px;">security</a> <a href="../tags/sentry/" style="font-size: 13.85px;">sentry</a> <a href="../tags/service-workers/" style="font-size: 11.92px;">service workers</a> <a href="../tags/state-machine/" style="font-size: 10px;">state machine</a> <a href="../tags/testing/" style="font-size: 19.23px;">testing</a> <a href="../tags/tutorial/" style="font-size: 15.77px;">tutorial</a> <a href="../tags/typescript/" style="font-size: 12.31px;">typescript</a> <a href="../tags/ui/" style="font-size: 10.38px;">ui</a> <a href="../tags/vercel/" style="font-size: 13.08px;">vercel</a> <a href="../tags/visual-testing/" style="font-size: 11.15px;">visual testing</a> <a href="../tags/vuejs/" style="font-size: 11.54px;">vuejs</a> <a href="../tags/web-workers/" style="font-size: 11.92px;">web workers</a> <a href="../tags/webpack/" style="font-size: 10.77px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/11/">November 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/10/">October 2021</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/09/">September 2021</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/08/">August 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/07/">July 2021</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/06/">June 2021</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/05/">May 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/04/">April 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/03/">March 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/02/">February 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/01/">January 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/12/">December 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/11/">November 2020</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/10/">October 2020</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/09/">September 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/08/">August 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/07/">July 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/06/">June 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/05/">May 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/04/">April 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/03/">March 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/02/">February 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/01/">January 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/12/">December 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/11/">November 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/10/">October 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/09/">September 2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/08/">August 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/07/">July 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/06/">June 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/05/">May 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/04/">April 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/03/">March 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/02/">February 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/01/">January 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/12/">December 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/11/">November 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/10/">October 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/09/">September 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/08/">August 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/06/">June 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/04/">April 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/03/">March 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/01/">January 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/12/">December 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/11/">November 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/09/">September 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/08/">August 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/07/">July 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/06/">June 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/05/">May 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/04/">April 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/03/">March 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/02/">February 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/01/">January 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/12/">December 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/10/">October 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/08/">August 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/07/">July 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/06/">June 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/05/">May 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/04/">April 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/03/">March 2016</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/02/">February 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/01/">January 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/12/">December 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/11/">November 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/08/">August 2015</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/07/">July 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/06/">June 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/05/">May 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/04/">April 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/03/">March 2015</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/02/">February 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/01/">January 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/12/">December 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/11/">November 2014</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/10/">October 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/09/">September 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/08/">August 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/07/">July 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/06/">June 2014</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/05/">May 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/04/">April 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/03/">March 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/02/">February 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/01/">January 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/12/">December 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/11/">November 2013</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/10/">October 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/09/">September 2013</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../parallelism-parameter/">CircleCI Parallelism As A Parameter</a>
          </li>
        
          <li>
            <a href="../test-sitemap/">Test your sitemap using Cypress</a>
          </li>
        
          <li>
            <a href="../cypress-grep-filters/">Faster test execution with cypress-grep</a>
          </li>
        
          <li>
            <a href="../cypresss-data-session/">Flexible Cypress Data Setup And Validation</a>
          </li>
        
          <li>
            <a href="../refactor-using-each/">Refactor Tests To Be Independent And Fast Using Cypress-Each Plugin</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Gleb Bahmutov<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
</nav>
    
<script>
  var disqus_shortname = 'betterworldbybettersoftware';
  
  var disqus_url = 'https://glebbahmutov.com/blog/scrape-slides/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="../fancybox/jquery.fancybox.css">

  
<script src="../fancybox/jquery.fancybox.pack.js"></script>




<script src="../js/script.js"></script>


  </div>
  <script src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script>
<script>
(function centerMainOnAsideScroll () {
  // when aside side bar scrolls outside the view
  // it centers the main content.
  const main = document.querySelector('#main')
  const aside = document.querySelector('aside#sidebar')
  console.assert(main, 'could not get #main')
  console.assert(aside, 'could not get aside')
  // initially the aside sidebar is visible
  let asideVisible = true

  function centerMain () {
    console.log('adding class center-main')
    main.classList.add('center-main')
  }
  function leftMain () {
    main.classList.remove('center-main')
  }

  function callWhenAsideScrollsUp (becameInvisible, becameVisible) {
    return function () {
      const border = 50
      const rect = aside.getBoundingClientRect()
      if (asideVisible && rect.bottom < -border) {
        asideVisible = false
        becameInvisible()
      }

      if (!asideVisible && window.scrollY < border) {
        asideVisible = true
        becameVisible()
      }
    }
  }
  const throttleWaitMs = 250
  const onScroll = _.throttle(
    callWhenAsideScrollsUp(centerMain, leftMain),
    throttleWaitMs
  )
  window.addEventListener('scroll', onScroll)
}())
</script>

</body>
</html>
