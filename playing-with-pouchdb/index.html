<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Playing with PouchDB | Better world by better software</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I am playing with a cool Node / browser NoSQL database called PouchDB. It works as a uniform
interface across all modern desktop and mobile browsers by utilizing IndexedDB / WebSQL technologies,
and w">
<meta property="og:type" content="article">
<meta property="og:title" content="Playing with PouchDB">
<meta property="og:url" content="http://glebbahmutov.com/blog/playing-with-pouchdb/index.html">
<meta property="og:site_name" content="Better world by better software">
<meta property="og:description" content="I am playing with a cool Node / browser NoSQL database called PouchDB. It works as a uniform
interface across all modern desktop and mobile browsers by utilizing IndexedDB / WebSQL technologies,
and w">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Playing with PouchDB">
<meta name="twitter:description" content="I am playing with a cool Node / browser NoSQL database called PouchDB. It works as a uniform
interface across all modern desktop and mobile browsers by utilizing IndexedDB / WebSQL technologies,
and w">
<meta name="twitter:creator" content="@bahmutov">
  
    <link rel="alternative" href="/blog/atom.xml" title="Better world by better software" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="../css/style.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-59999353-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="..//" id="logo">Better world by better software</a>
      </h1>
      <!--
      
        <h2 id="subtitle-wrap">
          <a href="..//" id="subtitle">Software advice from Dr. Gleb Bahmutov PhD</a>
        </h2>
      
      -->
      <h2 id="subtitle-wrap">
        <span class="subtitle">Software advice from <a id="subtitle" href="http://glebbahmutov.com">Dr. Gleb Bahmutov PhD</a></span>
      </h2>
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="..//">Home</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="q" value="site:http://glebbahmutov.com/blog"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-playing-with-pouchdb" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2015-03-23T04:00:00.000Z" itemprop="datePublished">Mar 23 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../categories/products/">products</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Playing with PouchDB
    </h1>

    <h2 class="article-title" itemprop="name">
      Trying a tiny Node / browser NoSQL database with a clean API.
    </h2>

  


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I am playing with a cool Node / browser NoSQL database called <a href="http://pouchdb.com/" target="_blank" rel="external">PouchDB</a>. It works as a uniform
interface across <a href="http://pouchdb.com/adapters.html" target="_blank" rel="external">all modern desktop and mobile browsers</a> by utilizing IndexedDB / WebSQL technologies,
and works under Node too. It can also proxy requests to a <a href="http://couchdb.apache.org/" target="_blank" rel="external">CouchDB</a> database, the database
behind <a href="https://docs.npmjs.com/misc/registry" target="_blank" rel="external">NPM registry</a>.</p>
<h2 id="simple-example">Simple example</h2><p>Here is how simple it is to get started with PouchDB under Node.</p>
<pre><code>npm <span class="operator"><span class="keyword">install</span> pouchdb <span class="comment">--save</span></span>
</code></pre><p>A simple source to insert an item and then print all items</p>
<figure class="highlight js"><figcaption><span>simple.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> PouchDB = <span class="built_in">require</span>(<span class="string">&apos;pouchdb&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> db = <span class="keyword">new</span> PouchDB(<span class="string">&apos;my_database&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> todo = {</span><br><span class="line">  _id: <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString(),</span><br><span class="line">  title: <span class="string">&apos;an example todo&apos;</span>,</span><br><span class="line">  completed: <span class="literal">false</span></span><br><span class="line">};</span><br><span class="line">db.put(todo, <span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&apos;Successfully saved a todo!&apos;</span>, result.id);</span><br><span class="line">    db.allDocs({ include_docs: <span class="literal">true</span>, descending: <span class="literal">true</span> }, <span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>{</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&apos;fetched&apos;</span>, result.rows.length, <span class="string">&apos;items&apos;</span>);</span><br><span class="line">      <span class="built_in">console</span>.log(result.rows);</span><br><span class="line">    });</span><br><span class="line">  });</span><br></pre></td></tr></table></figure>
<p>The output (we are using timestamps as ids)</p>
<pre><code>Successfully saved a todo! <span class="number">2015</span>-<span class="number">03</span>-<span class="number">23</span><span class="string">T19:</span><span class="number">44</span>:<span class="number">45.106</span>Z
fetched <span class="number">1</span> items
[ { <span class="string">id:</span> <span class="string">&apos;2015-03-23T19:44:45.106Z&apos;</span>,
<span class="label">    key:</span> <span class="string">&apos;2015-03-23T19:44:45.106Z&apos;</span>,
<span class="label">    value:</span> { <span class="string">rev:</span> <span class="string">&apos;1-cf1d4cfef10eca49836f072566e29fbe&apos;</span> },
<span class="label">    doc:</span> 
     { <span class="string">title:</span> <span class="string">&apos;an example todo&apos;</span>,
<span class="label">       completed:</span> <span class="literal">false</span>,
<span class="label">       _id:</span> <span class="string">&apos;2015-03-23T19:44:45.106Z&apos;</span>,
<span class="label">       _rev:</span> <span class="string">&apos;1-cf1d4cfef10eca49836f072566e29fbe&apos;</span> } } ]
</code></pre><p>Notice that this created a folder locally called <code>my_database</code> with all data stored (with revisions) in binary format.</p>
<p>If we run this problem several times we will insert a new item into the store every time. Thus on the second
run you should inspect seeing a list of 2 items, then 3 items, etc.</p>
<h2 id="destroying-a-db-in-the-browser">Destroying a db in the browser</h2><p>If you want to remove an existing pouch database stored on the client, execute the
<a href="http://pouchdb.com/api.html#delete_database" target="_blank" rel="external">destroy</a> call</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">new</span> PouchDB(<span class="string">&apos;db-name&apos;</span>)).destroy().then(<span class="built_in">console</span>.log.bind(<span class="built_in">console</span>), <span class="built_in">console</span>.error.bind(<span class="built_in">console</span>));</span><br><span class="line"><span class="comment">// prints {ok: true}</span></span><br></pre></td></tr></table></figure>
<h2 id="simple-example-using-memory-only">Simple example using memory only</h2><p>For unit testing we might want to avoid writing anything to the disk. The PouchDB uses <code>adapters</code> to perform low-level
database operations. There is an adapter for keeping data in memory, without leaving any traces on the disk. The
memory adapter is perfect for unit testing. First install <a href="https://www.npmjs.com/package/memdown" target="_blank" rel="external">memdown</a>,
then perform same operations <code>npm install memdown --save</code></p>
<figure class="highlight js"><figcaption><span>memory-only</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> PouchDB = <span class="built_in">require</span>(<span class="string">&apos;pouchdb&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> db = <span class="keyword">new</span> PouchDB(<span class="string">&apos;my_database&apos;</span>, { db: <span class="built_in">require</span>(<span class="string">&apos;memdown&apos;</span>) });</span><br><span class="line"><span class="comment">// the rest of the code is unchanged</span></span><br></pre></td></tr></table></figure>
<p>Running this example always starts from empty (new) database, guaranteeing the unit tests will execute in
a clean environment.</p>
<h2 id="promise-based-api">Promise-based API</h2><p>The included PouchDB api is node-like callback based. Every function accepts a callback with the error (if any)
at the first position and data at the second. I prefer using promises to callbacks, thus I convert each method
to a promise-returning one using <a href="https://www.npmjs.com/package/q#adapting-node" target="_blank" rel="external">Q.nbind</a> method</p>
<figure class="highlight js"><figcaption><span>promises</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Q = <span class="built_in">require</span>(<span class="string">&apos;q&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> PouchDB = <span class="built_in">require</span>(<span class="string">&apos;pouchdb&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> db = <span class="keyword">new</span> PouchDB(<span class="string">&apos;my_database&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> dbPut = Q.nbind(db.put, db);</span><br><span class="line"><span class="keyword">var</span> dbAllDocs = Q.nbind(db.allDocs, db);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> todo = {</span><br><span class="line">    _id: <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString(),</span><br><span class="line">    title: text,</span><br><span class="line">    completed: <span class="literal">false</span></span><br><span class="line">  };</span><br><span class="line">  <span class="keyword">return</span> dbPut(todo).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&apos;Successfully posted a todo!&apos;</span>, result.id);</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printTodos</span>(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">return</span> db.allDocs({ include_docs: <span class="literal">true</span>, descending: <span class="literal">true</span> })</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">doc</span>) </span>{</span><br><span class="line">      <span class="built_in">console</span>.log(doc.rows);</span><br><span class="line">    });</span><br><span class="line">}</span><br><span class="line">addTodo(<span class="string">&apos;first todo&apos;</span>)</span><br><span class="line">  .then(printTodos)</span><br><span class="line">  .done();</span><br></pre></td></tr></table></figure>
<p>If we need to insert several todos, I prefer to <a href="../starting-promises/">link them to existing promise chain</a>
and using partial application instead of extra functions</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Q()</span><br><span class="line">  .then(addTodo.bind(<span class="literal">null</span>, <span class="string">&apos;first todo&apos;</span>))</span><br><span class="line">  .then(addTodo.bind(<span class="literal">null</span>, <span class="string">&apos;second todo&apos;</span>))</span><br><span class="line">  .then(printTodos)</span><br><span class="line">  .done();</span><br></pre></td></tr></table></figure>
<h3 id="promisfying-all-methods">Promisfying all methods</h3><p>Q api has a function to promisify a single method, while another library of promises <a href="https://github.com/petkaantonov/bluebird/blob/master/API.md" target="_blank" rel="external">bluebird</a>
has a method to promisify <em>all object&apos;s methods at once</em>. For each method <code>foo.bar(..., callback(err, ...))</code> 
it will create a promise-returning <code>foo.barAsync()</code> method.</p>
<figure class="highlight js"><figcaption><span>promisfy all db methods</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">Promise</span> = <span class="built_in">require</span>(<span class="string">&apos;bluebird&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> PouchDB = <span class="built_in">require</span>(<span class="string">&apos;pouchdb&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> db = <span class="keyword">new</span> PouchDB(<span class="string">&apos;my_database&apos;</span>, { db: <span class="built_in">require</span>(<span class="string">&apos;memdown&apos;</span>) });</span><br><span class="line"><span class="comment">// adds new ...Async methods that return promises</span></span><br><span class="line"><span class="built_in">Promise</span>.promisifyAll(db);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> todo = {</span><br><span class="line">    _id: <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString(),</span><br><span class="line">    title: text,</span><br><span class="line">    completed: <span class="literal">false</span></span><br><span class="line">  };</span><br><span class="line">  <span class="keyword">return</span> db.putAsync(todo).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&apos;Successfully posted a todo!&apos;</span>, result.id);</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printTodos</span>(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">return</span> db.allDocsAsync({ include_docs: <span class="literal">true</span>, descending: <span class="literal">true</span> })</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">doc</span>) </span>{</span><br><span class="line">      <span class="built_in">console</span>.log(doc.rows);</span><br><span class="line">    });</span><br><span class="line">}</span><br><span class="line"><span class="built_in">Promise</span>.resolve() <span class="comment">// same as Q()</span></span><br><span class="line">  .then(addTodo.bind(<span class="literal">null</span>, <span class="string">&apos;first todo&apos;</span>))</span><br><span class="line">  .then(addTodo.bind(<span class="literal">null</span>, <span class="string">&apos;second todo&apos;</span>))</span><br><span class="line">  .then(printTodos)</span><br><span class="line">  .done();</span><br></pre></td></tr></table></figure>
<h2 id="removing-a-little-bit-of-boilerplate">Removing a little bit of boilerplate</h2><p>We can avoid all partial application calls like <code>addTodo.bind(null, &apos;first todo&apos;)</code> using
a curried function, like I described in <a href="../remove-boilerplate-from-promise-chains/">Remove boilerplate from promise chains</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// same DB code</span></span><br><span class="line"><span class="keyword">var</span> R = <span class="built_in">require</span>(<span class="string">&apos;ramda&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> addTodo = R.curryN(<span class="number">2</span>, <span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> todo = {</span><br><span class="line">    _id: <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString(),</span><br><span class="line">    title: text,</span><br><span class="line">    completed: <span class="literal">false</span></span><br><span class="line">  };</span><br><span class="line">  <span class="keyword">return</span> db.putAsync(todo).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&apos;Successfully posted a todo!&apos;</span>, result.id);</span><br><span class="line">  });</span><br><span class="line">});</span><br><span class="line"><span class="comment">// same printTodos</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve()</span><br><span class="line">  .then(addTodo(<span class="string">&apos;first todo&apos;</span>))</span><br><span class="line">  .then(addTodo(<span class="string">&apos;second todo&apos;</span>))</span><br><span class="line">  .then(printTodos)</span><br><span class="line">  .done();</span><br></pre></td></tr></table></figure>
<p>The curried version of <code>addTodo</code> is a pleasure to work with in the middle of the promise chain.</p>
<h2 id="removing-a-lot-of-boilerplate-using-generators">Removing a lot of boilerplate using generators</h2><p>Promises are nice, but we can do better using generators. Instead of creating and chaining promises,
I am going to yield individual asynchronous functions into a runner function <a href="https://github.com/tj/co" target="_blank" rel="external">co</a>. First,
I am converting a function that takes a callback into a thunk using <a href="https://www.npmjs.com/package/thunkify" target="_blank" rel="external">thunkify</a>. A thunk
just shifts the last callback argument into new function</p>
<figure class="highlight js"><figcaption><span>thunks</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// original db.put</span></span><br><span class="line">db.put(item, <span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>{ ... });</span><br><span class="line"><span class="comment">// thunk method bound to the original object</span></span><br><span class="line"><span class="keyword">var</span> thunkify = <span class="built_in">require</span>(<span class="string">&apos;thunkify&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> dbPut = thunkify(db.put).bind(db);</span><br><span class="line">dbPut(item)(<span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>{ ... });</span><br></pre></td></tr></table></figure>
<p>We just need to return thunks from <code>db.put</code> and <code>db.allDocs</code> methods.</p>
<figure class="highlight js"><figcaption><span>generators</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> PouchDB = <span class="built_in">require</span>(<span class="string">&apos;pouchdb&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> db = <span class="keyword">new</span> PouchDB(<span class="string">&apos;my_database&apos;</span>, { db: <span class="built_in">require</span>(<span class="string">&apos;memdown&apos;</span>) });</span><br><span class="line"><span class="keyword">var</span> thunkify = <span class="built_in">require</span>(<span class="string">&apos;thunkify&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> dbPut = thunkify(db.put).bind(db);</span><br><span class="line"><span class="keyword">var</span> dbAllDocs = thunkify(db.allDocs).bind(db);</span><br><span class="line"><span class="keyword">var</span> co = <span class="built_in">require</span>(<span class="string">&apos;co&apos;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> todo = {</span><br><span class="line">    _id: <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString(),</span><br><span class="line">    title: text,</span><br><span class="line">    completed: <span class="literal">false</span></span><br><span class="line">  };</span><br><span class="line">  <span class="keyword">return</span> dbPut(todo);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printTodos</span>(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">return</span> dbAllDocs({ include_docs: <span class="literal">true</span>, descending: <span class="literal">true</span> });</span><br><span class="line">}</span><br><span class="line">co(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">yield</span> addTodo(<span class="string">&apos;first todo&apos;</span>);</span><br><span class="line">  <span class="keyword">yield</span> addTodo(<span class="string">&apos;second todo&apos;</span>);</span><br><span class="line">  <span class="keyword">var</span> result = <span class="keyword">yield</span> printTodos();</span><br><span class="line">  <span class="keyword">return</span> result.rows;</span><br><span class="line">}).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>{</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>{</span><br><span class="line">  <span class="built_in">console</span>.error(err.stack);</span><br><span class="line">});</span><br></pre></td></tr></table></figure>
<p>We need to run this code using <code>node --harmony index.js</code> flag (or use io.js).
It prints two JSON documents</p>
<pre><code>[ { <span class="string">title:</span> <span class="string">&apos;second todo&apos;</span>,
<span class="label">    completed:</span> <span class="literal">false</span>,
<span class="label">    _id:</span> <span class="string">&apos;2015-03-24T03:52:11.439Z&apos;</span>,
<span class="label">    _rev:</span> <span class="string">&apos;1-92c5d74cc0e408c35d332572c5fa1337&apos;</span> },
  { <span class="string">title:</span> <span class="string">&apos;first todo&apos;</span>,
<span class="label">    completed:</span> <span class="literal">false</span>,
<span class="label">    _id:</span> <span class="string">&apos;2015-03-24T03:52:11.428Z&apos;</span>,
<span class="label">    _rev:</span> <span class="string">&apos;1-f90e06ba4ee3b752fe476e397d8ef993&apos;</span> } ]
</code></pre><p>We are going to insert two items, then grab results - and the sequence is written linearly, while
the execution is asynchronous. The yielded and continued values are controlled by the library function <code>co</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">co(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">yield</span> addTodo(<span class="string">&apos;first todo&apos;</span>);</span><br><span class="line">  <span class="keyword">yield</span> addTodo(<span class="string">&apos;second todo&apos;</span>);</span><br><span class="line">  <span class="keyword">var</span> result = <span class="keyword">yield</span> printTodos();</span><br><span class="line">  <span class="keyword">return</span> result.rows;</span><br><span class="line">});</span><br></pre></td></tr></table></figure>
<p>The <code>co</code> function returns a promise that is resolved with the last returned value.</p>
<h3 id="cleaner-syntax-by-yielding-promises">Cleaner syntax by yielding promises</h3><p>We can apply the same good code refactoring principles to the generators as to our usual code.
Plus instead of creating the thunks we can directly yield promises. To run the generator function we
can you another method from Bluebird API <a href="https://github.com/petkaantonov/bluebird/blob/master/API.md#promisecoroutinegeneratorfunction-generatorfunction---function" target="_blank" rel="external">Promise.coroutine</a></p>
<figure class="highlight js"><figcaption><span>promises and coroutine</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> PouchDB = <span class="built_in">require</span>(<span class="string">&apos;pouchdb&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> db = <span class="keyword">new</span> PouchDB(<span class="string">&apos;my_database&apos;</span>, { db: <span class="built_in">require</span>(<span class="string">&apos;memdown&apos;</span>) });</span><br><span class="line"><span class="keyword">var</span> <span class="built_in">Promise</span> = <span class="built_in">require</span>(<span class="string">&apos;bluebird&apos;</span>);</span><br><span class="line"><span class="built_in">Promise</span>.promisifyAll(db);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> todo = {</span><br><span class="line">    _id: <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString(),</span><br><span class="line">    title: text,</span><br><span class="line">    completed: <span class="literal">false</span></span><br><span class="line">  };</span><br><span class="line">  <span class="keyword">return</span> db.putAsync(todo);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTodos</span>(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">return</span> db.allDocsAsync({ include_docs: <span class="literal">true</span>, descending: <span class="literal">true</span> });</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> * <span class="title">add2TodosAndReturnAll</span>(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">yield</span> addTodo(<span class="string">&apos;first todo&apos;</span>);</span><br><span class="line">  <span class="keyword">yield</span> addTodo(<span class="string">&apos;second todo&apos;</span>);</span><br><span class="line">  <span class="keyword">var</span> result = <span class="keyword">yield</span> getTodos();</span><br><span class="line">  <span class="keyword">return</span> result.rows;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">var</span> start = <span class="built_in">Promise</span>.coroutine(add2TodosAndReturnAll);</span><br><span class="line">start()</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&apos;result&apos;</span>, result);</span><br><span class="line">  }, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.error(err.stack);</span><br><span class="line">  });</span><br></pre></td></tr></table></figure>
<p>I like this approach for only using a single external promise library &quot;bluebird&quot;.</p>
<h2 id="removing-boilerplate-using-es7-await-async">Removing boilerplate using ES7 await / async</h2><p>We can go one step further and use a new pair of keywords that will probably be a part of the EcmaScript7 standard.
While <code>await/async</code> feature is in flux, one can already use it for experiments. Instead of a <code>yield</code> I am using
the <code>await</code> keyword, and instead of the generator function, I have marked a function with the keyword <code>async</code>.
Each individual DB operation is returning a promise created via <code>promisifyAll</code> method.</p>
<figure class="highlight js"><figcaption><span>async-await.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> PouchDB = <span class="built_in">require</span>(<span class="string">&apos;pouchdb&apos;</span>);</span><br><span class="line"><span class="keyword">var</span> db = <span class="keyword">new</span> PouchDB(<span class="string">&apos;my_database&apos;</span>, { db: <span class="built_in">require</span>(<span class="string">&apos;memdown&apos;</span>) });</span><br><span class="line"><span class="keyword">var</span> <span class="built_in">Promise</span> = <span class="built_in">require</span>(<span class="string">&apos;bluebird&apos;</span>);</span><br><span class="line"><span class="built_in">Promise</span>.promisifyAll(db);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> todo = {</span><br><span class="line">    _id: <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString(),</span><br><span class="line">    title: text,</span><br><span class="line">    completed: <span class="literal">false</span></span><br><span class="line">  };</span><br><span class="line">  <span class="keyword">return</span> db.putAsync(todo);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printTodos</span>(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">return</span> db.allDocsAsync({ include_docs: <span class="literal">true</span>, descending: <span class="literal">true</span> })</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>use await/async to remove boilerplate code</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// most important function</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">let</span> first = <span class="keyword">await</span> addTodo(<span class="string">&apos;first todo&apos;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&apos;Successfully posted a todo!&apos;</span>, first.id);</span><br><span class="line">  <span class="keyword">let</span> second = <span class="keyword">await</span> addTodo(<span class="string">&apos;second todo&apos;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&apos;Successfully posted a todo!&apos;</span>, second.id);</span><br><span class="line">  <span class="keyword">let</span> result = <span class="keyword">await</span> printTodos();</span><br><span class="line">  <span class="built_in">console</span>.log(result.rows);</span><br><span class="line">  <span class="keyword">return</span> result.rows;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>To run this example under Node 0.12 I created a second file and installed <a href="https://github.com/ModuleLoader/es6-module-loader" target="_blank" rel="external">es6-module-loader</a>
as a dependency</p>
<figure class="highlight js"><figcaption><span>async-await-app.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> System = <span class="built_in">require</span>(<span class="string">&apos;es6-module-loader&apos;</span>).System;</span><br><span class="line">System.traceurOptions = {</span><br><span class="line">  asyncFunctions: <span class="literal">true</span></span><br><span class="line">};</span><br><span class="line">System.import(<span class="string">&apos;./async-await&apos;</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">loaded</span>) </span>{</span><br><span class="line">  loaded.default();</span><br><span class="line">});</span><br></pre></td></tr></table></figure>
<p>Then I ran it using regular Node command <code>node async-await-app.js</code>. 
The ES7 code from <code>async-await.js</code> was automatically transpiled using <a href="https://github.com/google/traceur-compiler" target="_blank" rel="external">traceur</a> on module load.</p>

      
    </div>

    
      <footer class="article-footer personal-links">
  Follow Gleb Bahmutov <a href="https://twitter.com/bahmutov">@bahmutov</a>,
  see his projects at <a href="http://glebbahmutov.com">glebbahmutov.com</a>
</footer>

    

    <footer class="article-footer">
      <a data-url="http://glebbahmutov.com/blog/playing-with-pouchdb/" data-id="cii7syykb00dvirurz8pi0bvm" class="article-share-link">Share</a>
      
        <a href="http://glebbahmutov.com/blog/playing-with-pouchdb/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/browser/">browser</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/db/">db</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/es6/">es6</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/es7/">es7</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/generators/">generators</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/nodejs/">nodejs</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../remove-boilerplate-from-promise-chains/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Remove boilerplate from promise chains
        
      </div>
    </a>
  
  
    <a href="../getting-up-to-javascript-speed/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Getting up to JavaScript speed</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../categories/book-review/">book review</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/people/">people</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/process/">process</a><span class="category-list-count">67</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/products/">products</a><span class="category-list-count">190</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="../tags/QUnit/">QUnit</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/advice/">advice</a><span class="tag-list-count">81</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angular/">angular</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs/">angularjs</a><span class="tag-list-count">54</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs2/">angularjs2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/assertions/">assertions</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/boilerplate/">boilerplate</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/browser/">browser</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/concurrency/">concurrency</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/d3/">d3</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/database/">database</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/db/">db</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es6/">es6</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es7/">es7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/functional/">functional</a><span class="tag-list-count">42</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/generators/">generators</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/git/">git</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/grunt/">grunt</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/gulp/">gulp</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/immutable/">immutable</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/interview/">interview</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jade/">jade</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/javascript/">javascript</a><span class="tag-list-count">141</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jshint/">jshint</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/modular-development/">modular development</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/nodejs/">nodejs</a><span class="tag-list-count">54</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/performance/">performance</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/promises/">promises</a><span class="tag-list-count">30</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/proposal/">proposal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactive/">reactive</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactjs/">reactjs</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/security/">security</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/sentry/">sentry</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/testing/">testing</a><span class="tag-list-count">44</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/tutorial/">tutorial</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ui/">ui</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/web-workers/">web workers</a><span class="tag-list-count">5</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../tags/QUnit/" style="font-size: 12.86px;">QUnit</a><a href="../tags/advice/" style="font-size: 19.29px;">advice</a><a href="../tags/angular/" style="font-size: 10px;">angular</a><a href="../tags/angularjs/" style="font-size: 18.57px;">angularjs</a><a href="../tags/angularjs2/" style="font-size: 10px;">angularjs2</a><a href="../tags/assertions/" style="font-size: 13.57px;">assertions</a><a href="../tags/boilerplate/" style="font-size: 15.71px;">boilerplate</a><a href="../tags/browser/" style="font-size: 14.29px;">browser</a><a href="../tags/concurrency/" style="font-size: 10px;">concurrency</a><a href="../tags/d3/" style="font-size: 11.43px;">d3</a><a href="../tags/database/" style="font-size: 10px;">database</a><a href="../tags/db/" style="font-size: 12.86px;">db</a><a href="../tags/es6/" style="font-size: 14.29px;">es6</a><a href="../tags/es7/" style="font-size: 10px;">es7</a><a href="../tags/functional/" style="font-size: 17.14px;">functional</a><a href="../tags/generators/" style="font-size: 12.86px;">generators</a><a href="../tags/git/" style="font-size: 13.57px;">git</a><a href="../tags/grunt/" style="font-size: 13.57px;">grunt</a><a href="../tags/gulp/" style="font-size: 11.43px;">gulp</a><a href="../tags/immutable/" style="font-size: 10px;">immutable</a><a href="../tags/interview/" style="font-size: 11.43px;">interview</a><a href="../tags/jade/" style="font-size: 12.14px;">jade</a><a href="../tags/javascript/" style="font-size: 20px;">javascript</a><a href="../tags/jshint/" style="font-size: 11.43px;">jshint</a><a href="../tags/modular-development/" style="font-size: 15.71px;">modular development</a><a href="../tags/nodejs/" style="font-size: 18.57px;">nodejs</a><a href="../tags/performance/" style="font-size: 15px;">performance</a><a href="../tags/promises/" style="font-size: 16.43px;">promises</a><a href="../tags/proposal/" style="font-size: 10.71px;">proposal</a><a href="../tags/reactive/" style="font-size: 10.71px;">reactive</a><a href="../tags/reactjs/" style="font-size: 10.71px;">reactjs</a><a href="../tags/security/" style="font-size: 12.14px;">security</a><a href="../tags/sentry/" style="font-size: 13.57px;">sentry</a><a href="../tags/testing/" style="font-size: 17.86px;">testing</a><a href="../tags/tutorial/" style="font-size: 12.86px;">tutorial</a><a href="../tags/ui/" style="font-size: 10px;">ui</a><a href="../tags/web-workers/" style="font-size: 12.86px;">web workers</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/12/">December 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/11/">November 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/08/">August 2015</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/07/">July 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/06/">June 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/05/">May 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/04/">April 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/03/">March 2015</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/02/">February 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/01/">January 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/12/">December 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/11/">November 2014</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/10/">October 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/09/">September 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/08/">August 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/07/">July 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/06/">June 2014</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/05/">May 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/04/">April 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/03/">March 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/02/">February 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/01/">January 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/12/">December 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/11/">November 2013</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/10/">October 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/09/">September 2013</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../my-node-tools/">My Node tools</a>
          </li>
        
          <li>
            <a href="../pass-the-logic/">Pass the logic</a>
          </li>
        
          <li>
            <a href="../use-some-es6-in-cli-apps/">Use some ES6 in CLI apps</a>
          </li>
        
          <li>
            <a href="../1-2-3-linted/">1, 2, 3, linted</a>
          </li>
        
          <li>
            <a href="../how-to-setup-semantic-release-on-circle-ci/">How to setup semantic release on Circle CI</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Gleb Bahmutov<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="..//" class="mobile-nav-link">Home</a>
  
</nav>
    
<script>
  var disqus_shortname = 'betterworldbybettersoftware';
  
  var disqus_url = 'http://glebbahmutov.com/blog/playing-with-pouchdb/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="../fancybox/jquery.fancybox.css" type="text/css">
  <script src="../fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="../js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>