<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Robustness testing using proxies | Better world by better software</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="What happens to your web application if one of the static libraries takes 10 seconds to load instead of 100ms?
Does it stay blank? Does it crash? Does it show the page but then crashes when the user t">
<meta property="og:type" content="article">
<meta property="og:title" content="Robustness testing using proxies">
<meta property="og:url" content="http://glebbahmutov.com/blog/robustness-testing-using-proxies/index.html">
<meta property="og:site_name" content="Better world by better software">
<meta property="og:description" content="What happens to your web application if one of the static libraries takes 10 seconds to load instead of 100ms?
Does it stay blank? Does it crash? Does it show the page but then crashes when the user t">
<meta property="og:image" content="https://raw.githubusercontent.com/bahmutov/github-user/master/images/github-user.png">
<meta property="og:image" content="https://raw.githubusercontent.com/bahmutov/github-user/master/images/turtle-run-overview.png">
<meta property="og:image" content="https://raw.githubusercontent.com/bahmutov/github-user/master/images/pending-angularjs.png">
<meta property="og:image" content="https://raw.githubusercontent.com/bahmutov/github-user/master/images/service-turtle.png">
<meta property="og:image" content="https://raw.githubusercontent.com/bahmutov/github-user/master/images/service-turtle-hi.png">
<meta property="og:image" content="https://raw.githubusercontent.com/bahmutov/github-user/master/images/service-turtle-500.png">
<meta property="og:image" content="https://raw.githubusercontent.com/bahmutov/github-user/master/images/ng-wedge-diagram.png">
<meta property="og:image" content="https://raw.githubusercontent.com/bahmutov/github-user/master/images/ng-wedge-example.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Robustness testing using proxies">
<meta name="twitter:description" content="What happens to your web application if one of the static libraries takes 10 seconds to load instead of 100ms?
Does it stay blank? Does it crash? Does it show the page but then crashes when the user t">
<meta name="twitter:creator" content="@bahmutov">
  
    <link rel="alternative" href="/blog/atom.xml" title="Better world by better software" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="../css/style.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-59999353-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="..//" id="logo">Better world by better software</a>
      </h1>
      <!--
      
        <h2 id="subtitle-wrap">
          <a href="..//" id="subtitle">Software advice from Dr. Gleb Bahmutov PhD</a>
        </h2>
      
      -->
      <h2 id="subtitle-wrap">
        <span class="subtitle">Software advice from <a id="subtitle" href="http://glebbahmutov.com">Dr. Gleb Bahmutov PhD</a></span>
      </h2>
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="..//">Home</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="q" value="site:http://glebbahmutov.com/blog"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-robustness-testing-using-proxies" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2014-12-23T05:00:00.000Z" itemprop="datePublished">Dec 23 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../categories/products/">products</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Robustness testing using proxies
    </h1>

    <h2 class="article-title" itemprop="name">
      Mocking responses using turtle-run, service-turtle and ng-wedge.
    </h2>

  


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>What happens to your web application if one of the static libraries takes 10 seconds to load instead of 100ms?
Does it stay blank? Does it crash? Does it show the page but then crashes when the user tries to interact with it?</p>
<p>What happens if the server responds with a 500 error code to an Ajax request? Do you silently swallow the error,
and the user keeps waiting in vain? Does the web application crash? Or does it show a meaningful error message 
to the user? Is the error sent to the crash reporting service, like <a href="../tags/sentry">Sentry</a>?</p>
<p>I consider the web sites that graciously handle run time errors like an occasional 500 server response to be
well-built and trustworthy ones. It is a good sign that the team not only has finished working on the 
regular features but has also properly designed and tested the error handling code paths.</p>
<p>From my personal development experience testing all possible intermittent failures is very hard
and time consuming. It is very difficult to simulate an occasional 500 error on demand - the feature testing against
the staging or production environments assumes the servers are a black box. Adding the ability to simulate the server&apos;s
failures will surely add unnecessary complexity to the server&apos;s code. It also does not allow simulating 
network delays and responses with an unexpected data formats (two things very common in the real world).</p>
<p>I have designed and coded 3 different types of proxies for simulating these specific types of failures.
The proxies can be used without any or with minimal application code modifications and allow simulating server
failures, network delays and returning data in an unexpected format. These proxies are:</p>
<ul>
<li><a href="https://github.com/bahmutov/turtle-run" target="_blank" rel="external">turtle-run</a> is a stand alone proxy that runs between the tester and server. 
It can slow down some requests, or return a specific status code or mock data based on url match.</li>
<li><a href="https://github.com/bahmutov/service-turtle" target="_blank" rel="external">service-turtle</a> is a proxy that runs inside the latest Chrome browser using 
<a href="http://jakearchibald.com/2014/using-serviceworker-today/" target="_blank" rel="external">ServiceWorker</a> technology. It can intercept any HTTP request and return a fake status, 
and even delay the mock response by a given time period.</li>
<li><a href="https://github.com/bahmutov/ng-wedge" target="_blank" rel="external">ng-wedge</a> is the last script that can modify the web application&apos;s code on the fly. It is the most
flexible approach that does not require an intermediate proxy server or an experimental browser API. Unfortunately this
approach assumes the tested application uses AngularJS framework and requires good development insight into the
application&apos;s code. In my opinion it is most useful to the developer who is working on the application.</li>
</ul>
<p>I will show how these proxies can be used to test the web application&apos;s robustness to the common errors
using a small AngularJS application. The source code is available at <a href="https://github.com/bahmutov/github-user" target="_blank" rel="external">bahmutov/github-user</a>
and the live demo is available at <a href="http://glebbahmutov.com/github-user/" target="_blank" rel="external">glebbahmutov.com/github-user</a>.</p>
<p><img src="https://raw.githubusercontent.com/bahmutov/github-user/master/images/github-user.png" alt="github user screenshot"></p>
<p>You can follow the application&apos;s testing by cloning the repo and starting with tag <code>step-0</code></p>
<pre><code>git <span class="keyword">clone</span> <span class="title">git</span>@github.com:bahmutov/github-user.git
cd github-<span class="keyword">user</span>
<span class="title">git</span> checkout step-<span class="number">0</span>
</code></pre><p>I recommend that you use a static http server to run the web application, for example <a href="https://github.com/nodeapps/http-server" target="_blank" rel="external">http-server</a></p>
<pre><code>cd github-user
sudo npm <span class="operator"><span class="keyword">install</span> -<span class="keyword">g</span> <span class="keyword">http</span>-<span class="keyword">server</span>
<span class="keyword">http</span>-<span class="keyword">server</span> -<span class="keyword">p</span> <span class="number">3003</span>
// <span class="keyword">open</span> localhost:<span class="number">3003</span> <span class="keyword">in</span> your browser</span>
</code></pre><p>The application should run in the local browser at <code>localhost:3003</code>. If you enter a github username and click
&quot;Load user info&quot; there is separate Ajax request to <code>https://api.github.com</code>. The results should be displayed
below the input box. </p>
<h2 id="testing-against-network-delays-using-turtle-run">Testing against network delays using turtle-run</h2><p>The first thing we want to test is how the application looks when a 3rd party library does not load at all or
loads only after a delay. The <code>github-user</code> demo page requires only a single external script to load, 
and it is included with the repo itself.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">&quot;bower_components/angular/angular.js&quot;</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span> <span class="attribute">ng-app</span>=<span class="value">&quot;GithubUser&quot;</span> <span class="attribute">ng-controller</span>=<span class="value">&quot;GithubUserController&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">h1</span>&gt;</span>github-user<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>What happens if the <code>angular.js</code> file does not load? Does the page stay blank? Usually we load the script 
<code>angular.js</code> from a CDN, so it is likely that it will ultimately load, but there might be a significant delay. 
Let us simulate the delay in loading <code>angular.js</code> using a proxy and see how the web page looks 
while the request is pending.</p>
<p>Install the <code>turtle-run</code> proxy and create a JSON file describing which request to delay. I created sample
file and tagged the commit <code>step-1</code></p>
<pre><code>sudo npm install -g turtle-<span class="built_in">run</span>
git checkout <span class="keyword">step</span>-<span class="number">1</span>
</code></pre><p>The <code>turtles.json</code> is very simple. It tells the proxy where to forward requests to, and for each matching
url pattern what to return / delay amount. In this case <code>angular.js</code> script will be loaded after 5 seconds.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  &quot;<span class="attribute">target</span>&quot;: <span class="value"><span class="string">&quot;http://localhost:3003&quot;</span></span>,</span><br><span class="line">  &quot;<span class="attribute">port</span>&quot;: <span class="value"><span class="number">8008</span></span>,</span><br><span class="line">  &quot;<span class="attribute">debug</span>&quot;: <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">  &quot;<span class="attribute">urls</span>&quot;: <span class="value">{</span><br><span class="line">    &quot;<span class="attribute">angular.js</span>&quot;: <span class="value"><span class="number">5000</span></span><br><span class="line">  </span>}</span><br><span class="line"></span>}</span><br></pre></td></tr></table></figure>
<p>While the local <code>http-server</code> is running at port 3003, start the <code>turtle-run</code> and pass it the turtle 
config json filename. We can start in the <code>github-user</code> folder using the default <code>turtles.json</code> filename</p>
<pre><code>cd github-<span class="keyword">user</span>
<span class="title">http-server</span> -p <span class="number">3003</span> &amp;
turtle-run
</code></pre><p>Open the browser <code>localhost:8008</code>. </p>
<pre><code>GET /
GET /bower_components/angular/angular.js
Connect-slow: delaying <span class="number">5000</span> <span class="keyword">ms</span> <span class="title">on</span> url /bower_components/angular/angular.js
</code></pre><p>The <code>turtle-run</code> sits between the local server and the user&apos;s browser, intercepting every request
and deciding how to proceed. Most of the requests are just forwarded to the target. The requests matching
the <code>/angular\.js/</code> regular expression are forwarded to the target server after 5 seconds. Note: the Ajax request
to the Github API is NOT proxied by the <code>turtle-run</code> because it is a direct cross-domain request 
from the page to the Github API endpoint.</p>
<p><img src="https://raw.githubusercontent.com/bahmutov/github-user/master/images/turtle-run-overview.png" alt="turtle-run overview"></p>
<p>Notice that the page stays blank for 5 seconds before anything appears!
This is because the proxy slows down <code>bower_components/angular/angular.js</code> script, returning the
script after 5 seconds. The script is included in the <code>head</code> element and is blocking the rest of the page
from loading.</p>
<p>We can solve this problem by moving the script to the bottom of the page (or by adding <code>async</code> attribute).
After moving the <code>angular.js</code> to the bottom of the <code>body</code> tag, the page loads right away, despite the delay.
Unfortunately, this shows a few new problems.</p>
<p><img src="https://raw.githubusercontent.com/bahmutov/github-user/master/images/pending-angularjs.png" alt="pending angular"></p>
<p>We can hide the application until it is ready to interact with the user using <a href="https://docs.angularjs.org/api/ng/directive/ngCloak" target="_blank" rel="external">ng-cloak</a> directive.
To make the directive work, we include the angular CSS file in the <code>head</code> element 
(this small file will be blocking load), and then apply the cloak directive to the angular part of the page.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">&quot;stylesheet&quot;</span> <span class="attribute">type</span>=<span class="value">&quot;text/css&quot;</span> <span class="attribute">href</span>=<span class="value">&quot;bower_components/angular/angular-csp.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">h1</span>&gt;</span>github-user<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-app</span>=<span class="value">&quot;GithubUser&quot;</span> <span class="attribute">ng-controller</span>=<span class="value">&quot;GithubUserController&quot;</span> <span class="attribute">ng-cloak</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">ng-model</span>=<span class="value">&quot;username&quot;</span> /&gt;</span> <span class="tag">&lt;<span class="title">button</span> <span class="attribute">id</span>=<span class="value">&quot;load&quot;</span> <span class="attribute">ng-click</span>=<span class="value">&quot;load()&quot;</span>&gt;</span>Load user info<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">&quot;info&quot;</span> <span class="attribute">ng-show</span>=<span class="value">&quot;info&quot;</span>&gt;</span>{{ info | json }}<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">&quot;bower_components/angular/angular.js&quot;</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="actionscript"> </span><br><span class="line">        <span class="comment">// our application&apos;s code </span></span><br><span class="line">    </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Now even if the <code>angular.js</code> takes a long time to load, the user will see the initial page content.
Then the Angular application will reveal itself. You can see the changed code at tag <code>step-2</code>.</p>
<p>Using <code>turtle-run</code> one can make the application more robust to network and server errors.
Read <a href="../give-browser-a-chance/">Give browser a chance</a> for other suggestions
how to work around the delayed or missing page information.</p>
<h2 id="intercepting-cross-domain-ajax-calls-with-service-turtle">Intercepting cross-domain Ajax calls with service-turtle</h2><p>A stand alone proxy server like <code>turtle-run</code> has a downside - it cannot intercept Ajax calls from the page
to other service endpoints. For example, the demo page <code>github-user</code> makes a request directly from the page to
the Github API</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$http.get(<span class="string">&apos;https://api.github.com/users/&apos;</span> + $scope.username)</span><br></pre></td></tr></table></figure>
<p>Can we test how our page handles 500 error from the Github API? We can by modifying the application&apos;s
code a little and introducing <a href="https://github.com/bahmutov/service-turtle" target="_blank" rel="external">service-turtle</a>. It is a proxy that sits behind the
page and can intercept any request. The proxy is implemented using an experimental API called 
ServiceWorker, and requires running the Chrome browser (at least version 39) with an advanced flag enabled</p>
<pre><code>Open <span class="string">chrome:</span><span class="comment">//flags/ in the Chrome browser</span>
Enable <span class="string">&quot;Enable experimental Web Platform features.&quot;</span>
Restart Chrome
</code></pre><p>You can grab the code and run the application with the included <code>service-turtle</code> by checking out 
<code>step-3</code> and running http-server locally using <code>http-server -p 3003</code>. 
When running the local server, the page loads <code>turtle.js</code>, which
in turn initializes the service worker using script <code>service-turtle.js</code>. Every Ajax request from the page
then generates <code>fetch</code> event inside the ServiceWorker. </p>
<p><img src="https://raw.githubusercontent.com/bahmutov/github-user/master/images/service-turtle.png" alt="service turtle"></p>
<p>The worker can let the <code>fetch</code> event pass, letting the request through. 
The worker can also respond to the event with fake data using <code>event.respondWith</code> method.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// self - reference to the ServiceWorker itself</span></span><br><span class="line">self.addEventListener(<span class="string">&apos;fetch&apos;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>{</span><br><span class="line">    <span class="comment">// mockData - mock response for event.request.url </span></span><br><span class="line">    <span class="keyword">var</span> options = mockData.options || {};</span><br><span class="line">    <span class="keyword">var</span> responseOptions = {</span><br><span class="line">      status: options.code || options.status || options.statusCode,</span><br><span class="line">      headers: {</span><br><span class="line">        <span class="string">&apos;Access-Control-Allow-Origin&apos;</span>: <span class="string">&apos;*&apos;</span>,</span><br><span class="line">        <span class="string">&apos;Content-Type&apos;</span>: <span class="string">&apos;application/json; charset=utf-8&apos;</span></span><br><span class="line">      }</span><br><span class="line">    };</span><br><span class="line">    <span class="keyword">var</span> body = <span class="built_in">JSON</span>.stringify(options.body || options.data);</span><br><span class="line">    <span class="keyword">var</span> response = <span class="keyword">new</span> Response(body, responseOptions);</span><br><span class="line">    event.respondWith(response);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>We can confirm that this is working by registering a mock response using <code>turtle</code> object the script
registers globally</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">turtle.get(<span class="string">&apos;/users/&apos;</span>, { code: <span class="number">200</span>, body: <span class="string">&apos;hi there&apos;</span> });</span><br></pre></td></tr></table></figure>
<p>The object <code>turtle</code> registered from the <code>bower_components/service-turtle/turtle.js</code> script
sends the arguments to the service worker by posting a message.
The execution example (first the normal request, then the mocked one) is shown below.</p>
<p><img src="https://raw.githubusercontent.com/bahmutov/github-user/master/images/service-turtle-hi.png" alt="service turtle mock"></p>
<p>If we want to delay the mock response by N milliseconds, we can using Promise API.
We just need to respond with a Promise object</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(<span class="string">&apos;fetch&apos;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>{</span><br><span class="line">    <span class="comment">// response object created as above</span></span><br><span class="line">    event.respondWith(<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>{</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">            resolve(response);</span><br><span class="line">        }, options.timeout);</span><br><span class="line">    }));</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="testing-and-handling-server-error-responses">Testing and handling server error responses</h3><p>In the next example, we can mock <code>/users</code> request to return server error 500. </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">turtle.get(<span class="string">&apos;/users/&apos;</span>, { code: <span class="number">500</span> });</span><br></pre></td></tr></table></figure>
<p>Notice that the error is only printed to the console log, no user message appears and the result of the previous
fetch is still displayed. Thus the application will NOT handle Github server errors in a user-friendly manner.</p>
<p><img src="https://raw.githubusercontent.com/bahmutov/github-user/master/images/service-turtle-500.png" alt="service turtle 500"></p>
<p>It is simple to fix: just put the error message into the result to be displayed</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$http.get(<span class="string">&apos;https://api.github.com/users/&apos;</span> + $scope.username)</span><br><span class="line">  .success(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>{</span><br><span class="line">    ...</span><br><span class="line">  })</span><br><span class="line">  .error(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>{</span><br><span class="line">    $scope.info = <span class="string">&apos;Could not fetch info for user &apos;</span> + $scope.username;</span><br><span class="line">    <span class="built_in">console</span>.error(err);</span><br><span class="line">  });</span><br></pre></td></tr></table></figure>
<p>Now the user will know something bad has happened and will not wait or be confused by previous data.</p>
<p>I plan to extend <a href="https://github.com/bahmutov/service-turtle" target="_blank" rel="external">service-turtle</a> to cover POST, DELETE, PUT and PATCH methods to allow
mocking any request. Even with just GET method support, the <code>service-turtle</code> seems a very powerful tool
at the cost of including a very small script. 
The inclusion could be limited to the development and the staging environments for security. 
The service workers are already limited to be loaded from <em>safe</em> urls: <code>localhost</code> or <code>https</code>.
This prevents me from demoing this feature from the Github pages, since it does not support SSL.</p>
<p>Another important thing to remember - I do not know what the actual Github server response is
for 500 errors. Instead of a plain error string like I used in the mock, it could be an object:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    type: <span class="string">&apos;error&apos;</span>,</span><br><span class="line">    message: <span class="string">&apos;Something went wrong on our side&apos;</span>,</span><br><span class="line">    code: <span class="number">500</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>It is important to know the response schema you might want to mock, otherwise you are in for a surprise.</p>
<h2 id="intercepting-request-on-the-fly-using-ng-wedge">Intercepting request on the fly using ng-wedge</h2><p>What if we cannot run a proxy between the client and the server (like <em>turtle-run</em> works) and do not want to include
a separate ServiceWorker (like <em>service-turtle</em> does)? What if we do not even want to reload our web application,
but just want to mock a response? Seems like an impossible task - hooking into the live application and changing
its behavior. </p>
<p>Luckily, in case of AngularJS application we can do such substitution on the fly. Other frameworks could potentially
work too, but for now I use mostly AngularJS so I will concentrate on this framework. A typical application (like our
<code>github-user</code>) has a <code>$scope</code> object. The <code>$scope</code> object is initialized inside a <code>controller</code> function. The controller
also injects <code>$http</code> service object. This <code>$http</code> object is used to perform all Ajax requests.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">controller(<span class="string">&apos;GithubUserController&apos;</span>, <span class="function"><span class="keyword">function</span> <span class="title">ctrl</span>(<span class="params">$scope, $http</span>) </span>{</span><br><span class="line">    $scope.load = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">        $http.get(<span class="string">&apos;https://api.github.com/users/&apos;</span> + $scope.username)</span><br><span class="line">            .success(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>{</span><br><span class="line">                <span class="built_in">console</span>.log(data);</span><br><span class="line">                $scope.info = data;</span><br><span class="line">            })</span><br><span class="line">            .error(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>{</span><br><span class="line">                $scope.info = <span class="string">&apos;Could not fetch info for user &apos;</span> + $scope.username;</span><br><span class="line">                <span class="built_in">console</span>.error(err);</span><br><span class="line">            });</span><br><span class="line">        };</span><br><span class="line">    });</span><br></pre></td></tr></table></figure>
<p>At runtime the method <code>$scope.load</code> will be called when the user clicks on a button</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">id</span>=<span class="value">&quot;load&quot;</span> <span class="attribute">ng-click</span>=<span class="value">&quot;load()&quot;</span>&gt;</span>Load user info<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>We can get the reference to the actual <code>$scope</code> object from the browser&apos;s console at any moment.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $scope = angular.element(<span class="built_in">document</span>.getElementById(<span class="string">&apos;load&apos;</span>)).scope();</span><br><span class="line"><span class="comment">// $scope is</span></span><br><span class="line">{</span><br><span class="line">    <span class="comment">// internal properties ...</span></span><br><span class="line">    $parent: Scope,</span><br><span class="line">    load: <span class="function"><span class="keyword">function</span> (<span class="params"></span>),</span><br><span class="line">    <span class="title">username</span>: &quot;<span class="title">bahmutov</span>&quot;</span><br><span class="line">}</span></span><br></pre></td></tr></table></figure>
<h3 id="mocking-live-http-call">Mocking live $http call</h3><p>One of the JavaScript&apos;s strengths is its dynamic nature. We can easily replace / wrap a method with another
method at run time.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $scope = angular.element(<span class="built_in">document</span>.getElementById(<span class="string">&apos;load&apos;</span>)).scope();</span><br><span class="line">$scope.load = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{ <span class="built_in">console</span>.log(<span class="string">&apos;hi&apos;</span>); };</span><br><span class="line"><span class="comment">// click on &quot;load&quot; button</span></span><br><span class="line"><span class="comment">// console prints &quot;hi&quot;</span></span><br></pre></td></tr></table></figure>
<p>To mock responses, we do not want to replace the <code>$scope.load</code> method. Instead we want to somehow replace
<em>the $http object</em> used inside <code>$scope.load</code>. We can replace it with our own &quot;proxy&quot; $http object that can
pass most calls to the real <code>$http</code> service, but return mock responses for some requests. In a sense
we want to mock a variable available to the <code>$scope.load</code> via lexical scope</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// application code</span></span><br><span class="line">controller(<span class="string">&apos;GithubUserController&apos;</span>, <span class="function"><span class="keyword">function</span> <span class="title">ctrl</span>(<span class="params">$scope, $http</span>) </span>{</span><br><span class="line">    $scope.load = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">        $http.get();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// browser console</span></span><br><span class="line"><span class="keyword">var</span> $scope = angular.element(<span class="built_in">document</span>.getElementById(<span class="string">&apos;load&apos;</span>)).scope();</span><br><span class="line"><span class="comment">// Hmm, how can we access the $http argument passed into ctrl function?</span></span><br></pre></td></tr></table></figure>
<p>Fortunately this is possible via <a href="../faking-lexical-scope/">Faking lexical scope</a> method. In principle we
convert the actual method <code>$scope.load</code> to its source code using <code>.toString()</code>, then <code>eval</code> it back
but prepend the source code with mock <code>$http</code> variable. Any variable <code>eval</code> does not find in the source
are plucked from the lexical scope of the place where the <code>eval</code> is called.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $scope = angular.element(<span class="built_in">document</span>.getElementById(<span class="string">&apos;load&apos;</span>)).scope();</span><br><span class="line"><span class="keyword">var</span> $http = {</span><br><span class="line">    get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{ <span class="built_in">console</span>.log(<span class="string">&apos;I am fake $http&apos;</span>); }</span><br><span class="line">};</span><br><span class="line">$scope.load = <span class="built_in">eval</span>($scope.load.toString());</span><br><span class="line"><span class="comment">// click &quot;load&quot; button</span></span><br><span class="line">prints <span class="string">&apos;I am fake $http&apos;</span></span><br></pre></td></tr></table></figure>
<p>The code is modified in page, without any extras needed</p>
<p><img src="https://raw.githubusercontent.com/bahmutov/github-user/master/images/ng-wedge-diagram.png" alt="ng-wedge-diagram"></p>
<h3 id="driving-an-wedge-into-live-production-app">Driving an wedge into live production app</h3><p>Let us go back to our demo at <a href="http://glebbahmutov.com/github-user/" target="_blank" rel="external">glebbahmutov.com/github-user</a>.
Open the browser console and copy / paste the entire file <a href="https://github.com/bahmutov/ng-wedge/blob/master/ng-wedge.js" target="_blank" rel="external">ng-wedge.js</a>.
<code>ng-wedge</code> operates on a specific <code>$scope</code> instance&apos;s method. First we make a mock object,
then define a fake response for specific url. Let us return an error message after a delay of 2000ms</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mock = wedge(<span class="string">&apos;#load&apos;</span>, <span class="string">&apos;load&apos;</span>);</span><br><span class="line">mock(<span class="string">&apos;get&apos;</span>, <span class="string">&apos;https://api.github.com/users/bahmutov&apos;</span>, <span class="number">500</span>, <span class="string">&apos;not working&apos;</span>, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>
<p>Here is how it looks in action</p>
<p><img src="https://raw.githubusercontent.com/bahmutov/github-user/master/images/ng-wedge-example.png" alt="ng-wedge screenshot"></p>
<p>Notice that there is no actual HTTP request in the network tab - the request is 
intercepted before the Ajax request happens.
Any other Ajax request, even to the same Github API endpoint happening through other <code>$scope</code> objects 
would NOT be intercepted by <code>ng-wedge</code>. It only replaces a particular method on a specific <code>$scope</code> instance. </p>
<h2 id="summary">Summary</h2><p>I created 3 different proxy tools for conveniently mocking server responses.</p>
<ul>
<li><a href="https://github.com/bahmutov/turtle-run" target="_blank" rel="external">turtle-run</a> - a stand alone proxy between the user and the server. Does not require any modifications to
the server code to run. The user needs to access the proxy URL instead of the actual server url. The proxy
cannot work with <code>https</code> servers or proxy cross-domain requests.</li>
<li><a href="https://github.com/bahmutov/service-turtle" target="_blank" rel="external">service-turtle</a> - a good choice for local development. Requires using the latest version of 
Chrome browser and turning on an experimental feature support. It is powerful and simple to control on demand, 
the code is still under development.</li>
<li><a href="https://github.com/bahmutov/ng-wedge" target="_blank" rel="external">ng-wedge</a> - a good choice for a developer when investigating the production website&apos;s behavior.
Does not require adding extra libraries or even reloading the page.
Currently works with AngularJS web applications only, but could be adapted to other frameworks. 
Requires a &quot;simple&quot; controller code that can be reused in <code>eval</code> call.</li>
</ul>

      
    </div>

    
      <footer class="article-footer personal-links">
  Follow Gleb Bahmutov <a href="https://twitter.com/bahmutov">@bahmutov</a>,
  see his projects at <a href="http://glebbahmutov.com">glebbahmutov.com</a>
</footer>

    

    <footer class="article-footer">
      <a data-url="http://glebbahmutov.com/blog/robustness-testing-using-proxies/" data-id="ciihys1qx00a2aomm3gdtpg2c" class="article-share-link">Share</a>
      
        <a href="http://glebbahmutov.com/blog/robustness-testing-using-proxies/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/advice/">advice</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/browser/">browser</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/testing/">testing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/web-workers/">web workers</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../essence-of-functional-programming/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Essence of functional programming
        
      </div>
    </a>
  
  
    <a href="../angularjs-performance-lessons/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">AngularJS performance lessons</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../categories/book-review/">book review</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/people/">people</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/process/">process</a><span class="category-list-count">69</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/products/">products</a><span class="category-list-count">190</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="../tags/QUnit/">QUnit</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/advice/">advice</a><span class="tag-list-count">83</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angular/">angular</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs/">angularjs</a><span class="tag-list-count">54</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs2/">angularjs2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/assertions/">assertions</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/boilerplate/">boilerplate</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/browser/">browser</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/concurrency/">concurrency</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/d3/">d3</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/database/">database</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/db/">db</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es6/">es6</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es7/">es7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/functional/">functional</a><span class="tag-list-count">42</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/generators/">generators</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/git/">git</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/grunt/">grunt</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/gulp/">gulp</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/immutable/">immutable</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/interview/">interview</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jade/">jade</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/javascript/">javascript</a><span class="tag-list-count">143</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jshint/">jshint</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/modular-development/">modular development</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/nodejs/">nodejs</a><span class="tag-list-count">54</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/performance/">performance</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/promises/">promises</a><span class="tag-list-count">30</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/proposal/">proposal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactive/">reactive</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactjs/">reactjs</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/security/">security</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/sentry/">sentry</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/testing/">testing</a><span class="tag-list-count">44</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/tutorial/">tutorial</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ui/">ui</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/web-workers/">web workers</a><span class="tag-list-count">5</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../tags/QUnit/" style="font-size: 13.08px;">QUnit</a><a href="../tags/advice/" style="font-size: 19.23px;">advice</a><a href="../tags/angular/" style="font-size: 10px;">angular</a><a href="../tags/angularjs/" style="font-size: 18.46px;">angularjs</a><a href="../tags/angularjs2/" style="font-size: 10px;">angularjs2</a><a href="../tags/assertions/" style="font-size: 13.85px;">assertions</a><a href="../tags/boilerplate/" style="font-size: 15.38px;">boilerplate</a><a href="../tags/browser/" style="font-size: 14.62px;">browser</a><a href="../tags/concurrency/" style="font-size: 10px;">concurrency</a><a href="../tags/d3/" style="font-size: 11.54px;">d3</a><a href="../tags/database/" style="font-size: 10px;">database</a><a href="../tags/db/" style="font-size: 13.08px;">db</a><a href="../tags/es6/" style="font-size: 14.62px;">es6</a><a href="../tags/es7/" style="font-size: 10px;">es7</a><a href="../tags/functional/" style="font-size: 16.92px;">functional</a><a href="../tags/generators/" style="font-size: 13.08px;">generators</a><a href="../tags/git/" style="font-size: 13.85px;">git</a><a href="../tags/grunt/" style="font-size: 13.85px;">grunt</a><a href="../tags/gulp/" style="font-size: 11.54px;">gulp</a><a href="../tags/immutable/" style="font-size: 10px;">immutable</a><a href="../tags/interview/" style="font-size: 11.54px;">interview</a><a href="../tags/jade/" style="font-size: 12.31px;">jade</a><a href="../tags/javascript/" style="font-size: 20px;">javascript</a><a href="../tags/jshint/" style="font-size: 11.54px;">jshint</a><a href="../tags/modular-development/" style="font-size: 15.38px;">modular development</a><a href="../tags/nodejs/" style="font-size: 18.46px;">nodejs</a><a href="../tags/performance/" style="font-size: 15.38px;">performance</a><a href="../tags/promises/" style="font-size: 16.15px;">promises</a><a href="../tags/proposal/" style="font-size: 10.77px;">proposal</a><a href="../tags/reactive/" style="font-size: 10.77px;">reactive</a><a href="../tags/reactjs/" style="font-size: 10.77px;">reactjs</a><a href="../tags/security/" style="font-size: 12.31px;">security</a><a href="../tags/sentry/" style="font-size: 13.85px;">sentry</a><a href="../tags/testing/" style="font-size: 17.69px;">testing</a><a href="../tags/tutorial/" style="font-size: 13.08px;">tutorial</a><a href="../tags/ui/" style="font-size: 10px;">ui</a><a href="../tags/web-workers/" style="font-size: 13.08px;">web workers</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/12/">December 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/11/">November 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/08/">August 2015</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/07/">July 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/06/">June 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/05/">May 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/04/">April 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/03/">March 2015</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/02/">February 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/01/">January 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/12/">December 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/11/">November 2014</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/10/">October 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/09/">September 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/08/">August 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/07/">July 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/06/">June 2014</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/05/">May 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/04/">April 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/03/">March 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/02/">February 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/01/">January 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/12/">December 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/11/">November 2013</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/10/">October 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/09/">September 2013</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../hydrate-at-build-time/">Hydrate at build time</a>
          </li>
        
          <li>
            <a href="../hydrate-your-apps/">Hydrate your apps</a>
          </li>
        
          <li>
            <a href="../my-node-tools/">My Node tools</a>
          </li>
        
          <li>
            <a href="../pass-the-logic/">Pass the logic</a>
          </li>
        
          <li>
            <a href="../use-some-es6-in-cli-apps/">Use some ES6 in CLI apps</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Gleb Bahmutov<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="..//" class="mobile-nav-link">Home</a>
  
</nav>
    
<script>
  var disqus_shortname = 'betterworldbybettersoftware';
  
  var disqus_url = 'http://glebbahmutov.com/blog/robustness-testing-using-proxies/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="../fancybox/jquery.fancybox.css" type="text/css">
  <script src="../fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="../js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>