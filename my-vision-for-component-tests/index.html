<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>My Vision for Component Tests in Cypress | Better world by better software</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Example application The Goal Adding tests Code coverage Component test Styles Testing the interface GraphQL example Components all the way down Benefits Examples Future plans Thank you    I have be">
<meta property="og:type" content="article">
<meta property="og:title" content="My Vision for Component Tests in Cypress">
<meta property="og:url" content="https://glebbahmutov.com/blog/my-vision-for-component-tests/index.html">
<meta property="og:site_name" content="Better world by better software">
<meta property="og:description" content="Example application The Goal Adding tests Code coverage Component test Styles Testing the interface GraphQL example Components all the way down Benefits Examples Future plans Thank you    I have be">
<meta property="og:locale">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/app-code.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/complete.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/e2e-test.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/code-coverage-messages.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/code-coverage.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/code-coverage-app.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/todo-form-test.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/todo1.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/todo2.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/todo3.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/graphql-test.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/components/app-test.gif">
<meta property="article:published_time" content="2020-04-29T04:00:00.000Z">
<meta property="article:modified_time" content="2022-01-13T13:39:26.304Z">
<meta property="article:author" content="Gleb Bahmutov">
<meta property="article:tag" content="cypress">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://glebbahmutov.com/blog/images/components/app-code.png">
<meta name="twitter:creator" content="@bahmutov">
  
    <link rel="alternative" href="/blog/atom.xml" title="Better world by better software" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="preload" href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" as="style">
  
<link rel="stylesheet" href="../css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-59999353-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-titles">
      <div id="header-title" class="inner">
        <h1 id="logo-wrap">
          <a href="../index.html" id="logo">Better world by better software</a>
        </h1>
        <!--
        
        -->
        <!-- <span class="no-mobile">Software advice from</span> -->
        <h2 id="subtitle-wrap">
          <span class="subtitle">
            <a id="subtitle" href="https://glebbahmutov.com">Gleb Bahmutov PhD</a>
            <a id="nav-house-link" class="nav-icon" href="/" title="Home"></a>
            
              <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
            
            <a id="nav-search-btn" class="nav-icon" title="Search"></a>
            <div id="search-form-wrap">
              <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://glebbahmutov.com/blog"></form>
            </div>
          </span>
        </h2>

      </div>
    </div>
    <div id="climate-crisis">
      <h2>Our planet üåè is in danger</h2>
      <h3>Act today: <a href="/blog/climate-emergency/">what you can do</a></h3>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-my-vision-for-component-tests" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2020-04-29T04:00:00.000Z" itemprop="datePublished">Apr 29 2020</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../categories/process/">process</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      My Vision for Component Tests in Cypress
    </h1>

    <h2 class="article-title" itemprop="name">
      How I see end-to-end and component and unit tests working together
    </h2>

  


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- toc -->

<ul>
<li><a href="#example-application">Example application</a></li>
<li><a href="#the-goal">The Goal</a></li>
<li><a href="#adding-tests">Adding tests</a></li>
<li><a href="#code-coverage">Code coverage</a></li>
<li><a href="#component-test">Component test</a></li>
<li><a href="#styles">Styles</a></li>
<li><a href="#testing-the-interface">Testing the interface</a></li>
<li><a href="#graphql-example">GraphQL example</a></li>
<li><a href="#components-all-the-way-down">Components all the way down</a></li>
<li><a href="#benefits">Benefits</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#future-plans">Future plans</a></li>
<li><a href="#thank-you">Thank you</a></li>
</ul>
<!-- tocstop -->

<p>I have been talking about framework-specific component testing for ages now. I have even coded a bunch of adaptors like <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-react-unit-test">cypress-react-unit-test</a>, <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-vue-unit-test">cypress-vue-unit-test</a> and others, that allow mounting individual components into Cypress and run them as full-fledged mini-web applications. While the initial solution was technically ok, due to the way Cypress works it has a long list of issues: React Hooks do not work, styles are often lost, etc.</p>
<p>I am excited to say that we have an <a target="_blank" rel="noopener" href="https://github.com/cypress-io/cypress/releases/tag/v4.5.0">experimental support</a> for a new way of binding test code in Cypress v4.5.0 that seems to solve <em>all known problems</em>. In this blog post I will show how it might work, once we release it.</p>
<center>
<strong>‚ö†Ô∏è Warning:</strong> component testing is currently in Alpha release. If you find a problem, please open an issue in the adaptor repo (like [bahmutov/cypress-react-unit-test][crut], [bahmutov/cypress-vue-unit-test][cvut]). Use this awesome feature at your own risk.
</center>

<h2><span id="example-application">Example application</span></h2><p>I will take a nice Todo application from blog post <a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/how-to-build-a-react-to-do-app-with-react-hooks">How To Build a React To-Do App with React Hooks</a> as the starting point. You can see this application yourself at its original <a target="_blank" rel="noopener" href="https://codesandbox.io/s/oj3qm2zq06">https://codesandbox.io/s/oj3qm2zq06</a> URL.</p>
<p><img src="/blog/images/components/app-code.png" alt="React Todo App"></p>
<p>I have downloaded the code from the sandbox to my repo <a target="_blank" rel="noopener" href="https://github.com/bahmutov/react-todo-with-hooks">https://github.com/bahmutov/react-todo-with-hooks</a>; it has a CSS file and two JS files - very compact example.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/repo</span><br><span class="line">  public/</span><br><span class="line">    index.html</span><br><span class="line">  src/</span><br><span class="line">    App.css</span><br><span class="line">    App.js</span><br><span class="line">    index.js</span><br><span class="line">  package.json</span><br></pre></td></tr></table></figure>

<p>The application is bundled and served using <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-scripts">react-scripts</a> which is often used to serve modern React applications.</p>
<figure class="highlight json"><figcaption><span>package.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;react&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;react-dom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;react-scripts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3.1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts start&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts build&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts test&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eject&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts eject&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2><span id="the-goal">The Goal</span></h2><p>I have noticed that the application allows us to mark Todo items as completed, but it never allows to &quot;undo&quot; completing an item. Once the task is done, there is no way to get it back to the initial incomplete state.</p>
<p><img src="/blog/images/components/complete.gif" alt="Completing an item cannot be undone"></p>
<p>I would like to change &quot;complete&quot; an item into &quot;toggle&quot; an item. But I don&#39;t know the code of the application, so it is dangerous to simply start hacking. We need tests first; and we want to make sure we test the entire application before changing its behavior.</p>
<h2><span id="adding-tests">Adding tests</span></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm i -D cypress</span></span><br><span class="line">+ cypress@4.5.0</span><br></pre></td></tr></table></figure>

<p>Our first full end-to-end test goes through a typical user story.</p>
<figure class="highlight js"><figcaption><span>cypress/integration/todo-spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;reference types=&quot;cypress&quot; /&gt;</span></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Todo App&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;completes an item&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// base url is stored in &quot;cypress.json&quot; file</span></span><br><span class="line">    cy.<span class="title function_">visit</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="comment">// there are several existing todos</span></span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;.todo&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;have.length&#x27;</span>, <span class="number">3</span>)</span><br><span class="line">    cy.<span class="title function_">log</span>(<span class="string">&#x27;**adding a todo**&#x27;</span>)</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;.input&#x27;</span>).<span class="title function_">type</span>(<span class="string">&#x27;write tests&#123;enter&#125;&#x27;</span>)</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;.todo&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;have.length&#x27;</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    cy.<span class="title function_">log</span>(<span class="string">&#x27;**completing a todo**&#x27;</span>)</span><br><span class="line">    cy.<span class="title function_">contains</span>(<span class="string">&#x27;.todo&#x27;</span>, <span class="string">&#x27;write tests&#x27;</span>).<span class="title function_">contains</span>(<span class="string">&#x27;button&#x27;</span>, <span class="string">&#x27;Complete&#x27;</span>).<span class="title function_">click</span>()</span><br><span class="line">    cy.<span class="title function_">contains</span>(<span class="string">&#x27;.todo&#x27;</span>, <span class="string">&#x27;write tests&#x27;</span>)</span><br><span class="line">      .<span class="title function_">should</span>(<span class="string">&#x27;have.css&#x27;</span>, <span class="string">&#x27;text-decoration&#x27;</span>, <span class="string">&#x27;line-through solid rgb(74, 74, 74)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    cy.<span class="title function_">log</span>(<span class="string">&#x27;**removing a todo**&#x27;</span>)</span><br><span class="line">    <span class="comment">// due to quarantine, we have to delete an item</span></span><br><span class="line">    <span class="comment">// without completing it</span></span><br><span class="line">    cy.<span class="title function_">contains</span>(<span class="string">&#x27;.todo&#x27;</span>, <span class="string">&#x27;Meet friend for lunch&#x27;</span>).<span class="title function_">contains</span>(<span class="string">&#x27;button&#x27;</span>, <span class="string">&#x27;x&#x27;</span>).<span class="title function_">click</span>()</span><br><span class="line">    cy.<span class="title function_">contains</span>(<span class="string">&#x27;.todo&#x27;</span>, <span class="string">&#x27;Meet friend for lunch&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;not.exist&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>The test runs and passes</p>
<p><img src="/blog/images/components/e2e-test.gif" alt="Full Cypress end-to-end test"></p>
<h2><span id="code-coverage">Code coverage</span></h2><p>Did we test all code paths in our application? The simplest way for us to find out is to measure how much of the application&#39;s code was executed by running this one e2e test. We can follow the <a target="_blank" rel="noopener" href="https://on.cypress.io/code-coverage">Cypress Code Coverage Guide</a> to set up coverage reporting.</p>
<center>
  <iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/edgeQZ8UpD0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center>

<ol>
<li>Instrument the application&#39;s code while running. For any application that uses <code>react-scripts</code> we can use module <a target="_blank" rel="noopener" href="https://github.com/cypress-io/instrument-cra">cypress-io&#x2F;instrument-cra</a> to do so on the fly.</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm i -D @cypress/instrument-cra</span></span><br><span class="line">+ @cypress/instrument-cra@1.1.0</span><br></pre></td></tr></table></figure>

<p>When we start the application, we preload this module first - and we will have application&#39;s code instrumented.</p>
<figure class="highlight json"><figcaption><span>package.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts -r @cypress/instrument-cra start&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>We need to add <a target="_blank" rel="noopener" href="https://github.com/cypress-io/code-coverage">@cypress&#x2F;code-coverage</a> to Cypress to merge coverage from tests and save report</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm i -D @cypress/code-coverage</span></span><br><span class="line">+ @cypress/code-coverage@3.1.0</span><br></pre></td></tr></table></figure>

<p>This plugin should be loaded from the support and plugins files</p>
<figure class="highlight js"><figcaption><span>cypress/support/index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@cypress/code-coverage/support&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>cypress/plugins/index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function">(<span class="params">on, config</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">require</span>(<span class="string">&#x27;@cypress/code-coverage/task&#x27;</span>)(on, config)</span><br><span class="line">  <span class="comment">// IMPORTANT to return the config object</span></span><br><span class="line">  <span class="comment">// with the any changed environment variables</span></span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Start Cypress again and run the test. You see &quot;Saving coverage from ...&quot; and &quot;Coverage report&quot; messages at the end of the run.</p>
<p><img src="/blog/images/components/code-coverage-messages.png" alt="Code coverage messages"></p>
<p>In the folder <code>coverage</code> you will find the report in several formats, let&#39;s open the static HTML one</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">open coverage/lcov-report/index.html</span></span><br></pre></td></tr></table></figure>

<p>Our single end-to-end test was <em>very effective</em> at covering almost all lines of the application.</p>
<p><img src="/blog/images/components/code-coverage.png" alt="Total code coverage"></p>
<p>We can drill down into individual file coverage.</p>
<p><img src="/blog/images/components/code-coverage-app.png" alt="A single line missed"></p>
<h2><span id="component-test">Component test</span></h2><p>The line we missed is inside <code>TodoForm</code> component, and it is kind of hard to confirm its behavior. We can easily write an end-to-end test that tries to &quot;enter&quot; empty input.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cy.<span class="title function_">get</span>(<span class="string">&#x27;input&#x27;</span>).<span class="title function_">type</span>(<span class="string">&#x27;&#123;enter&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">// there are still 3 todos</span></span><br><span class="line">cy.<span class="title function_">get</span>(<span class="string">&#x27;.todo&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;have.length&#x27;</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>BUT it does not confirm the property <code>addTodo</code> is not called at all. We really want to test the component, not the entire application.</p>
<p>Let&#39;s write a component test.</p>
<ol>
<li>Install <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-react-unit-test">cypress-react-unit-test v4+</a></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm i -D cypress-react-unit-test</span></span><br><span class="line">+ @cypress-react-unit-test@4.0.0</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>In <code>cypress.json</code> enable <a target="_blank" rel="noopener" href="https://on.cypress.io/experimental">experimental Cypress feature</a></li>
</ol>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://localhost:3000&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;testFiles&quot;</span><span class="punctuation">:</span> <span class="string">&quot;**/*spec.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;experimentalComponentTesting&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;componentFolder&quot;</span><span class="punctuation">:</span> <span class="string">&quot;src&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>While end-to-end tests reside by default in <code>cypress/integration</code> folder, let&#39;s place component tests right alongside the source code in <code>src</code> folder. We will filter the spec files using <code>&quot;testFiles&quot;: &quot;**/*spec.js&quot;</code> parameter.</p>
<ol start="3">
<li>Load <code>cypress-react-unit-test</code> from the support and plugins files</li>
</ol>
<figure class="highlight js"><figcaption><span>cypress/support/index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;cypress-react-unit-test/support&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><figcaption><span>cypress/plugins/index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function">(<span class="params">on, config</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">require</span>(<span class="string">&#x27;cypress-react-unit-test/plugins/cra-v3&#x27;</span>)(on, config)</span><br><span class="line">  <span class="comment">// IMPORTANT to return the config object</span></span><br><span class="line">  <span class="comment">// with the any changed environment variables</span></span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Unlike end-to-end tests, the component specs must be bundled the same way as the application code is. Thus we have added <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-react-unit-test/blob/master/docs/recipes.md">multiple plugins helpers</a> that find and use the bundling options your application is using. In this case, Cypress will find the Webpack config from <code>react-scripts</code> module and will use it.</p>
<p>Let&#39;s write component test!</p>
<figure class="highlight js"><figcaption><span>src/TodoForm.spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">TodoForm</span>&#125; <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;mount&#125; <span class="keyword">from</span> <span class="string">&#x27;cypress-react-unit-test&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;TodoForm&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;ignores empty input&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> addTodo = cy.<span class="title function_">stub</span>()</span><br><span class="line">    <span class="title function_">mount</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">TodoForm</span> <span class="attr">addTodo</span>=<span class="string">&#123;addTodo&#125;</span> /&gt;</span></span>)</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;input&#x27;</span>).<span class="title function_">type</span>(<span class="string">&#x27;&#123;enter&#125;&#x27;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">expect</span>(addTodo).<span class="property">not</span>.<span class="property">have</span>.<span class="property">been</span>.<span class="property">called</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;input&#x27;</span>).<span class="title function_">type</span>(<span class="string">&#x27;hello there&#123;enter&#125;&#x27;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">expect</span>(addTodo).<span class="property">to</span>.<span class="property">be</span>.<span class="title function_">calledWith</span>(<span class="string">&#x27;hello there&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>The component test directly imports <code>TodoForm</code> from the application code and mounts it using <code>mount</code> method from the <code>cypress-react-unit-test</code>. Once the component is mounted, it runs as a &quot;mini&quot; web application. We can use normal Cypress commands against it! Think of <code>mount</code> as <code>cy.visit</code> for components.</p>
<p><img src="/blog/images/components/todo-form-test.gif" alt="TodoForm component test"></p>
<p>You can see the component run inside Cypress iframe (where a regular web application usually runs during end-to-end test). You can interact with the component, inspect it using DevTools, see how it behaves using time-traveling debugger - all Cypress benefits apply both to end-to-end tests and to component tests. Plus code coverage is included by default!</p>
<h2><span id="styles">Styles</span></h2><p>When mounting a component, you might want to apply additional styles to make it look the same as in real application. The <code>mount</code> <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-react-unit-test#options">command options</a> let you specify inline style, CSS filename or external stylesheets. For example, here is the <code>Todo</code> component test.</p>
<figure class="highlight js"><figcaption><span>src/Todo.spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Todo</span>&#125; <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span></span><br><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;renders new item&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> todo = &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;test item&#x27;</span>,</span><br><span class="line">    <span class="attr">isCompleted</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// application loads Bulma library from public/index.html</span></span><br><span class="line">  <span class="comment">// so let&#x27;s load it from the component test too</span></span><br><span class="line">  <span class="title function_">mount</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Todo</span> <span class="attr">todo</span>=<span class="string">&#123;todo&#125;</span> /&gt;</span></span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">stylesheets</span>: [</span><br><span class="line">        <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.css&#x27;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  cy.<span class="title function_">contains</span>(<span class="string">&#x27;.todo button&#x27;</span>, <span class="string">&#x27;Complete&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="/blog/images/components/todo1.png" alt="First Todo test"></p>
<p>The buttons looks &quot;normal&quot;, but the entire component still does not look the same - because our styles come from <code>src/App.css</code> and require certain DOM structure. Let&#39;s recreate the structure and load additional CSS file in our test.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;renders with styles&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> todo = &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;test item&#x27;</span>,</span><br><span class="line">    <span class="attr">isCompleted</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">TestTodo</span> = (<span class="params"></span>) =&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">Todo</span> <span class="attr">todo</span>=<span class="string">&#123;todo&#125;</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  <span class="title function_">mount</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">TestTodo</span> /&gt;</span></span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">stylesheets</span>: [</span><br><span class="line">        <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.css&#x27;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">cssFile</span>: <span class="string">&#x27;src/App.css&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  cy.<span class="title function_">contains</span>(<span class="string">&#x27;.todo button&#x27;</span>, <span class="string">&#x27;Complete&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="/blog/images/components/todo2.png" alt="Second Todo test"></p>
<p>Looks good.</p>
<h2><span id="testing-the-interface">Testing the interface</span></h2><p>As I <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=5FnalKRjpZk&amp=&t=0s&amp=&index=5">argued before</a> - a component test is just a unit test where props are inputs and side effects like DOM, network calls, etc are outputs. Let&#39;s confirm that Todo component calls the <code>removeTodo</code> prop when the user clicks &quot;Remove&quot; button.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;deletes an item&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> todo = &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;test item&#x27;</span>,</span><br><span class="line">    <span class="attr">isCompleted</span>: <span class="literal">false</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> removeTodo = cy.<span class="title function_">stub</span>().<span class="title function_">as</span>(<span class="string">&#x27;remove&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">mount</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Todo</span> <span class="attr">todo</span>=<span class="string">&#123;todo&#125;</span> <span class="attr">index</span>=<span class="string">&#123;123&#125;</span> <span class="attr">removeTodo</span>=<span class="string">&#123;removeTodo&#125;</span> /&gt;</span></span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">stylesheets</span>: [</span><br><span class="line">        <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.css&#x27;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  cy.<span class="title function_">contains</span>(<span class="string">&#x27;.todo&#x27;</span>, <span class="string">&#x27;test item&#x27;</span>)</span><br><span class="line">    .<span class="title function_">find</span>(<span class="string">&#x27;[data-cy=&quot;remove&quot;]&#x27;</span>).<span class="title function_">click</span>()</span><br><span class="line">  cy.<span class="title function_">get</span>(<span class="string">&#x27;@remove&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;have.been.calledWith&#x27;</span>, <span class="number">123</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="/blog/images/components/todo3.png" alt="Removing todo"></p>
<h2><span id="graphql-example">GraphQL example</span></h2><p>Notice how we directly passed a stub into the component as a property - because the component &quot;lives&quot; right inside the spec. By having direct access to the component, you can do amazing things - like combine mock and live GraphQL calls, see <a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-apollo">bahmutov&#x2F;test-apollo</a></p>
<figure class="highlight js"><figcaption><span>test-apollo/src/Library.spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Library</span>, <span class="variable constant_">GET_BOOKS</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;mount&#125; <span class="keyword">from</span> <span class="string">&#x27;cypress-react-unit-test&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MockedProvider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@apollo/react-testing&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// mocking GraphQL requests using</span></span><br><span class="line"><span class="comment">// https://www.apollographql.com/docs/react/development-testing/testing/#mockedprovider</span></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Library&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    cy.<span class="title function_">fixture</span>(<span class="string">&#x27;books&#x27;</span>).<span class="title function_">as</span>(<span class="string">&#x27;books&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;shows loading while making the query&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// delays the response by 3 seconds</span></span><br><span class="line">    <span class="keyword">const</span> mocks = [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">request</span>: &#123;</span><br><span class="line">          <span class="attr">query</span>: <span class="variable constant_">GET_BOOKS</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">result</span>: <span class="variable language_">this</span>.<span class="property">books</span>,</span><br><span class="line">        <span class="attr">delay</span>: <span class="number">3000</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">    <span class="title function_">mount</span>(</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">MockedProvider</span> <span class="attr">mocks</span>=<span class="string">&#123;mocks&#125;</span> <span class="attr">addTypename</span>=<span class="string">&#123;false&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Library</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">MockedProvider</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment">// üòÄ compare declarative testing vs promise waits in</span></span><br><span class="line">    <span class="comment">// https://www.apollographql.com/docs/react/development-testing/testing/#testing-final-state</span></span><br><span class="line">    cy.<span class="title function_">contains</span>(<span class="string">&#x27;Loading ...&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;be.visible&#x27;</span>)</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;[data-cy=book]&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;have.length&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">    cy.<span class="title function_">contains</span>(<span class="string">&#x27;Loading ...&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;not.exist&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="../images/components/graphql-test.gif" alt="Mocking GraphQL with delay component test"></p>
<h2><span id="components-all-the-way-down">Components all the way down</span></h2><p>Component testing can work with components of any size. We have tested <code>TodoForm</code> and <code>Todo</code> components, let&#39;s test the top-level <code>App</code> component.</p>
<figure class="highlight js"><figcaption><span>src/App.spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;mount&#125; <span class="keyword">from</span> <span class="string">&#x27;cypress-react-unit-test&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;App&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">mount</span>(</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">stylesheets</span>: [</span><br><span class="line">          <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.css&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;works&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;.todo&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;have.length&#x27;</span>, <span class="number">3</span>)</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;input.input&#x27;</span>).<span class="title function_">type</span>(<span class="string">&#x27;Test with Cypress&#123;enter&#125;&#x27;</span>)</span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;.todo&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;have.length&#x27;</span>, <span class="number">4</span>)</span><br><span class="line">      .<span class="title function_">contains</span>(<span class="string">&#x27;Meet friend for lunch&#x27;</span>)</span><br><span class="line">      .<span class="title function_">find</span>(<span class="string">&#x27;[data-cy=remove]&#x27;</span>).<span class="title function_">click</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    cy.<span class="title function_">get</span>(<span class="string">&#x27;.todo&#x27;</span>).<span class="title function_">should</span>(<span class="string">&#x27;have.length&#x27;</span>, <span class="number">3</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>The test runs and looks ... almost like the complete application!</p>
<p><img src="/blog/images/components/app-test.gif" alt="App component test"></p>
<p>Component testing gives you a flexibility over the scope of the code you want to test. In addition to testing your application as a whole via end-to-end tests you can test a subset of the application &quot;tree&quot;. If your application has the top level authentication that is hard to bypass from an end-to-end test - you can test the component that sits right under the authentication provider.</p>
<p>Finally, while we are testing components, let&#39;s test a few functions using unit tests. While this was always possible in Cypress, component testing mounting mode makes it much closer to testing the real code, because bundling the component spec is done using your application&#39;s settings.</p>
<figure class="highlight js"><figcaption><span>src/App.spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">App</span>, &#123;toggleOneTodo&#125; <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;App&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;toggles correctly&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> todos = [&#123;</span><br><span class="line">      <span class="attr">isCompleted</span>: <span class="literal">false</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">isCompleted</span>: <span class="literal">false</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">isCompleted</span>: <span class="literal">false</span></span><br><span class="line">    &#125;]</span><br><span class="line">    <span class="keyword">const</span> newTodos = <span class="title function_">toggleOneTodo</span>(todos, <span class="number">2</span>)</span><br><span class="line">    <span class="title function_">expect</span>(newTodos).<span class="property">to</span>.<span class="property">deep</span>.<span class="title function_">equal</span>([&#123;</span><br><span class="line">        <span class="attr">isCompleted</span>: <span class="literal">false</span></span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        <span class="attr">isCompleted</span>: <span class="literal">false</span></span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        <span class="attr">isCompleted</span>: <span class="literal">true</span></span><br><span class="line">      &#125;])</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>From the smallest units of code to the largest components - you control the scale of <em>what</em> you want to test.</p>
<h2><span id="benefits">Benefits</span></h2><p>In my completely biased personal opinion, Cypress component testing using the real browser has many advantages</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Cypress + <code>cypress-X-unit-test</code></th>
</tr>
</thead>
<tbody><tr>
<td>Test runs in real browser</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Cross-platform</td>
<td>Chrome &#x2F; Firefox &#x2F; Microsoft Edge</td>
</tr>
<tr>
<td>Uses full mount</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Test speed</td>
<td>as fast as the app works in the browser</td>
</tr>
<tr>
<td>Test can use additional plugins</td>
<td>use any <a target="_blank" rel="noopener" href="https://on.cypress.io/plugins">Cypress plugin</a></td>
</tr>
<tr>
<td>Test can interact with component</td>
<td>use any <a target="_blank" rel="noopener" href="https://on.cypress.io/api">Cypress command</a></td>
</tr>
<tr>
<td>Debugging</td>
<td>use browser DevTools, Cypress time-traveling debugger</td>
</tr>
<tr>
<td>Re-run tests on file or test change</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Test output on CI</td>
<td>terminal, screenshots, videos</td>
</tr>
<tr>
<td>Tests can be run in parallel</td>
<td>‚úÖ via <a target="_blank" rel="noopener" href="https://on.cypress.io/parallelization">parallelization</a></td>
</tr>
<tr>
<td>Test against interface</td>
<td>‚úÖ and can use <code>@testing-library/cypress</code></td>
</tr>
<tr>
<td>Spying and mocking</td>
<td>Sinon library</td>
</tr>
<tr>
<td>Code coverage</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Visual testing</td>
<td>‚úÖ via <a target="_blank" rel="noopener" href="https://on.cypress.io/visual-testing">visual plugins</a></td>
</tr>
</tbody></table>
<h2><span id="examples">Examples</span></h2><p>We have forked a number of 3rd party projects to confirm component testing works.</p>
<table>
<thead>
<tr>
<th>Repo</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/try-cra-with-unit-test">try-cra-with-unit-test</a></td>
<td>Hello world initialized with CRAv3</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/try-cra-app-typescript">try-cra-app-typescript</a></td>
<td>Hello world initialized with CRAv3 <code>--typescript</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/react-todo-with-hooks">react-todo-with-hooks</a></td>
<td>Modern web application using hooks</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-redux-examples">test-redux-examples</a></td>
<td>Example apps copies from official Redux repo and tested as components</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-react-hooks-animations">test-react-hooks-animations</a></td>
<td>Testing React springs fun blob animation</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-mdx-example">test-mdx-example</a></td>
<td>Example testing MDX components using Cypress</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-apollo">test-apollo</a></td>
<td>Component testing an application that uses Apollo GraphQL library</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-xstate-react">test-xstate-react</a></td>
<td>XState component testing using Cypress</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-react-router-v5">test-react-router-v5</a></td>
<td>A few tests of React Router v5</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-material-ui">test-material-ui</a></td>
<td>Testing Material UI components: date pickers, lists, autocomplete</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-d3-react-gauge">test-d3-react-gauge</a></td>
<td>Testing React D3 gauges</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/storybook-code-coverage">storybook-code-coverage</a></td>
<td>Example app where we get 100% code coverage easily with a single integration spec and a few component specs, replacing <a target="_blank" rel="noopener" href="https://dev.to/penx/combining-storybook-cypress-and-jest-code-coverage-4pa5">several tools</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/react-loading-skeleton">react-loading-skeleton</a></td>
<td>One to one Storybook tests for React skeleton components. Uses local <code>.babelrc</code> settings without Webpack config</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-swr">test-swr</a></td>
<td>Component test for <a target="_blank" rel="noopener" href="https://github.com/zeit/swr">Zeit SWR</a> hooks for remote data fetching</td>
</tr>
</tbody></table>
<p>To find more examples, see GitHub topic <a target="_blank" rel="noopener" href="https://github.com/topics/cypress-react-unit-test-example">cypress-react-unit-test-example</a></p>
<h2><span id="future-plans">Future plans</span></h2><p>We have already released new versions of <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-react-unit-test">cypress-react-unit-test</a> and <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-vue-unit-test">cypress-vue-unit-test</a> and plan to upgrade other framework adaptors (Angular, Svelte, etc) to be compatible with <code>experimentalComponentTesting: true</code> mode.</p>
<h2><span id="thank-you">Thank you</span></h2><p>Special thank you üëè to <a target="_blank" rel="noopener" href="https://twitter.com/dmtrKovalenko">Dmitriy Kovalenko @dmtrKovalenko</a> for making Cypress Test Runner and React adaptor work through these PRs <a target="_blank" rel="noopener" href="https://github.com/cypress-io/cypress/pull/5923">#5923</a> and <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-react-unit-test/pull/108">#108</a>. They have removed the technical limitations that prevented React Hooks, component styles and other features from working correctly inside the component tests.</p>
<p>Another big shout out goes to <a target="_blank" rel="noopener" href="https://twitter.com/_JessicaSachs">Jessica Sachs @_JessicaSachs</a> for working on component testing support in <a target="_blank" rel="noopener" href="https://github.com/bahmutov/cypress-vue-unit-test">cypress-vue-unit-test</a> üëè.</p>

      
    </div>

    
      <footer class="article-footer personal-links">
  <p>
    Follow Gleb Bahmutov <a target="_blank" rel="noopener" href="https://twitter.com/bahmutov">@bahmutov</a>,
    see his projects at <a href="https://glebbahmutov.com">glebbahmutov.com</a>,
    watch his Cypress <a target="_blank" rel="noopener" href="https://www.youtube.com/c/glebbahmutov/videos">videos</a>,
    browse his <a target="_blank" rel="noopener" href="https://slides.com/bahmutov">presentations</a>
  </p>
  <p>
    Want to know more about Cypress? Check out <a href="https://cypress.tips" target="_blank">cypress.tips</a>
  </p>
  <p>
    Have a Cypress question? Want me to answer it? Consider supporting me via <a target="_blank" rel="noopener" href="https://github.com/sponsors/bahmutov">GitHub Sponsors</a> or by purchasing my <a target="_blank" rel="noopener" href="https://cypress.tips/courses">Cypress courses</a>.
  </p>
</footer>
<script src="https://rawgit.com/toddmotto/linkjuice/702066a37124081e7ad1a972844a9a91115be05a/dist/linkjuice.js"></script>
<script>
function contentFn (node, icon) {
  const s = '<a href="#' + node.id + '" class="linkjuice">' +
    node.innerHTML + ' ' + icon + '</a>\n'
  return s
}
linkjuice.init('.article-entry', {
  selectors: ['h2 span'],
  icon: '<span class="link-symbol">#</span>',
  contentFn: contentFn
});
</script>

    

    <footer class="article-footer">
      <a data-url="https://glebbahmutov.com/blog/my-vision-for-component-tests/" data-id="cl516luit00a29zvg71sp9to3" class="article-share-link">Share</a>
      
        <a href="https://glebbahmutov.com/blog/my-vision-for-component-tests/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/cypress/" rel="tag">cypress</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../mocking-named-typescript-imports/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Mocking named TypeScript imports during tests
        
      </div>
    </a>
  
  
    <a href="../cleaning-up-space/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Cleaning Up Space on Development Machine</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    <style>
#carbonads {
  display: block;
  overflow: hidden;
  font-size: 11px;
  font-family: Verdana, "Helvetica Neue", Helvetica, sans-serif;
  line-height: 1.5;
}

#carbonads a {
  color: #258fb8;
  text-decoration: none;
}

#carbonads a:hover {
  text-decoration: underline;
}

#carbonads span {
  position: relative;
  display: block;
  overflow: hidden;
}

.carbon-img {
  float: left;
  margin-right: 1em;
}

.carbon-img img { display: block; }

.carbon-text {
  display: block;
  float: left;
  text-align: left;
  margin-top: 0.5em;
}
@media screen and (min-width: 1024px) {
  .carbon-text {
    max-width: calc(100% - 130px - 1em);
  }
}

.carbon-poweredby {
  /*position: absolute;
  right: 0;
  bottom: 0;*/
  float: right;
  display: block;
  font-size: 11px;
}
</style>
<div class="widget-wrap">
  <div class="widget-title">&nbsp;</div>
  <div class="widget">
    <!-- Carbon Ads -->
    <script async type="text/javascript"
      src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=glebbahmutovcom"
      id="_carbonads_js"></script>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../categories/book-review/">book review</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/climate/">climate</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/people/">people</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/process/">process</a><span class="category-list-count">148</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/products/">products</a><span class="category-list-count">481</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="../tags/11ty/" rel="tag">11ty</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/QUnit/" rel="tag">QUnit</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/a11y/" rel="tag">a11y</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/advice/" rel="tag">advice</a><span class="tag-list-count">113</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/algolia/" rel="tag">algolia</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs/" rel="tag">angularjs</a><span class="tag-list-count">58</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs2/" rel="tag">angularjs2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/assertions/" rel="tag">assertions</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ast/" rel="tag">ast</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/boilerplate/" rel="tag">boilerplate</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/browser/" rel="tag">browser</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ci/" rel="tag">ci</a><span class="tag-list-count">30</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/circle/" rel="tag">circle</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/climate/" rel="tag">climate</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/code-coverage/" rel="tag">code coverage</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/concurrency/" rel="tag">concurrency</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cyclejs/" rel="tag">cyclejs</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cypress/" rel="tag">cypress</a><span class="tag-list-count">215</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cypress-dashboard/" rel="tag">cypress dashboard</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/d3/" rel="tag">d3</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/db/" rel="tag">db</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/docker/" rel="tag">docker</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/documentation/" rel="tag">documentation</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es6/" rel="tag">es6</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es7/" rel="tag">es7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/functional/" rel="tag">functional</a><span class="tag-list-count">70</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/generators/" rel="tag">generators</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/git/" rel="tag">git</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/github/" rel="tag">github</a><span class="tag-list-count">24</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/graphql/" rel="tag">graphql</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/grunt/" rel="tag">grunt</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/gulp/" rel="tag">gulp</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/hiring/" rel="tag">hiring</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/hyperapp/" rel="tag">hyperapp</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/immutable/" rel="tag">immutable</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/interview/" rel="tag">interview</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jade/" rel="tag">jade</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/javascript/" rel="tag">javascript</a><span class="tag-list-count">166</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jshint/" rel="tag">jshint</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/markdown/" rel="tag">markdown</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/model-based-testing/" rel="tag">model-based testing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/modular-development/" rel="tag">modular development</a><span class="tag-list-count">28</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/netlify/" rel="tag">netlify</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">84</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/performance/" rel="tag">performance</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/presentation/" rel="tag">presentation</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/promises/" rel="tag">promises</a><span class="tag-list-count">31</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/proposal/" rel="tag">proposal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ramda/" rel="tag">ramda</a><span class="tag-list-count">28</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/react/" rel="tag">react</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/react-native/" rel="tag">react native</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactive/" rel="tag">reactive</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactjs/" rel="tag">reactjs</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/renovate/" rel="tag">renovate</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/screencast/" rel="tag">screencast</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/security/" rel="tag">security</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/sentry/" rel="tag">sentry</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/service-workers/" rel="tag">service workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/state-machine/" rel="tag">state machine</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/testing/" rel="tag">testing</a><span class="tag-list-count">142</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/tutorial/" rel="tag">tutorial</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/typescript/" rel="tag">typescript</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ui/" rel="tag">ui</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/vercel/" rel="tag">vercel</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/visual-testing/" rel="tag">visual testing</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/vuejs/" rel="tag">vuejs</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/web-workers/" rel="tag">web workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/webpack/" rel="tag">webpack</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../tags/11ty/" style="font-size: 10.38px;">11ty</a> <a href="../tags/QUnit/" style="font-size: 11.54px;">QUnit</a> <a href="../tags/a11y/" style="font-size: 10.77px;">a11y</a> <a href="../tags/advice/" style="font-size: 18.85px;">advice</a> <a href="../tags/algolia/" style="font-size: 10.77px;">algolia</a> <a href="../tags/angularjs/" style="font-size: 17.69px;">angularjs</a> <a href="../tags/angularjs2/" style="font-size: 10px;">angularjs2</a> <a href="../tags/assertions/" style="font-size: 13.08px;">assertions</a> <a href="../tags/ast/" style="font-size: 12.69px;">ast</a> <a href="../tags/boilerplate/" style="font-size: 15px;">boilerplate</a> <a href="../tags/browser/" style="font-size: 15.38px;">browser</a> <a href="../tags/ci/" style="font-size: 16.92px;">ci</a> <a href="../tags/circle/" style="font-size: 13.85px;">circle</a> <a href="../tags/climate/" style="font-size: 14.62px;">climate</a> <a href="../tags/code-coverage/" style="font-size: 15px;">code coverage</a> <a href="../tags/concurrency/" style="font-size: 10px;">concurrency</a> <a href="../tags/cyclejs/" style="font-size: 12.31px;">cyclejs</a> <a href="../tags/cypress/" style="font-size: 20px;">cypress</a> <a href="../tags/cypress-dashboard/" style="font-size: 14.23px;">cypress dashboard</a> <a href="../tags/d3/" style="font-size: 10.77px;">d3</a> <a href="../tags/db/" style="font-size: 14.62px;">db</a> <a href="../tags/docker/" style="font-size: 14.23px;">docker</a> <a href="../tags/documentation/" style="font-size: 11.92px;">documentation</a> <a href="../tags/es6/" style="font-size: 14.62px;">es6</a> <a href="../tags/es7/" style="font-size: 10px;">es7</a> <a href="../tags/functional/" style="font-size: 18.08px;">functional</a> <a href="../tags/generators/" style="font-size: 11.54px;">generators</a> <a href="../tags/git/" style="font-size: 15px;">git</a> <a href="../tags/github/" style="font-size: 16.15px;">github</a> <a href="../tags/graphql/" style="font-size: 11.54px;">graphql</a> <a href="../tags/grunt/" style="font-size: 12.31px;">grunt</a> <a href="../tags/gulp/" style="font-size: 10.77px;">gulp</a> <a href="../tags/hiring/" style="font-size: 11.15px;">hiring</a> <a href="../tags/hyperapp/" style="font-size: 12.31px;">hyperapp</a> <a href="../tags/immutable/" style="font-size: 11.54px;">immutable</a> <a href="../tags/interview/" style="font-size: 10.77px;">interview</a> <a href="../tags/jade/" style="font-size: 11.15px;">jade</a> <a href="../tags/javascript/" style="font-size: 19.62px;">javascript</a> <a href="../tags/jshint/" style="font-size: 10.77px;">jshint</a> <a href="../tags/markdown/" style="font-size: 13.85px;">markdown</a> <a href="../tags/model-based-testing/" style="font-size: 10px;">model-based testing</a> <a href="../tags/modular-development/" style="font-size: 16.54px;">modular development</a> <a href="../tags/netlify/" style="font-size: 11.15px;">netlify</a> <a href="../tags/nodejs/" style="font-size: 18.46px;">nodejs</a> <a href="../tags/performance/" style="font-size: 15.77px;">performance</a> <a href="../tags/presentation/" style="font-size: 12.31px;">presentation</a> <a href="../tags/promises/" style="font-size: 17.31px;">promises</a> <a href="../tags/proposal/" style="font-size: 10.38px;">proposal</a> <a href="../tags/ramda/" style="font-size: 16.54px;">ramda</a> <a href="../tags/react/" style="font-size: 12.31px;">react</a> <a href="../tags/react-native/" style="font-size: 11.15px;">react native</a> <a href="../tags/reactive/" style="font-size: 14.23px;">reactive</a> <a href="../tags/reactjs/" style="font-size: 11.15px;">reactjs</a> <a href="../tags/renovate/" style="font-size: 11.54px;">renovate</a> <a href="../tags/screencast/" style="font-size: 10px;">screencast</a> <a href="../tags/security/" style="font-size: 13.08px;">security</a> <a href="../tags/sentry/" style="font-size: 13.85px;">sentry</a> <a href="../tags/service-workers/" style="font-size: 11.92px;">service workers</a> <a href="../tags/state-machine/" style="font-size: 10px;">state machine</a> <a href="../tags/testing/" style="font-size: 19.23px;">testing</a> <a href="../tags/tutorial/" style="font-size: 15.38px;">tutorial</a> <a href="../tags/typescript/" style="font-size: 12.31px;">typescript</a> <a href="../tags/ui/" style="font-size: 10.38px;">ui</a> <a href="../tags/vercel/" style="font-size: 13.46px;">vercel</a> <a href="../tags/visual-testing/" style="font-size: 11.15px;">visual testing</a> <a href="../tags/vuejs/" style="font-size: 11.54px;">vuejs</a> <a href="../tags/web-workers/" style="font-size: 11.92px;">web workers</a> <a href="../tags/webpack/" style="font-size: 10.77px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/07/">July 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/06/">June 2022</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/05/">May 2022</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/04/">April 2022</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/03/">March 2022</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/02/">February 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/01/">January 2022</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/12/">December 2021</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/11/">November 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/10/">October 2021</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/09/">September 2021</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/08/">August 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/07/">July 2021</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/06/">June 2021</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/05/">May 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/04/">April 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/03/">March 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/02/">February 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/01/">January 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/12/">December 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/11/">November 2020</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/10/">October 2020</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/09/">September 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/08/">August 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/07/">July 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/06/">June 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/05/">May 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/04/">April 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/03/">March 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/02/">February 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/01/">January 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/12/">December 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/11/">November 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/10/">October 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/09/">September 2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/08/">August 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/07/">July 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/06/">June 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/05/">May 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/04/">April 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/03/">March 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/02/">February 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/01/">January 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/12/">December 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/11/">November 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/10/">October 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/09/">September 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/08/">August 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/06/">June 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/04/">April 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/03/">March 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/01/">January 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/12/">December 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/11/">November 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/09/">September 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/08/">August 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/07/">July 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/06/">June 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/05/">May 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/04/">April 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/03/">March 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/02/">February 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/01/">January 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/12/">December 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/10/">October 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/08/">August 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/07/">July 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/06/">June 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/05/">May 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/04/">April 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/03/">March 2016</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/02/">February 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/01/">January 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/12/">December 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/11/">November 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/08/">August 2015</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/07/">July 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/06/">June 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/05/">May 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/04/">April 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/03/">March 2015</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/02/">February 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/01/">January 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/12/">December 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/11/">November 2014</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/10/">October 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/09/">September 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/08/">August 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/07/">July 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/06/">June 2014</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/05/">May 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/04/">April 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/03/">March 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/02/">February 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/01/">January 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/12/">December 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/11/">November 2013</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/10/">October 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/09/">September 2013</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../stub-form-that-opens-2nd-tab/">Stub The Form That Opens The Second Browser Tab</a>
          </li>
        
          <li>
            <a href="../sinon-edge/">Sinon Edge Cases</a>
          </li>
        
          <li>
            <a href="../cypress-v10-env/">Cypress v10 Environment Variables</a>
          </li>
        
          <li>
            <a href="../cypress-v10-tips/">Cypress v10 Tips and Tricks</a>
          </li>
        
          <li>
            <a href="../test-app/">Test App From Another Repo</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Gleb Bahmutov<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
</nav>
    
<script>
  var disqus_shortname = 'betterworldbybettersoftware';
  
  var disqus_url = 'https://glebbahmutov.com/blog/my-vision-for-component-tests/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="../fancybox/jquery.fancybox.css">

  
<script src="../fancybox/jquery.fancybox.pack.js"></script>




<script src="../js/script.js"></script>


  </div>
  <script src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script>
<script>
(function centerMainOnAsideScroll () {
  // when aside side bar scrolls outside the view
  // it centers the main content.
  const main = document.querySelector('#main')
  const aside = document.querySelector('aside#sidebar')
  console.assert(main, 'could not get #main')
  console.assert(aside, 'could not get aside')
  // initially the aside sidebar is visible
  let asideVisible = true

  function centerMain () {
    console.log('adding class center-main')
    main.classList.add('center-main')
  }
  function leftMain () {
    main.classList.remove('center-main')
  }

  function callWhenAsideScrollsUp (becameInvisible, becameVisible) {
    return function () {
      const border = 50
      const rect = aside.getBoundingClientRect()
      if (asideVisible && rect.bottom < -border) {
        asideVisible = false
        becameInvisible()
      }

      if (!asideVisible && window.scrollY < border) {
        asideVisible = true
        becameVisible()
      }
    }
  }
  const throttleWaitMs = 250
  const onScroll = _.throttle(
    callWhenAsideScrollsUp(centerMain, leftMain),
    throttleWaitMs
  )
  window.addEventListener('scroll', onScroll)
}())
</script>

</body>
</html>
