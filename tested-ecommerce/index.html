<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Deploy E-Commerce Site to Netlify and Test Using GitHub Actions | Better world by better software</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="This blog post shows how to deploy a Netlify e-commerce site. The site uses Netlify functions and Stripe payment system. To ensure the site works, we will run a full end-to-end Cypress test after each">
<meta property="og:type" content="article">
<meta property="og:title" content="Deploy E-Commerce Site to Netlify and Test Using GitHub Actions">
<meta property="og:url" content="https://glebbahmutov.com/blog/tested-ecommerce/index.html">
<meta property="og:site_name" content="Better world by better software">
<meta property="og:description" content="This blog post shows how to deploy a Netlify e-commerce site. The site uses Netlify functions and Stripe payment system. To ensure the site works, we will run a full end-to-end Cypress test after each">
<meta property="og:locale">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/site.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/purchase-test.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/set-token.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/run.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/set-up-recording.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/add-secret.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/run-url.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/dashboard.gif">
<meta property="og:image" content="https://img.shields.io/endpoint?url=https://dashboard.cypress.io/badge/simple/nz8crj/main&amp;style=flat&amp;logo=cypress">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/checks.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/github-app.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/github-app-set.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/failed-test-run.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/failed-pull-request.gif">
<meta property="article:published_time" content="2021-02-19T05:00:00.000Z">
<meta property="article:modified_time" content="2021-06-15T13:13:30.364Z">
<meta property="article:author" content="Gleb Bahmutov">
<meta property="article:tag" content="cypress">
<meta property="article:tag" content="cypress dashboard">
<meta property="article:tag" content="ci">
<meta property="article:tag" content="netlify">
<meta property="article:tag" content="github">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://glebbahmutov.com/blog/images/tested-ecommerce/site.png">
<meta name="twitter:creator" content="@bahmutov">
  
    <link rel="alternative" href="/blog/atom.xml" title="Better world by better software" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="preload" href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" as="style">
  
<link rel="stylesheet" href="../css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-59999353-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-titles">
      <div id="header-title" class="inner">
        <h1 id="logo-wrap">
          <a href="../index.html" id="logo">Better world by better software</a>
        </h1>
        <!--
        
        -->
        <!-- <span class="no-mobile">Software advice from</span> -->
        <h2 id="subtitle-wrap">
          <span class="subtitle">
            <a id="subtitle" href="https://glebbahmutov.com">Gleb Bahmutov PhD</a>
            <a id="nav-house-link" class="nav-icon" href="/" title="Home"></a>
            
              <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
            
            <a id="nav-search-btn" class="nav-icon" title="Search"></a>
            <div id="search-form-wrap">
              <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://glebbahmutov.com/blog"></form>
            </div>
          </span>
        </h2>

      </div>
    </div>
    <div id="climate-crisis">
      <h2>Our planet üåè is in danger</h2>
      <h3>Act today: <a href="/blog/climate-emergency/">what you can do</a></h3>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-tested-ecommerce" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2021-02-19T05:00:00.000Z" itemprop="datePublished">Feb 19 2021</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../categories/products/">products</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Deploy E-Commerce Site to Netlify and Test Using GitHub Actions
    </h1>

    <h2 class="article-title" itemprop="name">
      How to test a site deployed to Netlify by starting a GitHub Actions workflow.
    </h2>

  


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>This blog post shows how to deploy a Netlify e-commerce site. The site uses Netlify functions and Stripe payment system. To ensure the site works, we will run a full end-to-end Cypress test after each deploy by triggering a GitHub workflow.</p>
<!-- toc -->
<ul>
<li><a href="#repo">Repo</a></li>
<li><a href="#end-to-end-test">End-to-end test</a></li>
<li><a href="#deploying-to-netlify">Deploying to Netlify</a><ul>
<li><a href="#the-dispatch-plugin">The dispatch plugin</a></li>
<li><a href="#the-workflow">The workflow</a></li>
</ul>
</li>
<li><a href="#record-to-cypress-dashboard">Record to Cypress Dashboard</a><ul>
<li><a href="#status-check">Status check</a></li>
<li><a href="#parallel-tests">Parallel tests</a></li>
</ul>
</li>
<li><a href="#see-also">See also</a></li>
</ul>
<!-- tocstop -->
<p><img src="/blog/images/tested-ecommerce/site.png" alt="The deployed and tested e-commerce site"></p>
<h2><span id="repo">Repo</span></h2><p>I have cloned a simple e-commerce site <a target="_blank" rel="noopener" href="https://github.com/sdras/ecommerce-netlify">sdras/ecommerce-netlify</a> to <a target="_blank" rel="noopener" href="https://github.com/bahmutov/ecommerce-netlify">bahmutov/ecommerce-netlify</a> and set up deploying to Netlify. You can find the site at <a target="_blank" rel="noopener" href="https://tested-ecommerce-store.netlify.app/">tested-ecommerce-store.netlify.app</a> and its deploy logs at <a target="_blank" rel="noopener" href="https://app.netlify.com/sites/tested-ecommerce-store/deploys">Netlify</a>. In this blog post I will show how to write a simple end-to-end test for the site. The test should run after each preview and production deploy to make sure the site&#39;s customer can actually buy items from the online store.</p>
<p>Or at least pretend they do - the site does no-op after the Stripe payment.</p>
<p>The interesting part is triggering the CI build after Netlify deploys the site. Instead of <a href="/blog/test-netlify/" title="testing on Netlify">testing on Netlify</a> via <a target="_blank" rel="noopener" href="https://github.com/cypress-io/netlify-plugin-cypress">netlify-plugin-cypress</a> build plugin, we are going to trigger our GitHub Actions workflow by using the <a target="_blank" rel="noopener" href="https://github.com/bahmutov/netlify-plugin-github-dispatch">netlify-plugin-github-dispatch</a>. Running the tests on GitHub Actions allows us to run multiple test jobs in parallel, use Chrome or Firefox browser, and run tests on every major operating system. The Netlify Build is still limited to a single container and, compared to GitHub Actions, is more expensive.</p>
<h2><span id="end-to-end-test">End-to-end test</span></h2><p>I will install <a target="_blank" rel="noopener" href="https://github.com/cypress-io/cypress">Cypress</a> and write a few basic tests. The most important test goes through the entire workflow: selects a few items, goes to the cart page, enters the credit card number, and ends up on the &quot;thank you for your order&quot; page. In this blog post I am using Cypress v6.5.0.</p>
<figure class="highlight js"><figcaption><span>cypress/integration/spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;reference types=&quot;cypress&quot; /&gt;</span></span><br><span class="line">describe(<span class="string">&#x27;e-commerce site&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  it(<span class="string">&#x27;sells two items&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    cy.visit(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    cy.contains(<span class="string">&#x27;nav li&#x27;</span>, <span class="string">&#x27;Men&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">    cy.log(<span class="string">&#x27;**men\&#x27; items**&#x27;</span>)</span><br><span class="line">    cy.location(<span class="string">&#x27;pathname&#x27;</span>).should(<span class="string">&#x27;equal&#x27;</span>, <span class="string">&#x27;/men&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// let&#x27;s not go crazy here, $30 is plenty!</span></span><br><span class="line">    <span class="comment">// we change the max value by setting the value</span></span><br><span class="line">    <span class="comment">// of the slider and then triggering the &quot;input&quot; event</span></span><br><span class="line">    cy.get(<span class="string">&#x27;#pricerange&#x27;</span>).invoke(<span class="string">&#x27;val&#x27;</span>, <span class="number">30</span>).trigger(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check the number of items &lt; $30</span></span><br><span class="line">    cy.get(<span class="string">&#x27;.content .item&#x27;</span>).should(<span class="string">&#x27;have.length&#x27;</span>, <span class="number">3</span>)</span><br><span class="line">      .first()</span><br><span class="line">      .click()</span><br><span class="line"></span><br><span class="line">    cy.log(<span class="string">&#x27;**item page**&#x27;</span>)</span><br><span class="line">    cy.location(<span class="string">&#x27;pathname&#x27;</span>).should(<span class="string">&#x27;match&#x27;</span>, <span class="regexp">/\/product\//</span>)</span><br><span class="line">    cy.contains(<span class="string">&#x27;.product-info h1&#x27;</span>, <span class="string">&#x27;Armin Basilio&#x27;</span>)</span><br><span class="line">    cy.get(<span class="string">&#x27;.size-picker&#x27;</span>).select(<span class="string">&#x27;Large&#x27;</span>)</span><br><span class="line">    <span class="comment">// this jacket is so lovely, let&#x27;s order 2</span></span><br><span class="line">    cy.contains(<span class="string">&#x27;.update-num&#x27;</span>, <span class="string">&#x27;+&#x27;</span>).click()</span><br><span class="line">    cy.get(<span class="string">&#x27;.quantity input[type=number]&#x27;</span>).should(<span class="string">&#x27;have.value&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">    cy.contains(<span class="string">&#x27;.purchase&#x27;</span>, <span class="string">&#x27;Add to Cart&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">    cy.contains(<span class="string">&#x27;nav .carttotal&#x27;</span>, <span class="number">2</span>) <span class="comment">// the little badge is present</span></span><br><span class="line">    <span class="comment">// spy on the Netlify function call</span></span><br><span class="line">    cy.intercept(&#123;</span><br><span class="line">      method: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">      pathname: <span class="string">&#x27;/.netlify/functions/create-payment-intent&#x27;</span></span><br><span class="line">    &#125;).as(<span class="string">&#x27;paymentIntent&#x27;</span>)</span><br><span class="line">    cy.contains(<span class="string">&#x27;nav li&#x27;</span>, <span class="string">&#x27;Cart&#x27;</span>).click()</span><br><span class="line">    cy.log(<span class="string">&#x27;**cart page**&#x27;</span>)</span><br><span class="line">    cy.wait(<span class="string">&#x27;@paymentIntent&#x27;</span>)</span><br><span class="line">      .its(<span class="string">&#x27;response.body&#x27;</span>)</span><br><span class="line">      .then(<span class="built_in">JSON</span>.parse)</span><br><span class="line">      .should(<span class="string">&#x27;have.property&#x27;</span>, <span class="string">&#x27;clientSecret&#x27;</span>)</span><br><span class="line">    <span class="comment">// always confirm the total before paying</span></span><br><span class="line">    cy.contains(<span class="string">&#x27;.total .golden&#x27;</span>, <span class="string">&#x27;$41.98&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    cy.log(<span class="string">&#x27;**fill payment**&#x27;</span>)</span><br><span class="line">    cy.get(<span class="string">&#x27;input#email&#x27;</span>).type(<span class="string">&#x27;test@test.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// working with cross-origin Stripe iframe</span></span><br><span class="line">    <span class="comment">// https://www.cypress.io/blog/2020/02/12/working-with-iframes-in-cypress/</span></span><br><span class="line">    <span class="keyword">const</span> ccNumber = <span class="string">&#x27;4242424242424242&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> month = <span class="string">&#x27;12&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> year = <span class="string">&#x27;30&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> cvc = <span class="string">&#x27;123&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> zipCode = <span class="string">&#x27;90210&#x27;</span></span><br><span class="line">    getIframeBody(<span class="string">&#x27;.stripe-card iframe&#x27;</span>)</span><br><span class="line">      .find(<span class="string">&#x27;input[name=cardnumber]&#x27;</span>).type(<span class="string">`<span class="subst">$&#123;ccNumber&#125;</span><span class="subst">$&#123;month&#125;</span><span class="subst">$&#123;year&#125;</span><span class="subst">$&#123;cvc&#125;</span><span class="subst">$&#123;zipCode&#125;</span>`</span>)</span><br><span class="line">    cy.contains(<span class="string">&#x27;.pay-with-stripe&#x27;</span>, <span class="string">&#x27;Pay with credit card&#x27;</span>).click()</span><br><span class="line">    <span class="comment">// if the payment went through</span></span><br><span class="line">    cy.contains(<span class="string">&#x27;.success&#x27;</span>, <span class="string">&#x27;Success!&#x27;</span>).should(<span class="string">&#x27;be.visible&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// automatically resets to empty cart</span></span><br><span class="line">    cy.scrollTo(<span class="string">&#x27;top&#x27;</span>)</span><br><span class="line">    cy.get(<span class="string">&#x27;nav .carttotal&#x27;</span>, &#123;<span class="attr">timeout</span>: <span class="number">6000</span>&#125;).should(<span class="string">&#x27;not.exist&#x27;</span>) <span class="comment">// the little badge is gone</span></span><br><span class="line">    cy.contains(<span class="string">&#x27;Your cart is empty, fill it up!&#x27;</span>).should(<span class="string">&#x27;be.visible&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Little utility to find an iframe</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@see </span>https://www.cypress.io/blog/2020/02/12/working-with-iframes-in-cypress/</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> getIframeBody = <span class="function">(<span class="params">iframeSelector</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// get the iframe &gt; document &gt; body</span></span><br><span class="line">    <span class="comment">// and retry until the body element is not empty</span></span><br><span class="line">    <span class="keyword">return</span> cy</span><br><span class="line">    .get(iframeSelector)</span><br><span class="line">    .its(<span class="string">&#x27;0.contentDocument.body&#x27;</span>).should(<span class="string">&#x27;not.be.empty&#x27;</span>)</span><br><span class="line">    <span class="comment">// wraps &quot;body&quot; DOM element to allow</span></span><br><span class="line">    <span class="comment">// chaining more Cypress commands, like &quot;.find(...)&quot;</span></span><br><span class="line">    <span class="comment">// https://on.cypress.io/wrap</span></span><br><span class="line">    .then(cy.wrap)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>The test runs for 10 seconds - most of it waiting for the cart to reset to empty after the successful purchase.</p>
<p><img src="/blog/images/tested-ecommerce/purchase-test.gif" alt="The purchase user journey"></p>
<p>Let&#39;s run this test on CI.</p>
<p><strong>Tip:</strong> I am skipping writing more tests in favor of showing the entire testing setup in this blog post. But one thing I would add is going through the same test with <a target="_blank" rel="noopener" href="https://on.cypress.io/viewport">mobile viewport</a> to make sure the site works for users using smaller screens. See <a target="_blank" rel="noopener" href="https://www.cypress.io/blog/2019/12/06/use-meaningful-smoke-tests/">Use meaningful smoke tests</a> for example. I would also immediately add a few <a target="_blank" rel="noopener" href="https://on.cypress.io/visual-testing">visual tests</a>. A full page screenshot at each major step along the customer journey would ensure we do not accidentally deploy a site with layout or styles problems.</p>
<h2><span id="deploying-to-netlify">Deploying to Netlify</span></h2><p>We will build the static site and deploy using Netlify Build process. Since we are NOT going to run Cypress on Netlify, there is no point in installing it. We can set <a target="_blank" rel="noopener" href="https://on.cypress.io/installing#Skipping-installation">skip installing</a> by setting the <code>CYPRESS_INSTALL_BINARY=0</code> environment variable under the &quot;Deploy Settings&quot; on Netlify or in our <code>netlify.toml</code> file.</p>
<h3><span id="the-dispatch-plugin">The dispatch plugin</span></h3><p>At the end of the deploy we will trigger a GitHub Actions workflow in this repository, allowing the Workflow to install Cypress and run E2E tests against the deployed URL. To trigger the GitHub workflow we need to use the Netlify Build plugin <a target="_blank" rel="noopener" href="https://github.com/bahmutov/netlify-plugin-github-dispatch">netlify-plugin-github-dispatch</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> yarn add -D netlify-plugin-github-dispatch</span></span><br><span class="line">info Direct dependencies</span><br><span class="line">‚îî‚îÄ netlify-plugin-github-dispatch@1.0.3</span><br></pre></td></tr></table></figure>
<p>We need to <a target="_blank" rel="noopener" href="https://github.com/settings/tokens/new">create a GitHub token</a> with &quot;repo&quot; permissions so that the plugin can create the new workflow run. Keep this token secret and set it as environment variable <code>GITHUB_TOKEN</code> under Netlify build settings &quot;Environment&quot;</p>
<p><img src="/blog/images/tested-ecommerce/set-token.png" alt="Set the GITHUB_TOKEN in Netlify Build environment"></p>
<p>And then add the plugin to the <code>netlify.toml</code> file. Here is our project&#39;s <a target="_blank" rel="noopener" href="https://github.com/bahmutov/ecommerce-netlify/blob/main/netlify.toml">netlify.toml</a> file.</p>
<figure class="highlight toml"><figcaption><span>netlify.toml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build]</span></span><br><span class="line">  <span class="attr">command</span> = <span class="string">&quot;yarn generate&quot;</span></span><br><span class="line">  <span class="attr">functions</span> = <span class="string">&quot;functions&quot;</span></span><br><span class="line">  <span class="attr">publish</span> = <span class="string">&quot;dist&quot;</span></span><br><span class="line"><span class="section">[build.environment]</span></span><br><span class="line">  <span class="comment"># skip installing Cypress during the build step</span></span><br><span class="line">  <span class="comment"># because we will run Cypress tests in the GitHub workflow</span></span><br><span class="line">  <span class="attr">CYPRESS_INSTALL_BINARY</span> = <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[[plugins]]</span></span><br><span class="line">  <span class="attr">package</span> = <span class="string">&quot;netlify-plugin-github-dispatch&quot;</span></span><br><span class="line">  <span class="section">[plugins.inputs]</span></span><br><span class="line">    <span class="attr">owner</span> = <span class="string">&quot;bahmutov&quot;</span></span><br><span class="line">    <span class="attr">repo</span> = <span class="string">&quot;ecommerce-netlify&quot;</span></span><br><span class="line">    <span class="attr">workflow</span> = <span class="string">&quot;.github/workflows/e2e.yml&quot;</span></span><br></pre></td></tr></table></figure>
<p>We have provided the <code>inputs</code> object with configuration. We basically just pointed back at the repository. But here it a pro tip: we could have triggered a GitHub Actions workflow in any repository at the end of the Netlify deploy, as long as we have the right permissions! Thus our end-to-end tests could reside in a separate repository from our web application. I personally prefer to keep the tests and the app in the same repository; it helps keep them in sync.</p>
<h3><span id="the-workflow">The workflow</span></h3><p>We need a workflow to trigger at the end of the Netlify deploy. GitHub workflows can be triggered by different events, <code>push</code> and <code>pull_request</code> being the most common. We will use <code>workflow_dispatch</code>, which is a special event that can easily be triggered by the outside services or <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=4TeSOj2Iy_Q">even manually</a>.</p>
<p>We should create the workflow using the same relative path as entered in the dispatch inputs, in our case it will be file <code>.github/workflows/e2e.yml</code>.</p>
<p>Notice how we set up the <code>workflow_dispatch</code> inputs - we need to receive the <code>deployPrimeUrl</code> parameter - that&#39;s the Netlify URL our plugin will send. A good tip is to print it later to make it obvious in the CI logs using <code>echo &quot;Testing url $&#123;&#123; github.event.inputs.deployPrimeUrl &#125;&#125;&quot;</code> command.</p>
<figure class="highlight yml"><figcaption><span>.github/workflows/e2e.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># test the deployed Netlify site</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">e2e</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line">    <span class="attr">inputs:</span></span><br><span class="line">      <span class="attr">siteName:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Netlify</span> <span class="string">Site</span> <span class="string">Name</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">deployPrimeUrl:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Deployed</span> <span class="string">URL</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">show-event:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-20.04</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">echo</span> <span class="string">&quot;Current Git info $GITHUB_WORKFLOW $GITHUB_REF $GITHUB_SHA&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">echo</span> <span class="string">&quot;Testing url $<span class="template-variable">&#123;&#123; github.event.inputs.deployPrimeUrl &#125;&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">‚¨áÔ∏è</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># test the deployed site using</span></span><br><span class="line">      <span class="comment"># https://github.com/cypress-io/github-action</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cypress</span> <span class="string">run</span> <span class="string">üèÉ‚Äç‚ôÄÔ∏è</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">cypress-io/github-action@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">config:</span> <span class="string">baseUrl=$&#123;&#123;</span> <span class="string">github.event.inputs.deployPrimeUrl</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>We are using the <a target="_blank" rel="noopener" href="https://github.com/cypress-io/github-action">Cypress GitHub Action</a> to install, cache, and execute Cypress. The only thing we need to configure is the <a target="_blank" rel="noopener" href="https://on.cypress.io/configuration">baseUrl</a> option to point at the deploy URL.</p>
<p><img src="/blog/images/tested-ecommerce/run.png" alt="GitHub Actions run"></p>
<p>Great! The tests have passed, the preview deploy is working.</p>
<h2><span id="record-to-cypress-dashboard">Record to Cypress Dashboard</span></h2><p>How does our site look during testing? What happens if a test fails? The simplest way to find out is to record the test results to <a target="_blank" rel="noopener" href="https://on.cypress.io/dashboard-introduction">Cypress Dashboard</a>. From Cypress running locally, click the &quot;Runs&quot; tab.</p>
<p><img src="/blog/images/tested-ecommerce/set-up-recording.png" alt="Set up project to record to Cypress Dashboard"></p>
<p>Follow the steps and store the created private recording key under the repository&#39;s secrets.</p>
<p><img src="/blog/images/tested-ecommerce/add-secret.png" alt="GitHub Actions run"></p>
<p><strong>Tip:</strong> I keep it simple and use the same name for the secret as for the environment variable.</p>
<p>Now let&#39;s modify our workflow file to tell Cypress to record the test results to Cypress Dashboard.</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># test the deployed site using</span></span><br><span class="line"><span class="comment"># https://github.com/cypress-io/github-action</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cypress</span> <span class="string">run</span> <span class="string">üèÉ‚Äç‚ôÄÔ∏è</span></span><br><span class="line">  <span class="attr">uses:</span> <span class="string">cypress-io/github-action@v2</span></span><br><span class="line">  <span class="attr">with:</span></span><br><span class="line">    <span class="attr">record:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">config:</span> <span class="string">baseUrl=$&#123;&#123;</span> <span class="string">github.event.inputs.deployPrimeUrl</span> <span class="string">&#125;&#125;</span></span><br><span class="line">  <span class="attr">env:</span></span><br><span class="line">    <span class="attr">CYPRESS_RECORD_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.CYPRESS_RECORD_KEY</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>Let&#39;s open a pull request and we should see the Dashboard run URL in the Cypress output</p>
<p><img src="/blog/images/tested-ecommerce/run-url.png" alt="Recorded run shows the Dashboard run URL"></p>
<p>We can go the Dashboard and see the test results, view the video of the run, etc.</p>
<p><img src="/blog/images/tested-ecommerce/dashboard.gif" alt="Cypress Dashboard plays the video of the Test Runner"></p>
<p>You can see the recorded test results yourself by clicking on this badge</p>
<p><a target="_blank" rel="noopener" href="https://dashboard.cypress.io/projects/nz8crj/runs"><img src="https://img.shields.io/endpoint?url=https://dashboard.cypress.io/badge/simple/nz8crj/main&amp;style=flat&amp;logo=cypress" alt="ecommerce-netlify"></a></p>
<h3><span id="status-check">Status check</span></h3><p>Notice that our pull request does not show the E2E workflow&#39;s status amongst the checks. Only the Netlify checks are present.</p>
<p><img src="/blog/images/tested-ecommerce/checks.png" alt="GitHub pull request shows only Netlify checks"></p>
<p>This is because we do not associate the triggered workflow with the pull request. The best way I know to comment on the pull request with test status is <a href>Cypress GitHub Integration</a> app. And I am not saying this just because I work at Cypress - no, it really makes sense to just flip the switch.</p>
<p>Scroll in the Cypress Dashboard project settings to &quot;GitHub Integration&quot;</p>
<p><img src="/blog/images/tested-ecommerce/github-app.png" alt="GitHub Integration"></p>
<p>Pick the repo from the dropdown list. If the repo is not listed, you need to adjust the Cypress GitHub App&#39;s permissions under your GitHub settings and allow the app to access the repository.</p>
<p>After selecting the &quot;bahmutov/ecommerce-netlify&quot; repository, I flip the switch.</p>
<p><img src="/blog/images/tested-ecommerce/github-app-set.png" alt="Turn on Cypress GH Integration"></p>
<p><strong>Tip:</strong> Cypress Dashboard has <a target="_blank" rel="noopener" href="https://on.cypress.io/gitlab-integration">GitLab</a> and <a target="_blank" rel="noopener" href="https://on.cypress.io/bitbucket-integration">Bitbucket</a> integrations too!</p>
<p>Let&#39;s test the integration. Let&#39;s open a pull request with a <em>failing test</em>. Netlify deploys the site, and GitHub workflow fails. We can see why in the test results on the Dashboard, plus there is the screenshot at the moment of failure, and the video of the tet run.</p>
<p><img src="/blog/images/tested-ecommerce/failed-test-run.gif" alt="Looking at the test output and failed screenshot at Cypress Dashboard"></p>
<p>Now let&#39;s go back to the pull request. Notice the red Cypress status check - this pull request should not be merged! The Cypress integration also comments on the pull request. The comment has the error and even the error screenshot thumbnail.</p>
<p><img src="/blog/images/tested-ecommerce/failed-pull-request.gif" alt="Cypress GitHub Integration adds the test information to the pull request"></p>
<p>By running a battery of end-to-end tests we can ensure that every pull request is works, and we are not merging code that would break the production site for our users.</p>
<h3><span id="parallel-tests">Parallel tests</span></h3><p>If our test set grows, running all tests on a single machine starts to take too long. In that case, we can easily parallelize the tests across multiple GitHub machines. Read the <a target="_blank" rel="noopener" href="https://github.com/cypress-io/github-action#parallel">Cypress GH Action documentation</a> and my blog post <a href="/blog/parallel-cypress-tests-gh-action/" title="Split Long GitHub Action Workflow Into Parallel Cypress Jobs">Split Long GitHub Action Workflow Into Parallel Cypress Jobs</a>. With all we have done so far, running the job in parallel should be easy.</p>
<h2><span id="see-also">See also</span></h2><ul>
<li><a href="/blog/test-netlify/" title="Test Sites Deployed To Netlify Using netlify-plugin-cypress">Test Sites Deployed To Netlify Using netlify-plugin-cypress</a></li>
<li><a href="/blog/trying-github-actions/" title="Trying GitHub Actions">Trying GitHub Actions</a></li>
<li><a href="/blog/parallel-cypress-tests-gh-action/" title="Split Long GitHub Action Workflow Into Parallel Cypress Jobs">Split Long GitHub Action Workflow Into Parallel Cypress Jobs</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/cypress-io/github-action">Cypress GitHub Action</a></li>
</ul>

      
    </div>

    
      <footer class="article-footer personal-links">
  <p>
    Follow Gleb Bahmutov <a target="_blank" rel="noopener" href="https://twitter.com/bahmutov">@bahmutov</a>,
    see his projects at <a href="https://glebbahmutov.com">glebbahmutov.com</a>,
    watch his Cypress <a target="_blank" rel="noopener" href="https://www.youtube.com/c/glebbahmutov/videos">videos</a>,
    browse his <a target="_blank" rel="noopener" href="https://slides.com/bahmutov">presentations</a>
  </p>
  <p>
    Want to know more about Cypress? Check out <a href="https://cypress.tips" target="_blank">cypress.tips</a>
  </p>
</footer>
<script src="https://rawgit.com/toddmotto/linkjuice/702066a37124081e7ad1a972844a9a91115be05a/dist/linkjuice.js"></script>
<script>
function contentFn (node, icon) {
  const s = '<a href="#' + node.id + '" class="linkjuice">' +
    node.innerHTML + ' ' + icon + '</a>\n'
  return s
}
linkjuice.init('.article-entry', {
  selectors: ['h2 span'],
  icon: '<span class="link-symbol">#</span>',
  contentFn: contentFn
});
</script>

    

    <footer class="article-footer">
      <a data-url="https://glebbahmutov.com/blog/tested-ecommerce/" data-id="cktk55cah014kdtvg93k2fxmf" class="article-share-link">Share</a>
      
        <a href="https://glebbahmutov.com/blog/tested-ecommerce/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/ci/" rel="tag">ci</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/cypress/" rel="tag">cypress</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/cypress-dashboard/" rel="tag">cypress dashboard</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/github/" rel="tag">github</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/netlify/" rel="tag">netlify</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../anchor-ping/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          How to Test Anchor Ping
        
      </div>
    </a>
  
  
    <a href="../reveal-vite/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Presentations with Reveal.js and Vite</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    <style>
#carbonads {
  display: block;
  overflow: hidden;
  font-size: 11px;
  font-family: Verdana, "Helvetica Neue", Helvetica, sans-serif;
  line-height: 1.5;
}

#carbonads a {
  color: #258fb8;
  text-decoration: none;
}

#carbonads a:hover {
  text-decoration: underline;
}

#carbonads span {
  position: relative;
  display: block;
  overflow: hidden;
}

.carbon-img {
  float: left;
  margin-right: 1em;
}

.carbon-img img { display: block; }

.carbon-text {
  display: block;
  float: left;
  text-align: left;
  margin-top: 0.5em;
}
@media screen and (min-width: 1024px) {
  .carbon-text {
    max-width: calc(100% - 130px - 1em);
  }
}

.carbon-poweredby {
  /*position: absolute;
  right: 0;
  bottom: 0;*/
  float: right;
  display: block;
  font-size: 11px;
}
</style>
<div class="widget-wrap">
  <div class="widget-title">&nbsp;</div>
  <div class="widget">
    <!-- Carbon Ads -->
    <script async type="text/javascript"
      src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=glebbahmutovcom"
      id="_carbonads_js"></script>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../categories/book-review/">book review</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/climate/">climate</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/people/">people</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/process/">process</a><span class="category-list-count">138</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/products/">products</a><span class="category-list-count">417</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="../tags/11ty/" rel="tag">11ty</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/QUnit/" rel="tag">QUnit</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/a11y/" rel="tag">a11y</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/advice/" rel="tag">advice</a><span class="tag-list-count">109</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/algolia/" rel="tag">algolia</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs/" rel="tag">angularjs</a><span class="tag-list-count">58</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs2/" rel="tag">angularjs2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/assertions/" rel="tag">assertions</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ast/" rel="tag">ast</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/boilerplate/" rel="tag">boilerplate</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/browser/" rel="tag">browser</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ci/" rel="tag">ci</a><span class="tag-list-count">24</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/circle/" rel="tag">circle</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/climate/" rel="tag">climate</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/code-coverage/" rel="tag">code coverage</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/concurrency/" rel="tag">concurrency</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cyclejs/" rel="tag">cyclejs</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cypress/" rel="tag">cypress</a><span class="tag-list-count">143</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cypress-dashboard/" rel="tag">cypress dashboard</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/d3/" rel="tag">d3</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/db/" rel="tag">db</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/docker/" rel="tag">docker</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/documentation/" rel="tag">documentation</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es6/" rel="tag">es6</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es7/" rel="tag">es7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/functional/" rel="tag">functional</a><span class="tag-list-count">68</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/generators/" rel="tag">generators</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/git/" rel="tag">git</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/github/" rel="tag">github</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/graphql/" rel="tag">graphql</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/grunt/" rel="tag">grunt</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/gulp/" rel="tag">gulp</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/hiring/" rel="tag">hiring</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/hyperapp/" rel="tag">hyperapp</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/immutable/" rel="tag">immutable</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/interview/" rel="tag">interview</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jade/" rel="tag">jade</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/javascript/" rel="tag">javascript</a><span class="tag-list-count">165</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jshint/" rel="tag">jshint</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/markdown/" rel="tag">markdown</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/model-based-testing/" rel="tag">model-based testing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/modular-development/" rel="tag">modular development</a><span class="tag-list-count">28</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/netlify/" rel="tag">netlify</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">84</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/performance/" rel="tag">performance</a><span class="tag-list-count">22</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/presentation/" rel="tag">presentation</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/promises/" rel="tag">promises</a><span class="tag-list-count">31</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/proposal/" rel="tag">proposal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ramda/" rel="tag">ramda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/react/" rel="tag">react</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/react-native/" rel="tag">react native</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactive/" rel="tag">reactive</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactjs/" rel="tag">reactjs</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/renovate/" rel="tag">renovate</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/screencast/" rel="tag">screencast</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/security/" rel="tag">security</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/sentry/" rel="tag">sentry</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/service-workers/" rel="tag">service workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/state-machine/" rel="tag">state machine</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/testing/" rel="tag">testing</a><span class="tag-list-count">130</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/tutorial/" rel="tag">tutorial</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/typescript/" rel="tag">typescript</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ui/" rel="tag">ui</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/vercel/" rel="tag">vercel</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/visual-testing/" rel="tag">visual testing</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/vuejs/" rel="tag">vuejs</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/web-workers/" rel="tag">web workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/webpack/" rel="tag">webpack</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../tags/11ty/" style="font-size: 10.38px;">11ty</a> <a href="../tags/QUnit/" style="font-size: 11.54px;">QUnit</a> <a href="../tags/a11y/" style="font-size: 10.77px;">a11y</a> <a href="../tags/advice/" style="font-size: 18.85px;">advice</a> <a href="../tags/algolia/" style="font-size: 10.38px;">algolia</a> <a href="../tags/angularjs/" style="font-size: 17.69px;">angularjs</a> <a href="../tags/angularjs2/" style="font-size: 10px;">angularjs2</a> <a href="../tags/assertions/" style="font-size: 13.08px;">assertions</a> <a href="../tags/ast/" style="font-size: 12.69px;">ast</a> <a href="../tags/boilerplate/" style="font-size: 15px;">boilerplate</a> <a href="../tags/browser/" style="font-size: 15.77px;">browser</a> <a href="../tags/ci/" style="font-size: 16.54px;">ci</a> <a href="../tags/circle/" style="font-size: 12.69px;">circle</a> <a href="../tags/climate/" style="font-size: 14.62px;">climate</a> <a href="../tags/code-coverage/" style="font-size: 13.46px;">code coverage</a> <a href="../tags/concurrency/" style="font-size: 10px;">concurrency</a> <a href="../tags/cyclejs/" style="font-size: 12.31px;">cyclejs</a> <a href="../tags/cypress/" style="font-size: 19.62px;">cypress</a> <a href="../tags/cypress-dashboard/" style="font-size: 13.85px;">cypress dashboard</a> <a href="../tags/d3/" style="font-size: 10.77px;">d3</a> <a href="../tags/db/" style="font-size: 14.62px;">db</a> <a href="../tags/docker/" style="font-size: 14.23px;">docker</a> <a href="../tags/documentation/" style="font-size: 11.92px;">documentation</a> <a href="../tags/es6/" style="font-size: 14.62px;">es6</a> <a href="../tags/es7/" style="font-size: 10px;">es7</a> <a href="../tags/functional/" style="font-size: 18.08px;">functional</a> <a href="../tags/generators/" style="font-size: 11.54px;">generators</a> <a href="../tags/git/" style="font-size: 15px;">git</a> <a href="../tags/github/" style="font-size: 15.38px;">github</a> <a href="../tags/graphql/" style="font-size: 11.15px;">graphql</a> <a href="../tags/grunt/" style="font-size: 12.31px;">grunt</a> <a href="../tags/gulp/" style="font-size: 10.77px;">gulp</a> <a href="../tags/hiring/" style="font-size: 10.77px;">hiring</a> <a href="../tags/hyperapp/" style="font-size: 12.31px;">hyperapp</a> <a href="../tags/immutable/" style="font-size: 11.54px;">immutable</a> <a href="../tags/interview/" style="font-size: 10.77px;">interview</a> <a href="../tags/jade/" style="font-size: 11.15px;">jade</a> <a href="../tags/javascript/" style="font-size: 20px;">javascript</a> <a href="../tags/jshint/" style="font-size: 10.77px;">jshint</a> <a href="../tags/markdown/" style="font-size: 13.85px;">markdown</a> <a href="../tags/model-based-testing/" style="font-size: 10px;">model-based testing</a> <a href="../tags/modular-development/" style="font-size: 16.92px;">modular development</a> <a href="../tags/netlify/" style="font-size: 11.15px;">netlify</a> <a href="../tags/nodejs/" style="font-size: 18.46px;">nodejs</a> <a href="../tags/performance/" style="font-size: 16.15px;">performance</a> <a href="../tags/presentation/" style="font-size: 12.31px;">presentation</a> <a href="../tags/promises/" style="font-size: 17.31px;">promises</a> <a href="../tags/proposal/" style="font-size: 10.38px;">proposal</a> <a href="../tags/ramda/" style="font-size: 10px;">ramda</a> <a href="../tags/react/" style="font-size: 11.54px;">react</a> <a href="../tags/react-native/" style="font-size: 11.15px;">react native</a> <a href="../tags/reactive/" style="font-size: 14.23px;">reactive</a> <a href="../tags/reactjs/" style="font-size: 11.15px;">reactjs</a> <a href="../tags/renovate/" style="font-size: 11.54px;">renovate</a> <a href="../tags/screencast/" style="font-size: 10px;">screencast</a> <a href="../tags/security/" style="font-size: 13.08px;">security</a> <a href="../tags/sentry/" style="font-size: 13.85px;">sentry</a> <a href="../tags/service-workers/" style="font-size: 11.92px;">service workers</a> <a href="../tags/state-machine/" style="font-size: 10px;">state machine</a> <a href="../tags/testing/" style="font-size: 19.23px;">testing</a> <a href="../tags/tutorial/" style="font-size: 15.77px;">tutorial</a> <a href="../tags/typescript/" style="font-size: 11.92px;">typescript</a> <a href="../tags/ui/" style="font-size: 10.38px;">ui</a> <a href="../tags/vercel/" style="font-size: 13.08px;">vercel</a> <a href="../tags/visual-testing/" style="font-size: 11.15px;">visual testing</a> <a href="../tags/vuejs/" style="font-size: 11.54px;">vuejs</a> <a href="../tags/web-workers/" style="font-size: 11.92px;">web workers</a> <a href="../tags/webpack/" style="font-size: 10.77px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/09/">September 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/08/">August 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/07/">July 2021</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/06/">June 2021</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/05/">May 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/04/">April 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/03/">March 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/02/">February 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/01/">January 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/12/">December 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/11/">November 2020</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/10/">October 2020</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/09/">September 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/08/">August 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/07/">July 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/06/">June 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/05/">May 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/04/">April 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/03/">March 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/02/">February 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/01/">January 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/12/">December 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/11/">November 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/10/">October 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/09/">September 2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/08/">August 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/07/">July 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/06/">June 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/05/">May 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/04/">April 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/03/">March 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/02/">February 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/01/">January 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/12/">December 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/11/">November 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/10/">October 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/09/">September 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/08/">August 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/06/">June 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/04/">April 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/03/">March 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/01/">January 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/12/">December 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/11/">November 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/09/">September 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/08/">August 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/07/">July 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/06/">June 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/05/">May 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/04/">April 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/03/">March 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/02/">February 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/01/">January 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/12/">December 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/10/">October 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/08/">August 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/07/">July 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/06/">June 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/05/">May 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/04/">April 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/03/">March 2016</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/02/">February 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/01/">January 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/12/">December 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/11/">November 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/08/">August 2015</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/07/">July 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/06/">June 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/05/">May 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/04/">April 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/03/">March 2015</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/02/">February 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/01/">January 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/12/">December 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/11/">November 2014</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/10/">October 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/09/">September 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/08/">August 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/07/">July 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/06/">June 2014</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/05/">May 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/04/">April 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/03/">March 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/02/">February 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/01/">January 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/12/">December 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/11/">November 2013</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/10/">October 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/09/">September 2013</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../what-i-do-after-a-conference/">What I Do After A Conference</a>
          </li>
        
          <li>
            <a href="../test-plain-or-markdown-file/">Test Plain Or Markdown File Using Cypress</a>
          </li>
        
          <li>
            <a href="../skip-cypress-install-on-ci/">Skip Cypress Install On CI</a>
          </li>
        
          <li>
            <a href="../verify-phone-part-two/">How To Verify Phone Number During Tests Part 2</a>
          </li>
        
          <li>
            <a href="../verify-phone-part-one/">How To Verify Phone Number During Tests Part 1</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Gleb Bahmutov<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
</nav>
    
<script>
  var disqus_shortname = 'betterworldbybettersoftware';
  
  var disqus_url = 'https://glebbahmutov.com/blog/tested-ecommerce/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="../fancybox/jquery.fancybox.css">

  
<script src="../fancybox/jquery.fancybox.pack.js"></script>




<script src="../js/script.js"></script>


  </div>
  <script src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script>
<script>
(function centerMainOnAsideScroll () {
  // when aside side bar scrolls outside the view
  // it centers the main content.
  const main = document.querySelector('#main')
  const aside = document.querySelector('aside#sidebar')
  console.assert(main, 'could not get #main')
  console.assert(aside, 'could not get aside')
  // initially the aside sidebar is visible
  let asideVisible = true

  function centerMain () {
    console.log('adding class center-main')
    main.classList.add('center-main')
  }
  function leftMain () {
    main.classList.remove('center-main')
  }

  function callWhenAsideScrollsUp (becameInvisible, becameVisible) {
    return function () {
      const border = 50
      const rect = aside.getBoundingClientRect()
      if (asideVisible && rect.bottom < -border) {
        asideVisible = false
        becameInvisible()
      }

      if (!asideVisible && window.scrollY < border) {
        asideVisible = true
        becameVisible()
      }
    }
  }
  const throttleWaitMs = 250
  const onScroll = _.throttle(
    callWhenAsideScrollsUp(centerMain, leftMain),
    throttleWaitMs
  )
  window.addEventListener('scroll', onScroll)
}())
</script>

</body>
</html>
