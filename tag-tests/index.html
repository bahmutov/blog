<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>How To Tag And Run End-to-End Tests | Better world by better software</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Let&#39;s say you have hundreds of end-to-end tests (this is our current situation at Mercari US). Running the tests in parallel makes the test run faster, but there is a problem. If someone inside th">
<meta property="og:type" content="article">
<meta property="og:title" content="How To Tag And Run End-to-End Tests">
<meta property="og:url" content="https://glebbahmutov.com/blog/tag-tests/index.html">
<meta property="og:site_name" content="Better world by better software">
<meta property="og:description" content="Let&#39;s say you have hundreds of end-to-end tests (this is our current situation at Mercari US). Running the tests in parallel makes the test run faster, but there is a problem. If someone inside th">
<meta property="og:locale">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/workflow.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/timing.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/eight.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/trigger.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/enter-tag.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/pipelines.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/pick-tags.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/action.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/pick-separate-tags.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/parallel.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/regression.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/regression-job.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/tag-organization.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/flow-inputs.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/flow-run.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/tag-tests/tag-dropdown.png">
<meta property="article:published_time" content="2022-01-10T05:00:00.000Z">
<meta property="article:modified_time" content="2022-06-27T15:42:26.614Z">
<meta property="article:author" content="Gleb Bahmutov">
<meta property="article:tag" content="cypress">
<meta property="article:tag" content="advice">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://glebbahmutov.com/blog/images/tag-tests/workflow.png">
<meta name="twitter:creator" content="@bahmutov">
  
    <link rel="alternative" href="/blog/atom.xml" title="Better world by better software" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="preload" href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" as="style">
  
<link rel="stylesheet" href="../css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-59999353-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-titles">
      <div id="header-title" class="inner">
        <h1 id="logo-wrap">
          <a href="../index.html" id="logo">Better world by better software</a>
        </h1>
        <!--
        
        -->
        <!-- <span class="no-mobile">Software advice from</span> -->
        <h2 id="subtitle-wrap">
          <span class="subtitle">
            <a id="subtitle" href="https://glebbahmutov.com">Gleb Bahmutov PhD</a>
            <a id="nav-house-link" class="nav-icon" href="/" title="Home"></a>
            
              <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
            
            <a id="nav-search-btn" class="nav-icon" title="Search"></a>
            <div id="search-form-wrap">
              <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://glebbahmutov.com/blog"></form>
            </div>
          </span>
        </h2>

      </div>
    </div>
    <div id="climate-crisis">
      <h2>Our planet üåè is in danger</h2>
      <h3>Act today: <a href="/blog/climate-emergency/">what you can do</a></h3>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-tag-tests" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2022-01-10T05:00:00.000Z" itemprop="datePublished">Jan 10 2022</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../categories/process/">process</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      How To Tag And Run End-to-End Tests
    </h1>

    <h2 class="article-title" itemprop="name">
      How to tag your Cypress tests to make sure anyone can quickly test the changes.
    </h2>

  


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Let&#39;s say you have hundreds of end-to-end tests (this is our current situation at Mercari US). Running the tests in parallel makes the test run <a href="/blog/parallel-cypress-tests-gh-action/" title="faster">faster</a>, but there is a problem. If someone inside the organization wants to change how some internal service operates, or changes a particular database field, you do not want to run all the tests. Or at least, you want to run the tests for that product area first to provide fast and useful feedback. This is how I organize and tag my end-to-end tests and run them.</p>
<blockquote class="pullquote"><p>üß∞ I will be using the repo <a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-todomvc-using-app-actions">bahmutov&#x2F;test-todomvc-using-app-actions</a> as my example. It only has about 30 tests, but the lessons scale even better when the number of tests is large.</p>
</blockquote>

<!-- toc -->

<ul>
<li><a href="#organize-the-tests-by-feature">Organize the tests by feature</a></li>
<li><a href="#run-any-changed-tests-first">Run any changed tests first</a></li>
<li><a href="#the-sanity-tag">The sanity tag</a></li>
<li><a href="#all-tests">All tests</a></li>
<li><a href="#run-all-tests-with-a-tag-on-ci">Run all tests with a tag on CI</a><ul>
<li><a href="#circleci">CircleCI</a></li>
<li><a href="#github-actions">GitHub Actions</a></li>
<li><a href="#separate-jobs">Separate jobs</a></li>
</ul>
</li>
<li><a href="#the-regression-tag">The regression tag</a></li>
<li><a href="#the-final-tag-organization">The final tag organization</a></li>
<li><a href="#bonus-1-github-triggers-circleci">Bonus 1: GitHub triggers CircleCI</a></li>
<li><a href="#bonus-2-when-you-have-a-lot-of-test-tags">Bonus 2: When you have a lot of test tags</a></li>
<li><a href="#bonus-3-presentation-slice-and-dice-your-end-to-end-tests">Bonus 3: presentation Slice And Dice Your End-to-End Tests</a></li>
</ul>
<!-- tocstop -->

<h2><span id="organize-the-tests-by-feature">Organize the tests by feature</span></h2><p>The first thing I do is to split a single long spec file into separate spec files. Each spec file is focused on a particular application feature. I try to keep the spec duration under two minutes, and I <a href="/blog/split-spec/" title="split long tests">split long tests</a> to make them easier to run. Currently I have 8 specs in the project:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ npx find-cypress-specs</span><br><span class="line">cypress/integration/adding-spec.js,cypress/integration/clear-completed-spec.js,</span><br><span class="line">cypress/integration/complete-all-spec.js,cypress/integration/editing-spec.js,</span><br><span class="line">cypress/integration/item-spec.js,cypress/integration/persistence-spec.js,</span><br><span class="line">cypress/integration/routing-spec.js,cypress/integration/spec.js</span><br></pre></td></tr></table></figure>

<p><strong>Tip:</strong> I will use <a target="_blank" rel="noopener" href="https://github.com/bahmutov/find-cypress-specs">find-cypress-specs</a> utility to print specs and test names.</p>
<p>In each spec file, I add a tag to the suite of tests using the <a target="_blank" rel="noopener" href="https://github.com/cypress-io/cypress-grep">cypress-grep</a> convention. For example, the tests related to routing are tagged <code>@routing</code>. The <code>@</code> character has no special meaning, it just makes it simpler to find it in the source code.</p>
<figure class="highlight js"><figcaption><span>cypress/integration/routing-spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;TodoMVC&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    cy.<span class="title function_">visit</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">context</span>(<span class="string">&#x27;Routing&#x27;</span>, &#123; <span class="attr">tags</span>: <span class="string">&#x27;@routing&#x27;</span> &#125;, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should allow me to display active items&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should respect the back button&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>I can see all tests and their tags using <a target="_blank" rel="noopener" href="https://github.com/bahmutov/find-cypress-specs">find-cypress-specs</a> with <code>--names</code> argument.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">$ npx find-cypress-specs --names</span><br><span class="line"></span><br><span class="line">cypress/integration/adding-spec.js (7 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îú‚îÄ New Todo [@adding]</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should allow me to add todo items</span><br><span class="line">  ‚îÇ ‚îú‚îÄ adds items</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should clear text input field when an item is added</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should append new items to the bottom of the list</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should trim text input</span><br><span class="line">  ‚îÇ ‚îî‚îÄ should show #main and #footer when items added</span><br><span class="line">  ‚îî‚îÄ Adds items (spy example)</span><br><span class="line">    ‚îî‚îÄ calls inform</span><br><span class="line"></span><br><span class="line">cypress/integration/clear-completed-spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Clear completed button [@complete]</span><br><span class="line">    ‚îú‚îÄ should display the correct text</span><br><span class="line">    ‚îú‚îÄ should remove completed items when clicked</span><br><span class="line">    ‚îî‚îÄ should be hidden when there are no items that are completed</span><br><span class="line"></span><br><span class="line">cypress/integration/complete-all-spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Mark all as completed [@complete]</span><br><span class="line">    ‚îú‚îÄ should allow me to mark all items as completed</span><br><span class="line">    ‚îú‚îÄ should allow me to clear the complete state of all items</span><br><span class="line">    ‚îî‚îÄ complete all checkbox should update state when items are completed / cleared</span><br><span class="line"></span><br><span class="line">cypress/integration/editing-spec.js (5 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Editing [@editing]</span><br><span class="line">    ‚îú‚îÄ should hide other controls when editing</span><br><span class="line">    ‚îú‚îÄ should save edits on blur</span><br><span class="line">    ‚îú‚îÄ should trim entered text</span><br><span class="line">    ‚îú‚îÄ should remove the item if an empty text string was entered</span><br><span class="line">    ‚îî‚îÄ should cancel edits on escape</span><br><span class="line"></span><br><span class="line">cypress/integration/item-spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Item [@item]</span><br><span class="line">    ‚îú‚îÄ should allow me to mark items as complete</span><br><span class="line">    ‚îú‚îÄ should allow me to un-mark items as complete</span><br><span class="line">    ‚îî‚îÄ should allow me to edit an item</span><br><span class="line"></span><br><span class="line">cypress/integration/persistence-spec.js (1 test)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Persistence [@persistence]</span><br><span class="line">    ‚îî‚îÄ should persist its data</span><br><span class="line"></span><br><span class="line">cypress/integration/routing-spec.js (5 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Routing [@routing]</span><br><span class="line">    ‚îú‚îÄ should allow me to display active items</span><br><span class="line">    ‚îú‚îÄ should respect the back button</span><br><span class="line">    ‚îú‚îÄ should allow me to display completed items</span><br><span class="line">    ‚îú‚îÄ should allow me to display all items</span><br><span class="line">    ‚îî‚îÄ should highlight the currently applied filter</span><br><span class="line"></span><br><span class="line">cypress/integration/spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îú‚îÄ When page is initially opened</span><br><span class="line">  ‚îÇ ‚îî‚îÄ should focus on the todo input field</span><br><span class="line">  ‚îú‚îÄ No Todos</span><br><span class="line">  ‚îÇ ‚îî‚îÄ should hide #main and #footer</span><br><span class="line">  ‚îî‚îÄ Counter</span><br><span class="line">    ‚îî‚îÄ should display the current number of todo items</span><br><span class="line"></span><br><span class="line">found 8 specs and 30 tests</span><br></pre></td></tr></table></figure>

<p>Not all tests need tags. For example, the last <code>spec.js</code> collects miscellaneous tests without any tags.</p>
<h2><span id="run-any-changed-tests-first">Run any changed tests first</span></h2><p>I have shown how to run the changed specs first, see <a href="/blog/faster-ci-feedback/" title="GitHub Actions post">GitHub Actions post</a> or <a href="/blog/faster-ci-feedback-on-circleci/" title="CircleCI post">CircleCI post</a>. In my example application, I am using CircleCI, here is how I run the changed specs before running all tests. You can find the full CircleCI config file at <a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-todomvc-using-app-actions/blob/master/circle.yml">circle.yml</a>.</p>
<figure class="highlight yml"><figcaption><span>circle.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="number">2.1</span></span><br><span class="line"><span class="attr">orbs:</span></span><br><span class="line">  <span class="comment"># https://github.com/cypress-io/circleci-orb</span></span><br><span class="line">  <span class="attr">cypress:</span> <span class="string">cypress-io/cypress@1.29.0</span></span><br><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">cypress/run:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">Run</span> <span class="string">changed</span> <span class="string">tests</span></span><br><span class="line">          <span class="attr">start:</span> <span class="string">npm</span> <span class="string">start</span></span><br><span class="line">          <span class="attr">no-workspace:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">command:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            # stop if on master branch - all tests should run there</span></span><br><span class="line"><span class="string">            if [ &quot;$CIRCLE_BRANCH&quot; = &quot;master&quot; ]; then</span></span><br><span class="line"><span class="string">              echo &quot;Default branch, will run all tests&quot;</span></span><br><span class="line"><span class="string">              exit 0</span></span><br><span class="line"><span class="string">            fi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">            <span class="comment"># be careful about counting the lines</span></span><br><span class="line">            <span class="string">specsLines=$(git</span> <span class="string">diff</span> <span class="string">--name-only</span> <span class="string">--diff-filter=AMR</span> <span class="string">origin/master</span> <span class="string">|</span> &#123; <span class="string">grep</span> <span class="string">cypress/integration</span> <span class="string">||</span> <span class="literal">true</span><span class="string">;</span> &#125;<span class="string">)</span></span><br><span class="line">            <span class="string">n=$(echo</span> <span class="string">$specsLines</span> <span class="string">|</span> <span class="string">sed</span> <span class="string">&#x27;/^\s*$/d&#x27;</span> <span class="string">|</span> <span class="string">wc</span> <span class="string">-l</span> <span class="string">|</span> <span class="string">tr</span> <span class="string">-d</span> <span class="string">&#x27; &#x27;</span><span class="string">)</span></span><br><span class="line">            <span class="string">specs=$(echo</span> <span class="string">$specsLines</span> <span class="string">|</span> <span class="string">sed</span> <span class="string">&#x27;/^\s*$/d&#x27;</span> <span class="string">|</span> <span class="string">tr</span> <span class="string">&#x27;\n&#x27;</span> <span class="string">&#x27;,&#x27;</span><span class="string">)</span></span><br><span class="line">            <span class="string">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="string">echo</span> <span class="string">&quot;Changed and added $&#123;n&#125; Cypress specs&quot;</span></span><br><span class="line">            <span class="string">echo</span> <span class="string">$&#123;specs&#125;</span></span><br><span class="line">            <span class="string">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="string">if</span> [ <span class="string">$</span>&#123;<span class="string">n</span>&#125; <span class="string">-lt</span> <span class="number">1</span> ]<span class="string">;</span> <span class="string">then</span></span><br><span class="line">              <span class="string">echo</span> <span class="string">&quot;No Cypress specs changed, exiting...&quot;</span></span><br><span class="line">              <span class="string">exit</span> <span class="number">0</span></span><br><span class="line">            <span class="string">fi</span></span><br><span class="line">            <span class="comment"># we have to form the Cypress run command ourselves</span></span><br><span class="line">            <span class="string">npx</span> <span class="string">cypress</span> <span class="string">run</span> <span class="string">--spec</span> <span class="string">$&#123;specs&#125;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">cypress/run:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">Run</span> <span class="string">all</span> <span class="string">tests</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Run</span> <span class="string">changed</span> <span class="string">tests</span></span><br><span class="line">          <span class="attr">build:</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">print-tests</span></span><br><span class="line">          <span class="attr">start:</span> <span class="string">npm</span> <span class="string">start</span></span><br><span class="line">          <span class="attr">no-workspace:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>If we push a branch <code>change1</code> where we just change something in <code>cypress/integration/routing.js</code> file, we see that test executed first.</p>
<p><img src="../images/tag-tests/workflow.png" alt="Workflow with two jobs"></p>
<p>Inside the &quot;Run changed tests&quot; job, Cypress shows the specs it is about to execute.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Changed and added 1 Cypress specs</span><br><span class="line">cypress/integration/complete-all-spec.js,</span><br><span class="line">...</span><br><span class="line">====================================================================================================</span><br><span class="line"></span><br><span class="line">  (Run Starting)</span><br><span class="line"></span><br><span class="line">  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span><br><span class="line">  ‚îÇ Cypress:        9.2.0                                                                          ‚îÇ</span><br><span class="line">  ‚îÇ Browser:        Electron 94 (headless)                                                         ‚îÇ</span><br><span class="line">  ‚îÇ Node Version:   v12.19.0 (/usr/local/bin/node)                                                 ‚îÇ</span><br><span class="line">  ‚îÇ Specs:          1 found (complete-all-spec.js)                                                 ‚îÇ</span><br><span class="line">  ‚îÇ Searched:       cypress/integration/complete-all-spec.js,                                      ‚îÇ</span><br><span class="line">  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span><br></pre></td></tr></table></figure>

<p>Running the changed tests first gives us fast feedback. If the changed tests pass, all tests execute to confirm the application works. Notice that running the changed tests is much faster compared to running all tests.</p>
<p><img src="../images/tag-tests/timing.png" alt="The changed specs job is shorter than running all specs job"></p>
<h2><span id="the-sanity-tag">The sanity tag</span></h2><p>As the number of specs grows, running all tests on every pull request becomes a burden on the infrastructure and CI resources. Thus I recommend creating a small set of sanity tests, with one test per feature. We can tag these tests <code>@sanity</code> and run on every pull request by default. Here are the tagged tests</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">$ npx find-cypress-specs --names</span><br><span class="line"></span><br><span class="line">cypress/integration/adding-spec.js (7 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îú‚îÄ New Todo [@adding]</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should allow me to add todo items</span><br><span class="line">  ‚îÇ ‚îú‚îÄ adds items [@sanity]</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should clear text input field when an item is added</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should append new items to the bottom of the list</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should trim text input</span><br><span class="line">  ‚îÇ ‚îî‚îÄ should show #main and #footer when items added</span><br><span class="line">  ‚îî‚îÄ Adds items (spy example)</span><br><span class="line">    ‚îî‚îÄ calls inform</span><br><span class="line"></span><br><span class="line">cypress/integration/clear-completed-spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Clear completed button [@complete]</span><br><span class="line">    ‚îú‚îÄ should display the correct text</span><br><span class="line">    ‚îú‚îÄ should remove completed items when clicked [@sanity]</span><br><span class="line">    ‚îî‚îÄ should be hidden when there are no items that are completed</span><br><span class="line"></span><br><span class="line">cypress/integration/complete-all-spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Mark all as completed [@complete]</span><br><span class="line">    ‚îú‚îÄ should allow me to mark all items as completed</span><br><span class="line">    ‚îú‚îÄ should allow me to clear the complete state of all items [@sanity]</span><br><span class="line">    ‚îî‚îÄ complete all checkbox should update state when items are completed / cleared</span><br><span class="line"></span><br><span class="line">cypress/integration/editing-spec.js (5 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Editing [@editing]</span><br><span class="line">    ‚îú‚îÄ should hide other controls when editing</span><br><span class="line">    ‚îú‚îÄ should save edits on blur [@sanity]</span><br><span class="line">    ‚îú‚îÄ should trim entered text</span><br><span class="line">    ‚îú‚îÄ should remove the item if an empty text string was entered</span><br><span class="line">    ‚îî‚îÄ should cancel edits on escape</span><br><span class="line"></span><br><span class="line">cypress/integration/item-spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Item [@item]</span><br><span class="line">    ‚îú‚îÄ should allow me to mark items as complete [@sanity]</span><br><span class="line">    ‚îú‚îÄ should allow me to un-mark items as complete</span><br><span class="line">    ‚îî‚îÄ should allow me to edit an item</span><br><span class="line"></span><br><span class="line">cypress/integration/persistence-spec.js (1 test)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Persistence [@persistence]</span><br><span class="line">    ‚îî‚îÄ should persist its data [@sanity]</span><br><span class="line"></span><br><span class="line">cypress/integration/routing-spec.js (5 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Routing [@routing]</span><br><span class="line">    ‚îú‚îÄ should allow me to display active items</span><br><span class="line">    ‚îú‚îÄ should respect the back button</span><br><span class="line">    ‚îú‚îÄ should allow me to display completed items [@sanity]</span><br><span class="line">    ‚îú‚îÄ should allow me to display all items</span><br><span class="line">    ‚îî‚îÄ should highlight the currently applied filter</span><br><span class="line"></span><br><span class="line">cypress/integration/spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îú‚îÄ When page is initially opened</span><br><span class="line">  ‚îÇ ‚îî‚îÄ should focus on the todo input field</span><br><span class="line">  ‚îú‚îÄ No Todos</span><br><span class="line">  ‚îÇ ‚îî‚îÄ should hide #main and #footer</span><br><span class="line">  ‚îî‚îÄ Counter</span><br><span class="line">    ‚îî‚îÄ should display the current number of todo items [@sanity]</span><br><span class="line"></span><br><span class="line">found 8 specs and 30 tests</span><br></pre></td></tr></table></figure>

<p>We can run the sanity tests instead of all the tests. Let&#39;s modify the &quot;Run all specs&quot; job by passing <code>grepTags</code> parameter through the Cypress environment variables. This is how you control the <code>cypress-grep</code> plugin.</p>
<figure class="highlight yml"><figcaption><span>circle.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">cypress/run:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Run</span> <span class="string">sanity</span> <span class="string">tests</span></span><br><span class="line">    <span class="attr">requires:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">Run</span> <span class="string">changed</span> <span class="string">tests</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">print-tests</span></span><br><span class="line">    <span class="attr">start:</span> <span class="string">npm</span> <span class="string">start</span></span><br><span class="line">    <span class="attr">no-workspace:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">env:</span> <span class="string">grepTags=@sanity</span></span><br></pre></td></tr></table></figure>

<p>If you look at the CircleCI output, you can see that cypress-grep plugin is working</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cypress-grep: filtering using tag &quot;@sanity&quot;</span><br><span class="line">cypress-grep: will omit filtered tests</span><br><span class="line">cypress-grep: filtering specs using tag &quot;@sanity&quot;</span><br></pre></td></tr></table></figure>

<p>The final test run only executed 8 tests.</p>
<p><img src="../images/tag-tests/eight.png" alt="CircleCI job only ran 8 sanity tests"></p>
<p><strong>Bonus:</strong> running just the sanity tests and skipping the rest saves on your <a target="_blank" rel="noopener" href="https://www.cypress.io/pricing/">Cypress Dashboard</a> bill üí∏</p>
<h2><span id="all-tests">All tests</span></h2><p>Hmm, we should still run all tests sometimes. The best solution is to run all tests periodically, for example every night, plus on demand by triggering the workflow using something like <a target="_blank" rel="noopener" href="https://github.com/bahmutov/run-cy-on-ci">bahmutov&#x2F;run-cy-on-ci</a>. I have <a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-todomvc-using-app-actions/commit/89d80d20388d4b913c4131b19cefb95227e2a205">added a workflow</a> to run all tests nightly</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">nightly:</span></span><br><span class="line">    <span class="attr">triggers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">schedule:</span></span><br><span class="line">          <span class="attr">cron:</span> <span class="string">&#x27;0 0 * * *&#x27;</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="attr">branches:</span></span><br><span class="line">              <span class="attr">only:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">cypress/run:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">Run</span> <span class="string">all</span> <span class="string">tests</span></span><br><span class="line">          <span class="attr">build:</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">print-tests</span></span><br><span class="line">          <span class="attr">start:</span> <span class="string">npm</span> <span class="string">start</span></span><br><span class="line">          <span class="attr">no-workspace:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="string">...</span></span><br></pre></td></tr></table></figure>

<h2><span id="run-all-tests-with-a-tag-on-ci">Run all tests with a tag on CI</span></h2><h3><span id="circleci">CircleCI</span></h3><p>Imagine someone is changing a component related to editing the Todo text on the page. They have deployed the site and want to run all end-to-end tests related to editing items. Without <a href="../tags/code-coverage/">code coverage</a> it is hard to say which E2E tests should run. Well, in general we run the sanity tests and we should run all tests tagged <code>@editing</code>. Let&#39;s allow anyone to trigger the CI workflow and to pass the tag to the test job. I will add a new workflow and pipeline parameters to the <a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-todomvc-using-app-actions/blob/master/circle.yml">circle.yml</a> file.</p>
<figure class="highlight yml"><figcaption><span>circle.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">parameters:</span></span><br><span class="line">  <span class="attr">GREP_TAGS:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">enum</span></span><br><span class="line">    <span class="attr">enum:</span></span><br><span class="line">      [</span><br><span class="line">        <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;@sanity&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;@adding&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;@complete&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;@editing&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;@item&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;@persistence&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;@routing&#x27;</span>,</span><br><span class="line">      ]</span><br><span class="line">    <span class="attr">default:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">nightly:</span></span><br><span class="line">    <span class="string">...</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">tagged:</span></span><br><span class="line">    <span class="attr">when:</span> <span class="string">&lt;&lt;</span> <span class="string">pipeline.parameters.GREP_TAGS</span> <span class="string">&gt;&gt;</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">cypress/run:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">Run</span> <span class="string">tagged</span> <span class="string">tests</span></span><br><span class="line">          <span class="attr">build:</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">print-tests</span></span><br><span class="line">          <span class="attr">start:</span> <span class="string">npm</span> <span class="string">start</span></span><br><span class="line">          <span class="attr">no-workspace:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">env:</span> <span class="string">grepTags=&lt;&lt;</span> <span class="string">pipeline.parameters.GREP_TAGS</span> <span class="string">&gt;&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">unless:</span> <span class="string">&lt;&lt;</span> <span class="string">pipeline.parameters.GREP_TAGS</span> <span class="string">&gt;&gt;</span></span><br><span class="line">    <span class="string">...</span></span><br></pre></td></tr></table></figure>

<p>Our new workflow <code>tagged</code> only runs when there is <code>GREP_TAGS</code> string and an empty default string &quot;&quot; does not count. Let&#39;s trigger the workflow from the CircleCI web interface.</p>
<p><img src="../images/tag-tests/trigger.png" alt="Click the &quot;Trigger pipeline&quot; button"></p>
<p>Add a string parameter named <code>GREP_TAGS</code> and enter one of the above <code>enum</code> values, like <code>@editing</code>.</p>
<p><img src="../images/tag-tests/enter-tag.png" alt="Enter the tag to use to filter the tests"></p>
<p>The workflow <code>tagged</code> runs, while the normal workflow is skipped. On other commits, the entire <code>build</code> workflow runs, while the <code>tagged</code> workflow is skipped.</p>
<p><img src="../images/tag-tests/pipelines.png" alt="Workflows skipped depending on the GREP_TAGS parameter"></p>
<p>The workflows are enabled and disabled using the pipeline parameter</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tagged:</span><br><span class="line">  when: &lt;&lt; pipeline.parameters.GREP_TAGS &gt;&gt;</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">build:</span><br><span class="line">  unless: &lt;&lt; pipeline.parameters.GREP_TAGS &gt;&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="github-actions">GitHub Actions</span></h3><p>The user who tries to run the tests by a tag on CircleCI has to remember how to trigger the workflow and add the right parameter. I would like the experience to be simpler. Thus I looked at using GitHub Actions with its new &quot;workflow_dispatch&quot; workflows. In the <a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-todomvc-using-app-actions/blob/master/.github/workflows/tagged.yml">.github&#x2F;workflows&#x2F;tagged.yml</a> I have defined a workflow where each input parameter is a boolean for the tag to run. It looks scary, but this is simple repetition: each tag matches one input parameter and one job to run.</p>
<figure class="highlight yml"><figcaption><span>.github/workflows/tagged.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">tagged</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line">    <span class="attr">inputs:</span></span><br><span class="line">      <span class="comment"># these inputs will be shown to the user on GitHub Actions page</span></span><br><span class="line">      <span class="comment"># and the user can simply check off the tags to run</span></span><br><span class="line">      <span class="attr">sanity:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Run</span> <span class="string">the</span> <span class="string">tests</span> <span class="string">tagged</span> <span class="string">&quot;@sanity&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">boolean</span></span><br><span class="line">      <span class="attr">adding:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Run</span> <span class="string">the</span> <span class="string">tests</span> <span class="string">tagged</span> <span class="string">&quot;@adding&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">boolean</span></span><br><span class="line">      <span class="string">...</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">tagged:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-20.04</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">üõé</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># install dependencies and start the server</span></span><br><span class="line">      <span class="comment"># https://github.com/cypress-io/github-action</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">dependencies</span> <span class="string">üì¶</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">cypress-io/github-action@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">runTests:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Start</span> <span class="string">the</span> <span class="string">server</span> <span class="string">üöÄ</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">start</span> <span class="string">&amp;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">sanity</span> <span class="string">tests</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.inputs.sanity</span> <span class="string">==</span> <span class="string">&#x27;true&#x27;</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">cypress-io/github-action@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">install:</span> <span class="literal">false</span></span><br><span class="line">          <span class="attr">env:</span> <span class="string">grepTags=@sanity</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">adding</span> <span class="string">tests</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.inputs.adding</span> <span class="string">==</span> <span class="string">&#x27;true&#x27;</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">cypress-io/github-action@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">install:</span> <span class="literal">false</span></span><br><span class="line">          <span class="attr">env:</span> <span class="string">grepTags=@adding</span></span><br><span class="line"></span><br><span class="line">      <span class="string">...</span></span><br></pre></td></tr></table></figure>

<p>This is pretty sweet - any user with GitHub access to the repo can click on the button &quot;Run workflow&quot; and check off the tags to test.</p>
<p><img src="../images/tag-tests/pick-tags.png" alt="Pick the test tags to run"></p>
<p>Only the picked test tags execute, the other steps are skipped.</p>
<p><img src="../images/tag-tests/action.png" alt="Running just the selected sets of tests on GitHub"></p>
<p>Beautiful.</p>
<h3><span id="separate-jobs">Separate jobs</span></h3><p>Instead of having a single job executing tagged tests, we could have created a separate job for each tag that can be picked. These jobs could all work in parallel. Here is the main part of the <a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-todomvc-using-app-actions/blob/master/.github/workflows/tagged-jobs.yml">tagged-jobs.yml</a></p>
<figure class="highlight yml"><figcaption><span>.github/workflows/tagged-jobs.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># separate running each grep tag into own job</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">tagged-jobs</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line">    <span class="attr">inputs:</span></span><br><span class="line">      <span class="comment"># these inputs will be shown to the user on GitHub Actions page</span></span><br><span class="line">      <span class="comment"># and the user can simply check off the tags to run</span></span><br><span class="line">      <span class="attr">sanity:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Run</span> <span class="string">the</span> <span class="string">tests</span> <span class="string">tagged</span> <span class="string">&quot;@sanity&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">boolean</span></span><br><span class="line">      <span class="attr">adding:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Run</span> <span class="string">the</span> <span class="string">tests</span> <span class="string">tagged</span> <span class="string">&quot;@adding&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">boolean</span></span><br><span class="line">      <span class="string">...</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="comment"># each job is independent from other jobs</span></span><br><span class="line">  <span class="comment"># and only runs the tests for the picked test tag</span></span><br><span class="line">  <span class="attr">sanity:</span></span><br><span class="line">    <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.inputs.sanity</span> <span class="string">==</span> <span class="string">&#x27;true&#x27;</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-20.04</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">üõé</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">sanity</span> <span class="string">tests</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">cypress-io/github-action@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">start:</span> <span class="string">npm</span> <span class="string">start</span></span><br><span class="line">          <span class="attr">env:</span> <span class="string">grepTags=@sanity</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">adding:</span></span><br><span class="line">    <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.inputs.adding</span> <span class="string">==</span> <span class="string">&#x27;true&#x27;</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-20.04</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">üõé</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">adding</span> <span class="string">tests</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">cypress-io/github-action@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">start:</span> <span class="string">npm</span> <span class="string">start</span></span><br><span class="line">          <span class="attr">env:</span> <span class="string">grepTags=@adding</span></span><br><span class="line"></span><br><span class="line">  <span class="string">...</span></span><br></pre></td></tr></table></figure>

<p>Now we can pick the features to test without worrying about a long queue of tests running sequentially.</p>
<p><img src="../images/tag-tests/pick-separate-tags.png" alt="Pick as many features to test as you wish"></p>
<p>The screenshot below shows how the jobs proceed in parallel with each other</p>
<p><img src="../images/tag-tests/parallel.png" alt="The parallel test jobs each running tagged tests"></p>
<p>Fast.</p>
<h2><span id="the-regression-tag">The regression tag</span></h2><p>Imagine you are deploying a schema change in the database, or fiddling with some API service. You might not know which area of the site you might have broken. Running all tests might take too long, and running just the tests tagged <code>@sanity</code> is not enough - they are only covering the essential user paths. We need something in between the <code>@sanity</code> list and all the tests.</p>
<p>This is where the <code>@regression</code> tag comes in. We can mark a big chunk of the tests with this tag, and whenever we want to confirm the site still works, we run those tests by tag. Of course, running all the tests could be better, but there is a trade off: speed vs completeness.</p>
<p>Here is how the &quot;clear-completed-spec.js&quot; looks. The tests tagged <code>@sanity</code> get the second tag, and another test now gets its <code>@regression</code> tag.</p>
<figure class="highlight js"><figcaption><span>cypress/integration/clear-completed-spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;TodoMVC&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">context</span>(<span class="string">&#x27;Clear completed button&#x27;</span>, &#123; <span class="attr">tags</span>: <span class="string">&#x27;@complete&#x27;</span> &#125;, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should display the correct text&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123; ... &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should remove completed items when clicked&#x27;</span>,</span><br><span class="line">      &#123; <span class="attr">tags</span>: [<span class="string">&#x27;@sanity&#x27;</span>, <span class="string">&#x27;@regression&#x27;</span>] &#125;,</span><br><span class="line">      <span class="keyword">function</span> (<span class="params"></span>) &#123; ... &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should be hidden when there are no items that are completed&#x27;</span>,</span><br><span class="line">      &#123; <span class="attr">tags</span>: <span class="string">&#x27;@regression&#x27;</span> &#125;,</span><br><span class="line">      <span class="keyword">function</span> (<span class="params"></span>) &#123; ... &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>In general, the <code>@regression</code> set is a superset of the <code>@sanity</code> tests.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ npx find-cypress-specs --names | grep &#x27;@sanity&#x27; | wc -l</span><br><span class="line">       8</span><br><span class="line">$ npx find-cypress-specs --names | grep &#x27;@regression&#x27; | wc -l</span><br><span class="line">      17</span><br></pre></td></tr></table></figure>

<p>The full test outline</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">$ npx find-cypress-specs --names</span><br><span class="line"></span><br><span class="line">$ npx find-cypress-specs --names</span><br><span class="line"></span><br><span class="line">cypress/integration/adding-spec.js (7 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îú‚îÄ New Todo [@adding]</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should allow me to add todo items [@regression]</span><br><span class="line">  ‚îÇ ‚îú‚îÄ adds items [@sanity, @regression]</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should clear text input field when an item is added [@regression]</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should append new items to the bottom of the list</span><br><span class="line">  ‚îÇ ‚îú‚îÄ should trim text input [@regression]</span><br><span class="line">  ‚îÇ ‚îî‚îÄ should show #main and #footer when items added</span><br><span class="line">  ‚îî‚îÄ Adds items (spy example)</span><br><span class="line">    ‚îî‚îÄ calls inform</span><br><span class="line"></span><br><span class="line">cypress/integration/clear-completed-spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Clear completed button [@complete]</span><br><span class="line">    ‚îú‚îÄ should display the correct text</span><br><span class="line">    ‚îú‚îÄ should remove completed items when clicked [@sanity, @regression]</span><br><span class="line">    ‚îî‚îÄ should be hidden when there are no items that are completed [@regression]</span><br><span class="line"></span><br><span class="line">cypress/integration/complete-all-spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Mark all as completed [@complete]</span><br><span class="line">    ‚îú‚îÄ should allow me to mark all items as completed [@regression]</span><br><span class="line">    ‚îú‚îÄ should allow me to clear the complete state of all items [@sanity, @regression]</span><br><span class="line">    ‚îî‚îÄ complete all checkbox should update state when items are completed / cleared</span><br><span class="line"></span><br><span class="line">cypress/integration/editing-spec.js (5 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Editing [@editing]</span><br><span class="line">    ‚îú‚îÄ should hide other controls when editing</span><br><span class="line">    ‚îú‚îÄ should save edits on blur [@sanity]</span><br><span class="line">    ‚îú‚îÄ should trim entered text</span><br><span class="line">    ‚îú‚îÄ should remove the item if an empty text string was entered</span><br><span class="line">    ‚îî‚îÄ should cancel edits on escape</span><br><span class="line"></span><br><span class="line">cypress/integration/item-spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Item [@item]</span><br><span class="line">    ‚îú‚îÄ should allow me to mark items as complete [@sanity, @regression]</span><br><span class="line">    ‚îú‚îÄ should allow me to un-mark items as complete [@regression]</span><br><span class="line">    ‚îî‚îÄ should allow me to edit an item</span><br><span class="line"></span><br><span class="line">cypress/integration/persistence-spec.js (1 test)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Persistence [@persistence]</span><br><span class="line">    ‚îî‚îÄ should persist its data [@sanity, @regression]</span><br><span class="line"></span><br><span class="line">cypress/integration/routing-spec.js (5 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îî‚îÄ Routing [@routing]</span><br><span class="line">    ‚îú‚îÄ should allow me to display active items [@regression]</span><br><span class="line">    ‚îú‚îÄ should respect the back button</span><br><span class="line">    ‚îú‚îÄ should allow me to display completed items [@sanity, @regression]</span><br><span class="line">    ‚îú‚îÄ should allow me to display all items [@regression]</span><br><span class="line">    ‚îî‚îÄ should highlight the currently applied filter</span><br><span class="line"></span><br><span class="line">cypress/integration/spec.js (3 tests)</span><br><span class="line">‚îî‚îÄ TodoMVC</span><br><span class="line">  ‚îú‚îÄ When page is initially opened [@regression]</span><br><span class="line">  ‚îÇ ‚îî‚îÄ should focus on the todo input field</span><br><span class="line">  ‚îú‚îÄ No Todos</span><br><span class="line">  ‚îÇ ‚îî‚îÄ should hide #main and #footer [@regression]</span><br><span class="line">  ‚îî‚îÄ Counter</span><br><span class="line">    ‚îî‚îÄ should display the current number of todo items [@sanity, @regression]</span><br><span class="line"></span><br><span class="line">found 8 specs and 30 tests</span><br></pre></td></tr></table></figure>

<p>I have updated the CircleCI and the GitHub Actions workflows to allow selecting <code>@regression</code> tag.</p>
<p><img src="../images/tag-tests/regression.png" alt="Manually running all regression tests on GitHub"></p>
<p><img src="../images/tag-tests/regression-job.png" alt="A single job ran executing just the regression tests"></p>
<h2><span id="the-final-tag-organization">The final tag organization</span></h2><p>To summarize: we have organized our tests using tags. There are feature-level tags like <code>@editing</code> and two &quot;coverage&quot; tags: <code>@sanity</code> and <code>@regression</code>. The sets of tests overlap, and there might be tests without any tags.</p>
<p><img src="../images/tag-tests/tag-organization.png" alt="Test tag coverage"></p>
<p>On every pull request we execute the changed specs and then run <code>@sanity</code> tests. Whenever someone is working on the feature, they can quickly run the tests for that feature using the individual feature tag. When in doubt, you can execute a wider set of tests using <code>@regression</code> tag. To completely test the software (which we can do periodically), one can run all the tests without any filtering by tag.</p>
<h2><span id="bonus-1-github-triggers-circleci">Bonus 1: GitHub triggers CircleCI</span></h2><p>If you have implemented running tests on CircleCI, but want to use the GitHub Actions user interface, you can collect the tags and trigger the CircleCI pipeline, see <a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-todomvc-using-app-actions/blob/master/.github/workflows/trigger-circleci.yml">trigger-circleci.yml</a> workflow file.</p>
<figure class="highlight yml"><figcaption><span>trigger-circleci.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">trigger-circleci</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line">    <span class="attr">inputs:</span></span><br><span class="line">      <span class="comment"># these inputs will be shown to the user on GitHub Actions page</span></span><br><span class="line">      <span class="comment"># and the user can simply check off the tags to run</span></span><br><span class="line">      <span class="attr">sanity:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Run</span> <span class="string">the</span> <span class="string">tests</span> <span class="string">tagged</span> <span class="string">&quot;@sanity&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">boolean</span></span><br><span class="line">      <span class="attr">regression:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Run</span> <span class="string">the</span> <span class="string">tests</span> <span class="string">tagged</span> <span class="string">&quot;@regression&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">boolean</span></span><br><span class="line">      <span class="string">...</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">trigger-circleci:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-20.04</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Print</span> <span class="string">GitHub</span> <span class="string">event</span> <span class="string">inputs</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">EVENT:</span> <span class="string">$&#123;&#123;</span> <span class="string">toJson(github.event.inputs)</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          echo &quot;$EVENT&quot;</span></span><br><span class="line"><span class="string">          # all environment variables that start with GITHUB_</span></span><br><span class="line"><span class="string">          # https://github.com/bahmutov/print-env</span></span><br><span class="line"><span class="string">          npx @bahmutov/print-env GITHUB_</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Trigger</span> <span class="string">CircleCI</span> <span class="string">run</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">CIRCLE_CI_API_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.CIRCLE_CI_API_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          # collect all input parameters into one string</span></span><br><span class="line"><span class="string">          TAGS=</span></span><br><span class="line"><span class="string">          if [[ &quot;$&#123;&#123; github.event.inputs.sanity &#125;&#125;&quot; == &quot;true&quot; ]]; then</span></span><br><span class="line"><span class="string">            TAGS=&quot;@sanity&quot;</span></span><br><span class="line"><span class="string">          fi</span></span><br><span class="line"><span class="string">          if [[ &quot;$&#123;&#123; github.event.inputs.regression &#125;&#125;&quot; == &quot;true&quot; ]]; then</span></span><br><span class="line"><span class="string">            TAGS=&quot;$TAGS @regression&quot;</span></span><br><span class="line"><span class="string">          fi</span></span><br><span class="line"><span class="string">          if [[ &quot;$&#123;&#123; github.event.inputs.adding &#125;&#125;&quot; == &quot;true&quot; ]]; then</span></span><br><span class="line"><span class="string">            TAGS=&quot;$TAGS @adding&quot;</span></span><br><span class="line"><span class="string">          fi</span></span><br><span class="line"><span class="string">          ...</span></span><br><span class="line"><span class="string">          echo &quot;Collected tags: $TAGS&quot;</span></span><br><span class="line"><span class="string">          # https://github.com/bahmutov/trigger-circleci-pipeline</span></span><br><span class="line"><span class="string">          npx trigger-circleci-pipeline \</span></span><br><span class="line"><span class="string">            --org bahmutov --project test-todomvc-using-app-actions \</span></span><br><span class="line"><span class="string">            --branch $GITHUB_REF_NAME --parameters GREP_TAGS=&quot;$TAGS&quot;</span></span><br></pre></td></tr></table></figure>

<p>I am using <a target="_blank" rel="noopener" href="https://github.com/bahmutov/print-env">print-env</a> to print the GitHub environment variables and <a target="_blank" rel="noopener" href="https://github.com/bahmutov/trigger-circleci-pipeline">trigger-circleci-pipeline</a> to trigger the CircleCI pipeline via API (you will need your personal CircleCI API token to work).</p>
<h2><span id="bonus-2-when-you-have-a-lot-of-test-tags">Bonus 2: When you have a lot of test tags</span></h2><p>If you have a lot of test tags, and want to let the user pick the ones to run from GitHub user interface, using individual input workflow parameters quickly runs into the ten parameters max limit (January 2022). Thus I have reworked the above workflow to let the user pick some common sets (like the regression the and sanity sets) using checkboxes, and let the user pick other tags to run by entering them as a single string. Find the full workflow at <a target="_blank" rel="noopener" href="https://github.com/bahmutov/test-todomvc-using-app-actions/blob/master/.github/workflows/trigger-circle-type.yml">trigger-circle-type.yml</a></p>
<figure class="highlight yml"><figcaption><span>.github/workflows/trigger-circle-type.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">trigger-circleci-type</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line">    <span class="attr">inputs:</span></span><br><span class="line">      <span class="comment"># these inputs will be shown to the user on GitHub Actions page</span></span><br><span class="line">      <span class="comment"># and the user can simply check off the tags to run</span></span><br><span class="line">      <span class="comment"># the two sets of tests covering most of the features</span></span><br><span class="line">      <span class="comment"># <span class="doctag">NOTE:</span> GitHub workflows are limited to ten input parameters</span></span><br><span class="line">      <span class="attr">sanity:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Run</span> <span class="string">the</span> <span class="string">tests</span> <span class="string">tagged</span> <span class="string">&quot;@sanity&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">boolean</span></span><br><span class="line">      <span class="attr">regression:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">Run</span> <span class="string">the</span> <span class="string">tests</span> <span class="string">tagged</span> <span class="string">&quot;@regression&quot;</span></span><br><span class="line">        <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">boolean</span></span><br><span class="line">      <span class="comment"># tests for individual features - the user will need to type the tags</span></span><br><span class="line">      <span class="comment"># comma-separated in order to avoid hitting then ten workflow input limit</span></span><br><span class="line">      <span class="attr">testTags:</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          Other test tags to run, comma-separated. Includes @adding, @complete,</span></span><br><span class="line"><span class="string">          @editing, @item, @persistence, @routing</span></span><br><span class="line"><span class="string"></span>  <span class="string">...</span></span><br><span class="line">  <span class="comment"># collect all input parameters into one string</span></span><br><span class="line">  <span class="string">TAGS=</span></span><br><span class="line">  <span class="string">if</span> [[ <span class="string">&quot;$<span class="template-variable">&#123;&#123; github.event.inputs.sanity &#125;&#125;</span>&quot;</span> <span class="string">==</span> <span class="string">&quot;true&quot;</span> ]]<span class="string">;</span> <span class="string">then</span></span><br><span class="line">    <span class="string">TAGS=&quot;@sanity&quot;</span></span><br><span class="line">  <span class="string">fi</span></span><br><span class="line">  <span class="string">if</span> [[ <span class="string">&quot;$<span class="template-variable">&#123;&#123; github.event.inputs.regression &#125;&#125;</span>&quot;</span> <span class="string">==</span> <span class="string">&quot;true&quot;</span> ]]<span class="string">;</span> <span class="string">then</span></span><br><span class="line">    <span class="string">TAGS=&quot;$TAGS,@regression&quot;</span></span><br><span class="line">  <span class="string">fi</span></span><br><span class="line">  <span class="string">if</span> [[ <span class="string">&quot;$<span class="template-variable">&#123;&#123; github.event.inputs.testTags &#125;&#125;</span>&quot;</span> <span class="type">!=</span> <span class="string">&quot;&quot;</span> ]]<span class="string">;</span> <span class="string">then</span></span><br><span class="line">    <span class="string">TAGS=&quot;$TAGS,$&#123;&#123;</span> <span class="string">github.event.inputs.testTags</span> <span class="string">&#125;&#125;&quot;</span></span><br><span class="line">  <span class="string">fi</span></span><br></pre></td></tr></table></figure>

<p>I include the available tags in the description, so it is easy to remember the choices.</p>
<p><img src="../images/tag-tests/flow-inputs.png" alt="Picking the test tags to run"></p>
<p><strong>Tip:</strong> I pass the additional custom tag as a string &quot;Blog post demo&quot; - that is purely to tag the recorded Dashboard run to make it simple to find it.</p>
<p><img src="../images/tag-tests/flow-run.png" alt="The recorded run has all selected test tags and the custom tag string"></p>
<p><strong>Tip 2:</strong> use the Cypress Dashboard tag dropdown to filter the recorded runs by a tag.</p>
<p><img src="../images/tag-tests/tag-dropdown.png" alt="Available tags to filter the runs by"></p>
<h2><span id="bonus-3-presentation-slice-and-dice-your-end-to-end-tests">Bonus 3: presentation Slice And Dice Your End-to-End Tests</span></h2><p>Recently I have shown how we tag and run the E2E at Mercari US. You can find the slide deck at <a target="_blank" rel="noopener" href="https://slides.com/bahmutov/slice-and-dice">https://slides.com/bahmutov/slice-and-dice</a>.</p>

      
    </div>

    
      <footer class="article-footer personal-links">
  <p>
    Follow Gleb Bahmutov <a target="_blank" rel="noopener" href="https://twitter.com/bahmutov">@bahmutov</a>,
    see his projects at <a href="https://glebbahmutov.com">glebbahmutov.com</a>,
    watch his Cypress <a target="_blank" rel="noopener" href="https://www.youtube.com/c/glebbahmutov/videos">videos</a>,
    browse his <a target="_blank" rel="noopener" href="https://slides.com/bahmutov">presentations</a>
  </p>
  <p>
    Want to know more about Cypress? Check out <a href="https://cypress.tips" target="_blank">cypress.tips</a>
  </p>
  <p>
    Have a Cypress question? Want me to answer it? Consider supporting me via <a target="_blank" rel="noopener" href="https://github.com/sponsors/bahmutov">GitHub Sponsors</a> or by purchasing my <a target="_blank" rel="noopener" href="https://cypress.tips/courses">Cypress courses</a>.
  </p>
</footer>
<script src="https://rawgit.com/toddmotto/linkjuice/702066a37124081e7ad1a972844a9a91115be05a/dist/linkjuice.js"></script>
<script>
function contentFn (node, icon) {
  const s = '<a href="#' + node.id + '" class="linkjuice">' +
    node.innerHTML + ' ' + icon + '</a>\n'
  return s
}
linkjuice.init('.article-entry', {
  selectors: ['h2 span'],
  icon: '<span class="link-symbol">#</span>',
  contentFn: contentFn
});
</script>

    

    <footer class="article-footer">
      <a data-url="https://glebbahmutov.com/blog/tag-tests/" data-id="cl6p5kwyz00fxouvg8n4ranyx" class="article-share-link">Share</a>
      
        <a href="https://glebbahmutov.com/blog/tag-tests/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/advice/" rel="tag">advice</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/cypress/" rel="tag">cypress</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../know-your-tests/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Know Your Tests
        
      </div>
    </a>
  
  
    <a href="../find-the-number/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">How To Solve A Simple Numeric Problem Using Computers and JavaScript</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    <style>
#carbonads {
  display: block;
  overflow: hidden;
  font-size: 11px;
  font-family: Verdana, "Helvetica Neue", Helvetica, sans-serif;
  line-height: 1.5;
}

#carbonads a {
  color: #258fb8;
  text-decoration: none;
}

#carbonads a:hover {
  text-decoration: underline;
}

#carbonads span {
  position: relative;
  display: block;
  overflow: hidden;
}

.carbon-img {
  float: left;
  margin-right: 1em;
}

.carbon-img img { display: block; }

.carbon-text {
  display: block;
  float: left;
  text-align: left;
  margin-top: 0.5em;
}
@media screen and (min-width: 1024px) {
  .carbon-text {
    max-width: calc(100% - 130px - 1em);
  }
}

.carbon-poweredby {
  /*position: absolute;
  right: 0;
  bottom: 0;*/
  float: right;
  display: block;
  font-size: 11px;
}
</style>
<div class="widget-wrap">
  <div class="widget-title">&nbsp;</div>
  <div class="widget">
    <!-- Carbon Ads -->
    <script async type="text/javascript"
      src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=glebbahmutovcom"
      id="_carbonads_js"></script>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../categories/book-review/">book review</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/climate/">climate</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/people/">people</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/process/">process</a><span class="category-list-count">148</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/products/">products</a><span class="category-list-count">489</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="../tags/11ty/" rel="tag">11ty</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/QUnit/" rel="tag">QUnit</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/a11y/" rel="tag">a11y</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/advice/" rel="tag">advice</a><span class="tag-list-count">113</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/algolia/" rel="tag">algolia</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs/" rel="tag">angularjs</a><span class="tag-list-count">58</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs2/" rel="tag">angularjs2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/assertions/" rel="tag">assertions</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ast/" rel="tag">ast</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/boilerplate/" rel="tag">boilerplate</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/browser/" rel="tag">browser</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ci/" rel="tag">ci</a><span class="tag-list-count">31</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/circle/" rel="tag">circle</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/climate/" rel="tag">climate</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/code-coverage/" rel="tag">code coverage</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/concurrency/" rel="tag">concurrency</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cyclejs/" rel="tag">cyclejs</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cypress/" rel="tag">cypress</a><span class="tag-list-count">222</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cypress-dashboard/" rel="tag">cypress dashboard</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/d3/" rel="tag">d3</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/db/" rel="tag">db</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/docker/" rel="tag">docker</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/documentation/" rel="tag">documentation</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es6/" rel="tag">es6</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es7/" rel="tag">es7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/functional/" rel="tag">functional</a><span class="tag-list-count">70</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/generators/" rel="tag">generators</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/git/" rel="tag">git</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/github/" rel="tag">github</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/graphql/" rel="tag">graphql</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/grunt/" rel="tag">grunt</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/gulp/" rel="tag">gulp</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/hiring/" rel="tag">hiring</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/hyperapp/" rel="tag">hyperapp</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/immutable/" rel="tag">immutable</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/interview/" rel="tag">interview</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jade/" rel="tag">jade</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/javascript/" rel="tag">javascript</a><span class="tag-list-count">166</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jshint/" rel="tag">jshint</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/markdown/" rel="tag">markdown</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/model-based-testing/" rel="tag">model-based testing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/modular-development/" rel="tag">modular development</a><span class="tag-list-count">28</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/netlify/" rel="tag">netlify</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">84</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/performance/" rel="tag">performance</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/presentation/" rel="tag">presentation</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/promises/" rel="tag">promises</a><span class="tag-list-count">31</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/proposal/" rel="tag">proposal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ramda/" rel="tag">ramda</a><span class="tag-list-count">28</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/react/" rel="tag">react</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/react-native/" rel="tag">react native</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactive/" rel="tag">reactive</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactjs/" rel="tag">reactjs</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/renovate/" rel="tag">renovate</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/screencast/" rel="tag">screencast</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/security/" rel="tag">security</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/sentry/" rel="tag">sentry</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/service-workers/" rel="tag">service workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/state-machine/" rel="tag">state machine</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/testing/" rel="tag">testing</a><span class="tag-list-count">145</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/tutorial/" rel="tag">tutorial</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/typescript/" rel="tag">typescript</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ui/" rel="tag">ui</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/vercel/" rel="tag">vercel</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/visual-testing/" rel="tag">visual testing</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/vuejs/" rel="tag">vuejs</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/web-workers/" rel="tag">web workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/webpack/" rel="tag">webpack</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../tags/11ty/" style="font-size: 10.37px;">11ty</a> <a href="../tags/QUnit/" style="font-size: 11.48px;">QUnit</a> <a href="../tags/a11y/" style="font-size: 10.74px;">a11y</a> <a href="../tags/advice/" style="font-size: 18.89px;">advice</a> <a href="../tags/algolia/" style="font-size: 10.74px;">algolia</a> <a href="../tags/angularjs/" style="font-size: 17.78px;">angularjs</a> <a href="../tags/angularjs2/" style="font-size: 10px;">angularjs2</a> <a href="../tags/assertions/" style="font-size: 12.96px;">assertions</a> <a href="../tags/ast/" style="font-size: 12.59px;">ast</a> <a href="../tags/boilerplate/" style="font-size: 14.81px;">boilerplate</a> <a href="../tags/browser/" style="font-size: 15.56px;">browser</a> <a href="../tags/ci/" style="font-size: 17.41px;">ci</a> <a href="../tags/circle/" style="font-size: 13.7px;">circle</a> <a href="../tags/climate/" style="font-size: 14.44px;">climate</a> <a href="../tags/code-coverage/" style="font-size: 15.19px;">code coverage</a> <a href="../tags/concurrency/" style="font-size: 10px;">concurrency</a> <a href="../tags/cyclejs/" style="font-size: 12.22px;">cyclejs</a> <a href="../tags/cypress/" style="font-size: 20px;">cypress</a> <a href="../tags/cypress-dashboard/" style="font-size: 14.07px;">cypress dashboard</a> <a href="../tags/d3/" style="font-size: 10.74px;">d3</a> <a href="../tags/db/" style="font-size: 14.44px;">db</a> <a href="../tags/docker/" style="font-size: 14.07px;">docker</a> <a href="../tags/documentation/" style="font-size: 11.85px;">documentation</a> <a href="../tags/es6/" style="font-size: 14.44px;">es6</a> <a href="../tags/es7/" style="font-size: 10px;">es7</a> <a href="../tags/functional/" style="font-size: 18.15px;">functional</a> <a href="../tags/generators/" style="font-size: 11.48px;">generators</a> <a href="../tags/git/" style="font-size: 15.19px;">git</a> <a href="../tags/github/" style="font-size: 16.67px;">github</a> <a href="../tags/graphql/" style="font-size: 11.48px;">graphql</a> <a href="../tags/grunt/" style="font-size: 12.22px;">grunt</a> <a href="../tags/gulp/" style="font-size: 10.74px;">gulp</a> <a href="../tags/hiring/" style="font-size: 11.11px;">hiring</a> <a href="../tags/hyperapp/" style="font-size: 12.22px;">hyperapp</a> <a href="../tags/immutable/" style="font-size: 11.48px;">immutable</a> <a href="../tags/interview/" style="font-size: 10.74px;">interview</a> <a href="../tags/jade/" style="font-size: 11.11px;">jade</a> <a href="../tags/javascript/" style="font-size: 19.63px;">javascript</a> <a href="../tags/jshint/" style="font-size: 10.74px;">jshint</a> <a href="../tags/markdown/" style="font-size: 13.7px;">markdown</a> <a href="../tags/model-based-testing/" style="font-size: 10px;">model-based testing</a> <a href="../tags/modular-development/" style="font-size: 17.04px;">modular development</a> <a href="../tags/netlify/" style="font-size: 11.11px;">netlify</a> <a href="../tags/nodejs/" style="font-size: 18.52px;">nodejs</a> <a href="../tags/performance/" style="font-size: 16.3px;">performance</a> <a href="../tags/presentation/" style="font-size: 12.22px;">presentation</a> <a href="../tags/promises/" style="font-size: 17.41px;">promises</a> <a href="../tags/proposal/" style="font-size: 10.37px;">proposal</a> <a href="../tags/ramda/" style="font-size: 17.04px;">ramda</a> <a href="../tags/react/" style="font-size: 12.22px;">react</a> <a href="../tags/react-native/" style="font-size: 11.11px;">react native</a> <a href="../tags/reactive/" style="font-size: 14.07px;">reactive</a> <a href="../tags/reactjs/" style="font-size: 11.11px;">reactjs</a> <a href="../tags/renovate/" style="font-size: 11.48px;">renovate</a> <a href="../tags/screencast/" style="font-size: 10px;">screencast</a> <a href="../tags/security/" style="font-size: 12.96px;">security</a> <a href="../tags/sentry/" style="font-size: 13.7px;">sentry</a> <a href="../tags/service-workers/" style="font-size: 11.85px;">service workers</a> <a href="../tags/state-machine/" style="font-size: 10px;">state machine</a> <a href="../tags/testing/" style="font-size: 19.26px;">testing</a> <a href="../tags/tutorial/" style="font-size: 15.93px;">tutorial</a> <a href="../tags/typescript/" style="font-size: 12.59px;">typescript</a> <a href="../tags/ui/" style="font-size: 10.37px;">ui</a> <a href="../tags/vercel/" style="font-size: 13.33px;">vercel</a> <a href="../tags/visual-testing/" style="font-size: 11.11px;">visual testing</a> <a href="../tags/vuejs/" style="font-size: 11.48px;">vuejs</a> <a href="../tags/web-workers/" style="font-size: 11.85px;">web workers</a> <a href="../tags/webpack/" style="font-size: 10.74px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/08/">August 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/07/">July 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/06/">June 2022</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/05/">May 2022</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/04/">April 2022</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/03/">March 2022</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/02/">February 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2022/01/">January 2022</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/12/">December 2021</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/11/">November 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/10/">October 2021</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/09/">September 2021</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/08/">August 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/07/">July 2021</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/06/">June 2021</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/05/">May 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/04/">April 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/03/">March 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/02/">February 2021</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2021/01/">January 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/12/">December 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/11/">November 2020</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/10/">October 2020</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/09/">September 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/08/">August 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/07/">July 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/06/">June 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/05/">May 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/04/">April 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/03/">March 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/02/">February 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2020/01/">January 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/12/">December 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/11/">November 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/10/">October 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/09/">September 2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/08/">August 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/07/">July 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/06/">June 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/05/">May 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/04/">April 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/03/">March 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/02/">February 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2019/01/">January 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/12/">December 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/11/">November 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/10/">October 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/09/">September 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/08/">August 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/06/">June 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/04/">April 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/03/">March 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/01/">January 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/12/">December 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/11/">November 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/09/">September 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/08/">August 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/07/">July 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/06/">June 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/05/">May 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/04/">April 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/03/">March 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/02/">February 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/01/">January 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/12/">December 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/10/">October 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/08/">August 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/07/">July 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/06/">June 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/05/">May 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/04/">April 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/03/">March 2016</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/02/">February 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/01/">January 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/12/">December 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/11/">November 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/08/">August 2015</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/07/">July 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/06/">June 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/05/">May 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/04/">April 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/03/">March 2015</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/02/">February 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/01/">January 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/12/">December 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/11/">November 2014</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/10/">October 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/09/">September 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/08/">August 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/07/">July 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/06/">June 2014</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/05/">May 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/04/">April 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/03/">March 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/02/">February 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/01/">January 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/12/">December 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/11/">November 2013</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/10/">October 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/09/">September 2013</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../cypress-pdf/">Test PDFs By Converting Them To HTML</a>
          </li>
        
          <li>
            <a href="../dark-cypress-tips/">Adding Dark Theme to Cypress.Tips Site</a>
          </li>
        
          <li>
            <a href="../cypress-emulate-media/">Emulate Media In Cypress Tests</a>
          </li>
        
          <li>
            <a href="../cypress-js-to-ts/">Convert Cypress Specs from JavaScript to TypeScript</a>
          </li>
        
          <li>
            <a href="../cypress-out-of-band/">Cypress Cannot Add Out-Of-Band Commands</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Gleb Bahmutov<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
</nav>
    
<script>
  var disqus_shortname = 'betterworldbybettersoftware';
  
  var disqus_url = 'https://glebbahmutov.com/blog/tag-tests/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="../fancybox/jquery.fancybox.css">

  
<script src="../fancybox/jquery.fancybox.pack.js"></script>




<script src="../js/script.js"></script>


  </div>
  <script src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script>
<script>
(function centerMainOnAsideScroll () {
  // when aside side bar scrolls outside the view
  // it centers the main content.
  const main = document.querySelector('#main')
  const aside = document.querySelector('aside#sidebar')
  console.assert(main, 'could not get #main')
  console.assert(aside, 'could not get aside')
  // initially the aside sidebar is visible
  let asideVisible = true

  function centerMain () {
    console.log('adding class center-main')
    main.classList.add('center-main')
  }
  function leftMain () {
    main.classList.remove('center-main')
  }

  function callWhenAsideScrollsUp (becameInvisible, becameVisible) {
    return function () {
      const border = 50
      const rect = aside.getBoundingClientRect()
      if (asideVisible && rect.bottom < -border) {
        asideVisible = false
        becameInvisible()
      }

      if (!asideVisible && window.scrollY < border) {
        asideVisible = true
        becameVisible()
      }
    }
  }
  const throttleWaitMs = 250
  const onScroll = _.throttle(
    callWhenAsideScrollsUp(centerMain, leftMain),
    throttleWaitMs
  )
  window.addEventListener('scroll', onScroll)
}())
</script>

</body>
</html>
